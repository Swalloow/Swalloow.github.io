{"componentChunkName":"component---src-templates-posts-js","path":"/9","result":{"data":{"allContentfulPost":{"edges":[{"node":{"title":"Spark의 Shuffling 이해하기","id":"93e10410-a3f1-5148-a79f-32f260c5b90d","slug":"spark-shuffling","publishDate":"August 25, 2017","heroImage":{"title":"cover-dataengineering","gatsbyImageData":{"images":{"sources":[{"srcSet":"https://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=400&h=267&q=50&fm=webp 400w,\nhttps://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=800&h=533&q=50&fm=webp 800w,\nhttps://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=1600&h=1067&q=50&fm=webp 1600w","sizes":"(min-width: 1600px) 1600px, 100vw","type":"image/webp"}],"fallback":{"src":"https://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=1600&h=1067&fl=progressive&q=50&fm=jpg","srcSet":"https://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=400&h=267&fl=progressive&q=50&fm=jpg 400w,\nhttps://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=800&h=533&fl=progressive&q=50&fm=jpg 800w,\nhttps://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=1600&h=1067&fl=progressive&q=50&fm=jpg 1600w","sizes":"(min-width: 1600px) 1600px, 100vw"}},"layout":"constrained","width":1800,"height":1200,"placeholder":{"fallback":"data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEAlgCWAAD/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wAARCAANABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAMBAgb/xAAcEAACAgMBAQAAAAAAAAAAAAAAAQIREiExYeH/xAAWAQEBAQAAAAAAAAAAAAAAAAABAgP/xAAUEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwDK1DF0vgtxW9EylQu8nTotmo+gHfAEP//Z"}},"ogimg":{"src":"https://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=1800&q=50"}},"body":{"childMarkdownRemark":{"timeToRead":2,"html":"<p>효율적인 Spark Application을 개발하기 위해 <strong>Shuffling</strong> 은 상당히 중요한 개념입니다.\n이에 대해 간단히 정리해보았습니다.</p>\n<br>\n<h2 id=\"spark-architecture-shuffle\" style=\"position:relative;\"><a href=\"#spark-architecture-shuffle\" aria-label=\"spark architecture shuffle permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Spark Architecture: Shuffle</h2>\n<p><span\n        class=\"gatsby-resp-image-wrapper\"\n        style=\"position: relative; display: block; ; max-width: 650px; margin-left: auto; margin-right: auto;\"\n      >\n        <span\n          class=\"gatsby-resp-image-background-image\"\n          style=\"padding-bottom: 51.078167115902964%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,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'); background-size: cover; display: block;\"\n        >\n          <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"shuffle\"\n        title=\"\"\n        src=\"https://images.ctfassets.net/tushy4jlcik7/3fP7fYiSGEL6nBHzgL6ecs/8f09dc1944d8620be57f0a537329bca3/shuffle.png\"\n        srcset=\"https://images.ctfassets.net/tushy4jlcik7/3fP7fYiSGEL6nBHzgL6ecs/8f09dc1944d8620be57f0a537329bca3/shuffle.png?w=371 371w,\nhttps://images.ctfassets.net/tushy4jlcik7/3fP7fYiSGEL6nBHzgL6ecs/8f09dc1944d8620be57f0a537329bca3/shuffle.png?w=742 742w,\nhttps://images.ctfassets.net/tushy4jlcik7/3fP7fYiSGEL6nBHzgL6ecs/8f09dc1944d8620be57f0a537329bca3/shuffle.png?w=1484 1484w\"\n        sizes=\"(max-width: 650px) 100vw, 650px\"\n        loading=\"lazy\"\n      />\n        </span>\n      </span></p>\n<p>Shuffle을 설명하기 전에 한 가지 예시를 들어보겠습니다.\n테이블에 전화 통화 기록 목록이 있고 매일 발생한 통화량을 계산한다고 가정 해보겠습니다.\n“날짜”를 키로 설정하고 각 레코드에 대해 값으로 “1”을 지정한 다음, 각 키의 값을 합산하여 결과 값을 계산할 수 있을 것 입니다.</p>\n<p>만일 데이터가 여러 클러스터에 저장되어 있다면 어떻게 해야 동일한 키의 값을 합산할 수 있을까요?\n이를 위한 유일한 방법은 같은 키의 모든 값을 동일한 시스템에 두는 것입니다. 그런 다음 이 값들을 합치면 됩니다.</p>\n<br>\n<h2 id=\"narrow-and-wide-transformation\" style=\"position:relative;\"><a href=\"#narrow-and-wide-transformation\" aria-label=\"narrow and wide transformation permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Narrow and Wide Transformation</h2>\n<p><span\n        class=\"gatsby-resp-image-wrapper\"\n        style=\"position: relative; display: block; ; max-width: 650px; margin-left: auto; margin-right: auto;\"\n      >\n        <span\n          class=\"gatsby-resp-image-background-image\"\n          style=\"padding-bottom: 63.89111289031224%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,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'); background-size: cover; display: block;\"\n        >\n          <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"narrow and wide\"\n        title=\"\"\n        src=\"https://images.ctfassets.net/tushy4jlcik7/3MR55280VY3jq97WtgvlqZ/ccfe293913bd8be4c76d3bca47b8e315/narrow_and_wide.png\"\n        srcset=\"https://images.ctfassets.net/tushy4jlcik7/3MR55280VY3jq97WtgvlqZ/ccfe293913bd8be4c76d3bca47b8e315/narrow_and_wide.png?w=312 312w,\nhttps://images.ctfassets.net/tushy4jlcik7/3MR55280VY3jq97WtgvlqZ/ccfe293913bd8be4c76d3bca47b8e315/narrow_and_wide.png?w=625 625w,\nhttps://images.ctfassets.net/tushy4jlcik7/3MR55280VY3jq97WtgvlqZ/ccfe293913bd8be4c76d3bca47b8e315/narrow_and_wide.png?w=1249 1249w\"\n        sizes=\"(max-width: 650px) 100vw, 650px\"\n        loading=\"lazy\"\n      />\n        </span>\n      </span></p>\n<p>몇 가지 사례를 통해 더 자세히 알아보겠습니다.\n만일 데이터가 이미 키 값으로 파티셔닝 되어 있고 키 값에 대해 변화를 주고 싶다면, 좌측의 그림처럼 수행하게 됩니다.\n<code class=\"language-text\">filter(), sample(), map(), flatMap()</code> 등의 transformation이 이에 해당하며, 이 경우 Shuffle이 필요 없습니다.\n이를 <strong>Narrow Transformation</strong> 이라고 합니다.</p>\n<p>반면, 서로 다른 파티션으로부터 특정한 값을 기준으로 추출하고 싶은 경우, 그 값을 기준으로 Shuffle이 발생하게 됩니다.\n<code class=\"language-text\">groupByKey(), reduceByKey()</code> 등이 이에 해당하며, 이를 <strong>Wide Transformation</strong> 이라고 합니다.</p>\n<br>\n<h2 id=\"shuffled-hashjoin\" style=\"position:relative;\"><a href=\"#shuffled-hashjoin\" aria-label=\"shuffled hashjoin permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Shuffled HashJoin</h2>\n<p><span\n        class=\"gatsby-resp-image-wrapper\"\n        style=\"position: relative; display: block; ; max-width: 650px; margin-left: auto; margin-right: auto;\"\n      >\n        <span\n          class=\"gatsby-resp-image-background-image\"\n          style=\"padding-bottom: 60.83061889250815%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAYCAYAAACIhL/AAAAACXBIWXMAABcRAAAXEQHKJvM/AAAAB3RJTUUH6AMfBicqfOoJVwAABXVJREFUSMe1l21MW1UYxztg0/gSDcRP6jRBZOCcMU4/mJiYmChu4JhhW11wQgJb4pxOfAHdhjLYYO4FVhgDCgxJ5rLWQYHSwcpagcteoGPQAqUtjJeSeJH2toWuHbDyeM5pe+naLoOiJ/n1nPvc5/7z7zn3Pudejkwmu08pBh3ULc0iCswSYgitbsixevXqcI5Xi4iIiFJrdD75/jT8xa7dGnQgbzbOgFrjOCAwwkEhA3kNZtIfEBjg54sGMj4psXjEpsg4t96Zh6ENZlizZo2Pwejo6KjxKTub59b+6cKkTyzDTyyndgp0Op2dox7UOJILlZBcpIL9lQOkT+L1QlJhrzNW4Rv7it9Pesz1zm4IDg5+25/BEXqGzXNrf3H69pJiX/P7nAaHhoYcqMFSsU8bwTqlZ1m4P48Nvo88RXobBNSWo20zTbK6d6cmFg3CMprlch4YizaB8Uws2ErjYJoecS/xM4i3EEGeBpfTTBf2gpH3EdFnij8JzKBRkgc0Lxbooi1gKo6Fm7JGPIPvuCYuGLER8XQgBqf+2Ad0QQzQhXFAF3/qNCiRSCiVStWxVJS9PR29PbdZVCplh8vg6x4rHBUWFvbucnS9tZUI5E3O+Q/b467Ze8p1/AJi3YpVy8vLvxOLxd+vhJCQkGc9JLGpl9auXRtWVVWVnZaWdlwkEgWky+fz93M0Gq2jtusuiBQ2Fnxc4xUTKXDM6hWzge3evL86+FxoaOg2g2UWajqtcLyagovt/5D8S50zPhr+YuJuq/MexIV6N38M9pTr4XANTfrd/FFwx3LrJl2xMRLH40OCv0mPoW4oAM1gtJ+dJLpBSkEyr4/k7S9qh10nFZBaOsJe69ZOLb3jE0urHnMa1Gi1DiE1BsL2RQTto4RHxTD2WVIHP0Se3kA86VkHmZl7UFnbAblVMpJbLe6CoxVXfDQEbSM+sfob+sDKzIyyCYzNpwjTLfkwO2N0L/EqxCtuo55lxmw2g0KhgLm5ObBYLNDV1UUKs3czXz/PajPSggALddMxMPG3galiJ9jPbQdFWzNe4jc9VhcbjUD34Far1cpet7CwAD09PUDTNDGHTWKzDxj88wdgzm4h2qaqXQHOYH8LMFfPEKblxWgGGbzE7yFTGxDrXeWGExUVFa3VaokpT6Pj4+PQ19dHxmq1GiYmJhb/fKeA1WZkZ50GMzMzt/B4vPiVgAy67z28zUVgs2jZN+bn529FxCckJHATExMzs7KyduL89PT0eC6Xm46PU1JStiUlJWX400Xe4jj/Y3vMNaMbXEV7lcs8vkefcD9LiBfx1ugq8sE+Kmg7aUfbDLUS0Avr89664eHhL7vPt7W19dfV1fWUlJRQLS0tHU1NTRo0sxTqqdbW1v6ysjIK3QrX0HmlUChkdRsbG2XkfTBHZIKjdWb4TWwhfU4tA9kIPMYvrLg/gnKya4xkfKLRGcOYpu34KX7V9e9ZIiMj1/cN0WwevuYI6tNKe2FfAQV7T/0F2QI9OfeLgIYvT8rh0PlRyKszOPPFxsVCzeVp4TOeDr75fYT03NMaAh5/Wz3qE9tTfof0mM5upbsOrvMEvSxsrm2+xua5r9lRoGb1th+WwscZYog92IxiWth08Ap8fqyVnE8t1ToNoh/HxKQJPNG7eFQMg0vGw1755+bv++TracYnNqqnQd5+AyTSVqiXSKGmoRnUQ2OBlRmmpRDoswkIVAvLd4DNMPFQg8vRnZ2dBYPwR+j89QPQndgMwwXxKyjUZdgcF+yVCdBNSSEoKCgGeXrNE7TEcbjeLRX0sIC+cjcwhTHAlGwlmwExKJfLHcPDw7BU+m/KoffqJYJSVgPawQF42GfncnQxKuryA9ros9P+L241uownC7ixAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n        >\n          <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"shuffle join\"\n        title=\"\"\n        src=\"https://images.ctfassets.net/tushy4jlcik7/5UW8BXEFxUTnUiCTERknJh/79783cc53e1824dae0f3ead7e85cb08d/shuffle_join.png\"\n        srcset=\"https://images.ctfassets.net/tushy4jlcik7/5UW8BXEFxUTnUiCTERknJh/79783cc53e1824dae0f3ead7e85cb08d/shuffle_join.png?w=307 307w,\nhttps://images.ctfassets.net/tushy4jlcik7/5UW8BXEFxUTnUiCTERknJh/79783cc53e1824dae0f3ead7e85cb08d/shuffle_join.png?w=614 614w,\nhttps://images.ctfassets.net/tushy4jlcik7/5UW8BXEFxUTnUiCTERknJh/79783cc53e1824dae0f3ead7e85cb08d/shuffle_join.png?w=1228 1228w\"\n        sizes=\"(max-width: 650px) 100vw, 650px\"\n        loading=\"lazy\"\n      />\n        </span>\n      </span></p>\n<p>두 개의 테이블을 <code class=\"language-text\">Join</code> 할 때에도 Shuffle 이 발생할 수 있습니다.\n위의 예시 처럼 두 테이블에서 키 값을 기준으로 Join 하게 되면, 동일한 키를 가진 데이터가 동일한 파티션으로 이동합니다.</p>\n<p>하지만 이 때, 셔플 되는 데이터의 양이 성능에 영향을 미칠 수 있습니다.\n만일 C의 데이터의 크기가 A보다 훨씬 크다면, C에 대한 작업으로 인해 전체의 수행시간이 오래 걸리게 될 것 입니다.</p>\n<br>\n<h2 id=\"broadcast-hashjoin\" style=\"position:relative;\"><a href=\"#broadcast-hashjoin\" aria-label=\"broadcast hashjoin permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Broadcast HashJoin</h2>\n<p><span\n        class=\"gatsby-resp-image-wrapper\"\n        style=\"position: relative; display: block; ; max-width: 650px; margin-left: auto; margin-right: auto;\"\n      >\n        <span\n          class=\"gatsby-resp-image-background-image\"\n          style=\"padding-bottom: 60.83061889250815%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAYCAYAAACIhL/AAAAACXBIWXMAABcRAAAXEQHKJvM/AAAAB3RJTUUH6AMfBicqfOoJVwAABXRJREFUSMetl2tMk1cYx4uA4cO2BBwDdyVjmIjZls1tH5bFD2bzghRkoKCZmX5As+zmLskYIsu8uyiD1lah1WUsZg4DLVIYuFISLmabYKGA0AtS5GIrtm9rkaJSnj3ntO/blxYnFk/y4xz+Oc8//7Tved5TgUajmW5t7/e0duj9tBPmoSEGo8kTGRmZKAgYSUlJy/v0xqD9c3nMpV3q6PdgtknB1T69Z0+FDQrO2+FIjYPOeypuQf4ft+j6eJ2Tp43T9eEL3n0Ex8RdWLx4cVDA5OTk5dfH3dw+1vv7362cxnrn8TTW+4BiHIxGo1vQ16/37BDrYMeJbth95iqdt4u6YLu4y6udDtY+k/XSmeCcmHpgwEGLi9vHen9covVrp4M11vsLWY83oMlk8uCA+eK+bYOJ8WGOmen7DwwIOPy107PqHgap4QLCIwznn0fAdiIFbJJUmCwVQv+VNggPD1+FmV7iExcX977ZbAaWzo7L4JBgnWiNF/SwS4TglqVTL5toLdXtqDOSDeC5fy+0gLa6I2ARpYLlRDow0lQ4VXSIBHwPQz3BJyEhYaXL5QLCyMgI/FC4F8ZEQrhRvI5iEQuph6M0g66pXvQBWEpSwCpK8Qesq6tr7e7ubpsvuq7Otq5OLUdDfX1bWFhYGoZ6hf8VJyYmJpD9arW6VyqVdioUiks6Xt3/QfaRWszWJHhM4zXkaeRNJIynv4rEIW+E7CyXy79RqVTfLoSIiIgYtHodCUfeQmKjoqLWnjt3rqCwsPAQzntD8ZXJZLsFer3Bo7h8B5Ttkxzk/6oATdlOtIkAbRImp7hT/DwJhjyDpC9dunTN2E0GJFXds/ZX/usK8phLU12Z8D6DpFHvlA3BLvkw7Kuy0HmnzAysdrja6tOGqE7Weytu0JngmN0H032nWBAfH/9u0clybh/rnVs6yGmsd27pNU5jvb8uH/IG1BsMnvOtQ3C+xU9Fi5nyMI0wdZd+gkmYaaXveUsmAZcsWbLKMGCGg2U1cLbR6PdpHgzymEu78PdwaG3GpasHW0MR5bb6ZxgfHYRFixZt9D1/9ACTAxMbG5tF9s/MzIBWq4Wx0RFgLhZxtQS7z4OvUR33zWBjD61R1x8FRrYJmNNbwf3LZpAeP0gCrsdQK3h8FxMTk9bT0wMsn36yCxzybLBLhUga2GWbgTmzFaZ+2waMPMerkSZdmgmOsszQG7WrVw32RgnldpMUrMPXSMA0Xnt5llxm8E2SytbodDoYuT4EjEbC1fI9AjWyj/sEsQ2ki0SijQsB3yRP+drLk752I8Dn8p2CgoJt2dnZefn5+SH5Yjah4DGPDOQF35o07i0BjfvRB75OWvC10roQ8ML6HDm4yIu+frg6Ojp6dXNzs1apVIbsW1tbq6H3wQNKBg5VO+AnlZPOBxR22I+QNblUkvkg7tlfZaPrY7VejeC8w11Y2dcZ+YpfxkOy+frNO/B5cSutZb33Vd7ialnvH3ka631MZfM36hyRAbaIjPDlr4N0zinRU8j6q3JzkLZLfo3OBMY1RW4zGzBUNPI2efxIymXLliVXN7RA1tEOWJ9Xw3lnF/dxtaw3X2O9c0sN3oD4xzNiZYDPsI+HaQSn00lOcabvYhDGv7Deuz8NLZcug7L2Imh7jV4fiz3IYy5tbNwRWpuxq8VgOZmFYC/EvnZWJmbvg3PeqMkYHR0FcUkxWGkdIXOWB5ktUr9mPbVpgY26bBNtru4zWdD2l4p8gusCGvUKfNUJ+Y26plqBjRqbM23UCPXYAlPlH9GQVBOvB/upDLzEfugP2NTU5BkYGID50vtPE3Q1VlJ0miow9F+FB/3s5NeZjEbcX8nV8j0CtS7cN2AyAf7sdP8Hyn6MCRFbKX8AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n        >\n          <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"broadcast join\"\n        title=\"\"\n        src=\"https://images.ctfassets.net/tushy4jlcik7/2uLtkdnwuEke0F2ULvRfDD/48413f8752d889d652ee925b9c946745/broadcast_join.png\"\n        srcset=\"https://images.ctfassets.net/tushy4jlcik7/2uLtkdnwuEke0F2ULvRfDD/48413f8752d889d652ee925b9c946745/broadcast_join.png?w=307 307w,\nhttps://images.ctfassets.net/tushy4jlcik7/2uLtkdnwuEke0F2ULvRfDD/48413f8752d889d652ee925b9c946745/broadcast_join.png?w=614 614w,\nhttps://images.ctfassets.net/tushy4jlcik7/2uLtkdnwuEke0F2ULvRfDD/48413f8752d889d652ee925b9c946745/broadcast_join.png?w=1228 1228w\"\n        sizes=\"(max-width: 650px) 100vw, 650px\"\n        loading=\"lazy\"\n      />\n        </span>\n      </span></p>\n<p>이를 개선하기 위해 Spark에서는 <strong>Broadcast Join</strong> 을 제공합니다.\n이 경우 RDD 중 하나가 모든 파티션으로 브로드 캐스팅되며 복사됩니다.\n만일 RDD 중 하나가 다른 것에 비해 상당히 작다면 큰 RDD가 전혀 셔플 할 필요가 없습니다.\n작은 RDD 만 모든 작업자 서버에 복사해야 하므로 Broadcast Join은 전체적으로 네트워크 트래픽을 줄여주는 효과가 있습니다.</p>\n<p>Spark 1.2에서는 <code class=\"language-text\">spark.sql.autoBroadcastJoinThreshold</code> 값을 설정해주어야 했지만,\n2.0 이후 버전의 경우 Spark SQL이 알아서 최적화 잘 해줍니다.</p>\n<br>\n<h2 id=\"spark-shuffle-properties\" style=\"position:relative;\"><a href=\"#spark-shuffle-properties\" aria-label=\"spark shuffle properties permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Spark Shuffle Properties</h2>\n<ul>\n<li><code class=\"language-text\">spark.shuffle.compress</code>: 엔진이 shuffle 출력을 압축할지 여부를 지정</li>\n<li><code class=\"language-text\">spark.shuffle.spill.compress</code>: 중간 shuffle spill 파일을 압축할지 여부를 지정</li>\n</ul>\n<p>Shuffle에는 위의 두 가지 중요한 Spark Property 가 있습니다.</p>\n<p>둘 다 기본적으로 값이 “true”이며, <code class=\"language-text\">spark.io.compression.codec</code> 압축 코덱을 기본으로합니다.\n그리고 위에서 설명한 것처럼 Spark에는 여러 가지 셔플 구현이 있습니다.\n특정 구현에서 사용되는 Shuffle은 <code class=\"language-text\">spark.shuffle.manager</code> 값에 의해 결정됩니다.\n가능한 옵션은 <strong>hash, sort, tungsten-sort</strong> 이며, “sort” 옵션은 기본적으로 Spark 1.2.0부터 시작합니다.</p>\n<p>이외에도 Spark Shuffle 관련된 Property는 아래의 공식문서에서 확인하실 수 있습니다.\n<a href=\"https://spark.apache.org/docs/latest/configuration.html#shuffle-behavior\">https://spark.apache.org/docs/latest/configuration.html#shuffle-behavior</a></p>\n<br>\n<h2 id=\"reference\" style=\"position:relative;\"><a href=\"#reference\" aria-label=\"reference permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Reference</h2>\n<ul>\n<li><a href=\"https://0x0fff.com/spark-architecture-shuffle\">https://0x0fff.com/spark-architecture-shuffle</a></li>\n<li><a href=\"https://www.slideshare.net/databricks/strata-sj-everyday-im-shuffling-tips-for-writing-better-spark-programs\">https://www.slideshare.net/databricks/strata-sj-everyday-im-shuffling-tips-for-writing-better-spark-programs</a></li>\n</ul>\n<br>","excerpt":"효율적인 Spark Application을 개발하기 위해 Shuffling…"}}}},{"node":{"title":"Spark groupByKey vs reduceByKey","id":"f4923e82-cd6e-5ba2-8897-c378854708c3","slug":"spark-reduceByKey-groupByKey","publishDate":"August 22, 2017","heroImage":{"title":"cover-dataengineering","gatsbyImageData":{"images":{"sources":[{"srcSet":"https://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=400&h=267&q=50&fm=webp 400w,\nhttps://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=800&h=533&q=50&fm=webp 800w,\nhttps://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=1600&h=1067&q=50&fm=webp 1600w","sizes":"(min-width: 1600px) 1600px, 100vw","type":"image/webp"}],"fallback":{"src":"https://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=1600&h=1067&fl=progressive&q=50&fm=jpg","srcSet":"https://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=400&h=267&fl=progressive&q=50&fm=jpg 400w,\nhttps://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=800&h=533&fl=progressive&q=50&fm=jpg 800w,\nhttps://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=1600&h=1067&fl=progressive&q=50&fm=jpg 1600w","sizes":"(min-width: 1600px) 1600px, 100vw"}},"layout":"constrained","width":1800,"height":1200,"placeholder":{"fallback":"data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEAlgCWAAD/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wAARCAANABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAMBAgb/xAAcEAACAgMBAQAAAAAAAAAAAAAAAQIREiExYeH/xAAWAQEBAQAAAAAAAAAAAAAAAAABAgP/xAAUEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwDK1DF0vgtxW9EylQu8nTotmo+gHfAEP//Z"}},"ogimg":{"src":"https://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=1800&q=50"}},"body":{"childMarkdownRemark":{"timeToRead":1,"html":"<p>Spark Application 성능 개선을 위한 <code class=\"language-text\">groupByKey, reduceBykey</code>에 대해 알아보겠습니다.</p>\n<br>\n<h2 id=\"groupbykey-vs-reducebykey\" style=\"position:relative;\"><a href=\"#groupbykey-vs-reducebykey\" aria-label=\"groupbykey vs reducebykey permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>groupByKey vs reduceBykey</h2>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># reduceByKey</span>\nspark<span class=\"token punctuation\">.</span>textFile<span class=\"token punctuation\">(</span><span class=\"token string\">\"hdfs://...\"</span><span class=\"token punctuation\">)</span>\n <span class=\"token punctuation\">.</span>flatMap<span class=\"token punctuation\">(</span><span class=\"token keyword\">lambda</span> line<span class=\"token punctuation\">:</span> line<span class=\"token punctuation\">.</span>split<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n <span class=\"token punctuation\">.</span><span class=\"token builtin\">map</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">lambda</span> word<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">(</span>word<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n <span class=\"token punctuation\">.</span>reduceByKey<span class=\"token punctuation\">(</span><span class=\"token keyword\">lambda</span> a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">:</span> a <span class=\"token operator\">+</span> b<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># groupByKey</span>\nspark<span class=\"token punctuation\">.</span>textFile<span class=\"token punctuation\">(</span><span class=\"token string\">\"hdfs://...\"</span><span class=\"token punctuation\">)</span>\n <span class=\"token punctuation\">.</span>flatMap<span class=\"token punctuation\">(</span><span class=\"token keyword\">lambda</span> line<span class=\"token punctuation\">:</span> line<span class=\"token punctuation\">.</span>split<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n <span class=\"token punctuation\">.</span><span class=\"token builtin\">map</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">lambda</span> word<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">(</span>word<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n <span class=\"token punctuation\">.</span>groupByKey<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n <span class=\"token punctuation\">.</span><span class=\"token builtin\">map</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">lambda</span> <span class=\"token punctuation\">(</span>w<span class=\"token punctuation\">,</span> counts<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">(</span>w<span class=\"token punctuation\">,</span> <span class=\"token builtin\">sum</span><span class=\"token punctuation\">(</span>counts<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>가장 흔히 알고 있는 word count 예제를 예로 들어보겠습니다.\n위의 예시는 reduceByKey를 사용했으며, 아래의 예시는 groupByKey를 사용했습니다.\n둘의 결과는 같지만 성능은 확인히 차이가 납니다.</p>\n<p>먼저 위의 코드에서 <code class=\"language-text\">flatMap, map</code> 까지는 동일한 노드에서 실행이 됩니다.\n하지만 reducer 부분에서는 모든 동일한 단어 쌍을 같은 노드로 이동시켜야 하기 때문에 <strong>Shuffle</strong> 이 발생합니다.</p>\n<p><span\n        class=\"gatsby-resp-image-wrapper\"\n        style=\"position: relative; display: block; ; max-width: 650px; margin-left: auto; margin-right: auto;\"\n      >\n        <span\n          class=\"gatsby-resp-image-background-image\"\n          style=\"padding-bottom: 59.945130315500684%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAYCAIAAAAH5iiXAAAMDWlDQ1BpY2MAAEiJlVcHVJPJFp6/pBASWiAUKaF3pFepoYOAdLARkgChxJgQVOzIooJrQUUUK7oqYlsLIIsNCxYWBXtdUFFR1sVVbKi8SQF9vnbePWf++XLn3jvfvZmZMwOAqiNbKMxH1QAoEBSK4sOCmKlp6UxSDyACDGgDY2DM5oiFgXFx0QDKSP/P8u4mQKT9NXtprH8d/6+izuWJOQAgcRBncsWcAoiPAIDrcISiQgAI7VBvOqNQKMUDEGuKIEEAiLgUZ8uxjhRnyrGdzCYxngVxAABkKpstygZARcqbWcTJhnFUpBwdBVy+AOKNEPtxcthciO9DbFdQMA1iVTLEVpnfxcn+p5iZozHZ7OxRLM9FJuRgvliYz571f5bjf0tBvmRkDhPYqDmi8HhpzrBuu/OmRUkxFeIWQWZMLMQaEF/gc2X2Unw3RxKepLDv54hZsGaAAQAKuOzgKIj1IWZI8pICFdiZLZL5Qns0hl8YkajAmaJp8Yr4aJEgPyZaEWdJDi9iBG/miUMSRmyy+KEREMOVhh4pzklMkfNEzxbxk2MgVoH4qjgvIUrh+7A4hxUzYiOSxEs5m0H8NksUGi+3wXQKxCN5YQ4ctmwuuBawgMKcxHC5L5bKE6dGj3Dg8oJD5BwwLk+QpOCGwdUVFK/wLRPmxynssc28/LB4eZ2xg+KihBHfrkK4wOR1wB7lsiPjFHO9ExbGJcq54SiIBiwQDJhAAlsmmAZyAb+jv7Ef/pKPhAI2EIFswAP2Cs2IR4psRAC/CaAY/AkRD4hH/YJkozxQBPVfRrXyrz3Iko0WyTzywFOIC3A93A/3waPhNwA2Z9wT9xrxY6qOzEoMIQYTw4mhROtRHhzIOh82EeD/G10U7HkwOykXwUgO3+IRnhI6CY8INwjdhDsgGTyRRVFYTeWXiH5gzgTjQTeMFqrILvP77HALyNoND8J9IX/IHWfgesAed4WZBOL+MDc3qP2eoWSU27da/jiflPX3+Sj0KjYqbgoWmaP/DGvU6scorO9qxIV91I+W2BLsMNaGncYuYi1YI2BiJ7EmrB07LsWjK+GJbCWMzBYv45YH4/BHbBzrHfscP/8wN1sxv7Re4kLezELpZmBNE84S8bNzCpmB8DTmMSMEHAc7prOjkwcA0rNdfnS8YcjObIRx6ZtuEbTwIw0PD5/4pov6A4DDPQBQ7n/TWZ6C2xXulQurORJRkVwnPY4BAVCAKtwVusAQmAIrmI8zcAc+IACEgEgQCxJBGpgCK54DCiDnGWAOWAjKQAVYCdaCDWAL2A52g33gEGgELeA0OA8ug6vgBrgH10UveAkGwDswhCAICaEhdEQXMULMEVvEGfFE/JAQJBqJR9KQDCQbESASZA6yCKlAKpENyDakDvkVOYacRi4incgdpAfpQ/5GPqEYSkU1UQPUAh2LeqKBaBSaiE5Gs9HpaDFaii5Hq9FadC/agJ5GL6M30G70JTqIAUwZY2DGmD3mibGwWCwdy8JE2DysHKvCarH9WDP8n69h3Vg/9hEn4nScidvDtRmOJ+EcfDo+D1+Gb8B34w34Wfwa3oMP4F8JNII+wZbgTYggpBKyCTMIZYQqwk7CUcI5uG96Ce+IRCKDaEn0gPsyjZhLnE1cRtxEPEA8RewkPiYOkkgkXZItyZcUS2KTCkllpPWkvaSTpC5SL+kDWZlsRHYmh5LTyQJyCbmKvId8gtxFfkYeUlJTMlfyVopV4irNUlqhtEOpWemKUq/SEEWdYknxpSRScikLKdWU/ZRzlPuUN8rKyibKXsoTlPnKC5SrlQ8qX1DuUf5I1aDaUFnUSVQJdTl1F/UU9Q71DY1Gs6AF0NJphbTltDraGdpD2gcVuoqDSoQKV2W+So1Kg0qXyitVJVVz1UDVKarFqlWqh1WvqParKalZqLHU2Grz1GrUjqndUhtUp6s7qceqF6gvU9+jflH9uQZJw0IjRIOrUaqxXeOMxmM6Rjels+gc+iL6Dvo5eq8mUdNSM0IzV7NCc59mh+aAloaWq1ay1kytGq3jWt0MjGHBiGDkM1YwDjFuMj5pG2gHavO0l2rv1+7Sfq8zRidAh6dTrnNA54bOJ12mbohunu4q3UbdB3q4no3eBL0Zepv1zun1j9Ec4zOGM6Z8zKExd/VRfRv9eP3Z+tv12/UHDQwNwgyEBusNzhj0GzIMAwxzDdcYnjDsM6Ib+RnxjdYYnTR6wdRiBjLzmdXMs8wBY33jcGOJ8TbjDuMhE0uTJJMSkwMmD0wppp6mWaZrTFtNB8yMzMabzTGrN7trrmTuaZ5jvs68zfy9haVFisVii0aL55Y6lhGWxZb1lvetaFb+VtOtaq2uWxOtPa3zrDdZX7VBbdxscmxqbK7YorbutnzbTbaddgQ7LzuBXa3dLXuqfaB9kX29fY8DwyHaocSh0eHVWLOx6WNXjW0b+9XRzTHfcYfjPScNp0inEqdmp7+dbZw5zjXO111oLqEu812aXF672rryXDe73naju413W+zW6vbF3cNd5L7fvc/DzCPDY6PHLU9NzzjPZZ4XvAheQV7zvVq8Pnq7exd6H/L+y8feJ89nj8/zcZbjeON2jHvsa+LL9t3m2+3H9Mvw2+rX7W/sz/av9X8UYBrADdgZ8CzQOjA3cG/gqyDHIFHQ0aD3LG/WXNapYCw4LLg8uCNEIyQpZEPIw1CT0OzQ+tCBMLew2WGnwgnhUeGrwm9FGERwIuoiBiI9IudGno2iRiVEbYh6FG0TLYpuHo+Ojxy/evz9GPMYQUxjLIiNiF0d+yDOMm563G8TiBPiJtRMeBrvFD8nvi2BnjA1YU/Cu8SgxBWJ95KskiRJrcmqyZOS65LfpwSnVKZ0p45NnZt6OU0vjZ/WlE5KT07fmT44MWTi2om9k9wmlU26Odly8szJF6foTcmfcnyq6lT21MMZhIyUjD0Zn9mx7Fr2YGZE5sbMAQ6Ls47zkhvAXcPt4/nyKnnPsnyzKrOeZ/tmr87uy/HPqcrp57P4G/ivc8Nzt+S+z4vN25U3nJ+Sf6CAXJBRcEygIcgTnJ1mOG3mtE6hrbBM2D3de/ra6QOiKNFOMSKeLG4q1ITXnHaJleQnSU+RX1FN0YcZyTMOz1SfKZjZPstm1tJZz4pDi3+Zjc/mzG6dYzxn4ZyeuYFzt81D5mXOa51vOr90fu+CsAW7F1IW5i38vcSxpLLk7aKURc2lBqULSh//FPZTfZlKmajs1mKfxVuW4Ev4SzqWuixdv/RrObf8UoVjRVXF52WcZZd+dvq5+ufh5VnLO1a4r9i8krhSsPLmKv9VuyvVK4srH68ev7phDXNN+Zq3a6euvVjlWrVlHWWdZF13dXR103qz9SvXf96Qs+FGTVDNgY36G5dufL+Ju6lrc8Dm/VsMtlRs+bSVv/X2trBtDbUWtVXbiduLtj/dkbyj7RfPX+p26u2s2Plll2BX9+743WfrPOrq9ujvWVGP1kvq+/ZO2nt1X/C+pv32+7cdYByoOAgOSg6++DXj15uHog61HvY8vP+I+ZGNR+lHyxuQhlkNA405jd1NaU2dxyKPtTb7NB/9zeG3XS3GLTXHtY6vOEE5UXpi+GTxycFTwlP9p7NPP26d2nrvTOqZ62cnnO04F3XuwvnQ82faAttOXvC90HLR++KxS56XGi+7X25od2s/+rvb70c73DsarnhcabrqdbW5c1zniS7/rtPXgq+dvx5x/fKNmBudN5Nu3r416Vb3be7t53fy77y+W3R36N6C+4T75Q/UHlQ91H9Y+4f1Hwe63buP9wT3tD9KeHTvMefxyyfiJ597S5/SnlY9M3pW99z5eUtfaN/VFxNf9L4UvhzqL/tT/c+Nr6xeHfkr4K/2gdSB3tei18N/L3uj+2bXW9e3rYNxgw/fFbwbel/+QffD7o+eH9s+pXx6NjTjM+lz9RfrL81fo77eHy4YHhayRWzZVQCDDc3KAuDvXQDQ0gCgX4X3BxX520smiPy9KEPgP2H5+0wm7gDsWwBAPGwsePc4CJsFxLQAAKRX78QAgLq4jDaFiLNcnOWxqPAFQ/gwPPzGAABSMwBfRMPDQ5uGh7/sgGTvAHBquvzNJxUivN9vdZWiLobwA/hB/gEKCm6l7KI/MQAAAAlwSFlzAAAWJQAAFiUBSVIk8AAAAAd0SU1FB+gDHwYnKnzqCVcAAARNSURBVEjHxZb7UxpXFMfzL5m00zShPmpEkUVesqxApbWT6Y+Ztj+0f0Cn/Sk1UxMfE6OgSYzaSWNmqtiHuuwur92AoiIqIqAGIZHlIfKQZXJZjFGWhoRppztnLgfud8/nnnMvZ/dC/n+6LhQ/fu6+ZbFYVl2uvv4Bn8+3tLS0srpqMplH7z+YmTF4vd7e3j6Xy+VwOJaWnECAosa5uQWdXr+9vT03P//Djz/90nPHbrfH4/G+gQGDweB0LtvtDpuNrADuuX378ePfnkxNAcCMwTCs0+E4fnfw3sTE5J9//Q1GvX5kfHwCRdGh4eGtrS232/3g4RiQ/T49PTE5MfX0qcEwq9Pp9/f3R0ZGQZzJyV+HdfqxR+MVwG+5aDoK8ij66XQ6FAq9YzFpms5ms9WD/9s9BldsxWmVwFwLjOpL7vEPDZVVxt2r54UMqdZYZAip/Mwqhq1iBWvw8tffnAPTFLlQw1uo+aTEvD09JWDPze7C1MVSZdTpOM9lTJJ2tKmNgBRnZVRHJwd8sfbEiiLgXKrb4oC37vTiMjUuVr6RgfHDhlJwvgDG+JI3YDYgpdKeA0co0gRrjY0i46dCI6/FeLWJUGqNfLFv6B4XTACwBEE/asQbILReiEMwAXeWyViqAGBcqDDymrF6IQbBuLDdcYNTarOqC+jQOgF6uRG7yjepu4zNkvJg5HNC3LFwqRara0UbIELaYVZquRmbFSr0Whsuguc/qMdqBbhMBcCLN74tBc9zNhhY2VIXwBKk4h5b4AKYECkr7PE7gk8OV02lw5VnLEoW3Ia8DRxfXSYRNaVUU4ialMOWllZSgVBKzc7Y/RJwQK+jYBUJq2ztiEXYRipURUusu0rAdq2WQjRWSbtVIARhi+b67vsTcI5V5RgmyzAFJ5NOBgOpg1DM6zrc9aYOwumDEPgKxnT0IJ8ryJnc8dGL5+BH5jibehk8ehnMpVPF8mZidIrVsxZOPvfH/RvZw2hpAwGwQffaH3u7T/y+h55Nazh0uOM5PkoUp7PJOAiajrw4SSF3DDDRTWfCt5462D8K7SV3PAn/BvATgY241xX3reeymaIYJAAWl4nT/9i5Mmyux6/HXCaVDPpPFen93aOAN7pM0raFCGYIE7PRFSq25gAJZWIRkCKTzaQj4UKF3Iv0oiWMTUfwWdoyH1tbTO0FUsGd9+rVzKlnhaRsRzvb1HgmPsS9xyaFXytPxTy8oeVstPd4SFghOfcAm/iiMsoCuFRZPZjUfIE3S8Ef/zy4TMbPvryOC+SgT/1L4M4urFUGGqSxvpUQFXoeJpCZxQpuuGfXvwJThFyD1raYxB3AB+swy5Eqn8cFMAgh6ShmALou+vE1s1DKBVMsGJdrTpRX+OiVJqK5rdo9lioBCXTviqW2gQZ5uRGIOaWuJmPGCsnKHS6o3BIVXCVRLTjvG7zruXmLte5T2+7v5yrBm8lZzSZr4P20bNhX1Infu98JjA4AAAAodEVYdGljYzpjb3B5cmlnaHQAQ29weXJpZ2h0IEFwcGxlIEluYy4sIDIwMTe/8xjQAAAAF3RFWHRpY2M6ZGVzY3JpcHRpb24ARGlzcGxheRcblbgAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n        >\n          <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"reduceByKey\"\n        title=\"\"\n        src=\"https://images.ctfassets.net/tushy4jlcik7/4lMQgfoDcfSD0LRyKCddiF/737f60e7d2574bb8e326ead72c13001b/reduceByKey.png\"\n        srcset=\"https://images.ctfassets.net/tushy4jlcik7/4lMQgfoDcfSD0LRyKCddiF/737f60e7d2574bb8e326ead72c13001b/reduceByKey.png?w=365 365w,\nhttps://images.ctfassets.net/tushy4jlcik7/4lMQgfoDcfSD0LRyKCddiF/737f60e7d2574bb8e326ead72c13001b/reduceByKey.png?w=729 729w,\nhttps://images.ctfassets.net/tushy4jlcik7/4lMQgfoDcfSD0LRyKCddiF/737f60e7d2574bb8e326ead72c13001b/reduceByKey.png?w=1458 1458w\"\n        sizes=\"(max-width: 650px) 100vw, 650px\"\n        loading=\"lazy\"\n      />\n        </span>\n      </span></p>\n<p>우선 reduceByKey의 경우, 먼저 각 노드에서 중간 집계를 진행하고 이에 대한 결과를 동일한 키 값으로 전송합니다.</p>\n<p><span\n        class=\"gatsby-resp-image-wrapper\"\n        style=\"position: relative; display: block; ; max-width: 650px; margin-left: auto; margin-right: auto;\"\n      >\n        <span\n          class=\"gatsby-resp-image-background-image\"\n          style=\"padding-bottom: 60.92436974789916%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAYCAMAAAC/Wk/yAAAMDWlDQ1BpY2MAAEiJlVcHVJPJFp6/pBASWiAUKaF3pFepoYOAdLARkgChxJgQVOzIooJrQUUUK7oqYlsLIIsNCxYWBXtdUFFR1sVVbKi8SQF9vnbePWf++XLn3jvfvZmZMwOAqiNbKMxH1QAoEBSK4sOCmKlp6UxSDyACDGgDY2DM5oiFgXFx0QDKSP/P8u4mQKT9NXtprH8d/6+izuWJOQAgcRBncsWcAoiPAIDrcISiQgAI7VBvOqNQKMUDEGuKIEEAiLgUZ8uxjhRnyrGdzCYxngVxAABkKpstygZARcqbWcTJhnFUpBwdBVy+AOKNEPtxcthciO9DbFdQMA1iVTLEVpnfxcn+p5iZozHZ7OxRLM9FJuRgvliYz571f5bjf0tBvmRkDhPYqDmi8HhpzrBuu/OmRUkxFeIWQWZMLMQaEF/gc2X2Unw3RxKepLDv54hZsGaAAQAKuOzgKIj1IWZI8pICFdiZLZL5Qns0hl8YkajAmaJp8Yr4aJEgPyZaEWdJDi9iBG/miUMSRmyy+KEREMOVhh4pzklMkfNEzxbxk2MgVoH4qjgvIUrh+7A4hxUzYiOSxEs5m0H8NksUGi+3wXQKxCN5YQ4ctmwuuBawgMKcxHC5L5bKE6dGj3Dg8oJD5BwwLk+QpOCGwdUVFK/wLRPmxynssc28/LB4eZ2xg+KihBHfrkK4wOR1wB7lsiPjFHO9ExbGJcq54SiIBiwQDJhAAlsmmAZyAb+jv7Ef/pKPhAI2EIFswAP2Cs2IR4psRAC/CaAY/AkRD4hH/YJkozxQBPVfRrXyrz3Iko0WyTzywFOIC3A93A/3waPhNwA2Z9wT9xrxY6qOzEoMIQYTw4mhROtRHhzIOh82EeD/G10U7HkwOykXwUgO3+IRnhI6CY8INwjdhDsgGTyRRVFYTeWXiH5gzgTjQTeMFqrILvP77HALyNoND8J9IX/IHWfgesAed4WZBOL+MDc3qP2eoWSU27da/jiflPX3+Sj0KjYqbgoWmaP/DGvU6scorO9qxIV91I+W2BLsMNaGncYuYi1YI2BiJ7EmrB07LsWjK+GJbCWMzBYv45YH4/BHbBzrHfscP/8wN1sxv7Re4kLezELpZmBNE84S8bNzCpmB8DTmMSMEHAc7prOjkwcA0rNdfnS8YcjObIRx6ZtuEbTwIw0PD5/4pov6A4DDPQBQ7n/TWZ6C2xXulQurORJRkVwnPY4BAVCAKtwVusAQmAIrmI8zcAc+IACEgEgQCxJBGpgCK54DCiDnGWAOWAjKQAVYCdaCDWAL2A52g33gEGgELeA0OA8ug6vgBrgH10UveAkGwDswhCAICaEhdEQXMULMEVvEGfFE/JAQJBqJR9KQDCQbESASZA6yCKlAKpENyDakDvkVOYacRi4incgdpAfpQ/5GPqEYSkU1UQPUAh2LeqKBaBSaiE5Gs9HpaDFaii5Hq9FadC/agJ5GL6M30G70JTqIAUwZY2DGmD3mibGwWCwdy8JE2DysHKvCarH9WDP8n69h3Vg/9hEn4nScidvDtRmOJ+EcfDo+D1+Gb8B34w34Wfwa3oMP4F8JNII+wZbgTYggpBKyCTMIZYQqwk7CUcI5uG96Ce+IRCKDaEn0gPsyjZhLnE1cRtxEPEA8RewkPiYOkkgkXZItyZcUS2KTCkllpPWkvaSTpC5SL+kDWZlsRHYmh5LTyQJyCbmKvId8gtxFfkYeUlJTMlfyVopV4irNUlqhtEOpWemKUq/SEEWdYknxpSRScikLKdWU/ZRzlPuUN8rKyibKXsoTlPnKC5SrlQ8qX1DuUf5I1aDaUFnUSVQJdTl1F/UU9Q71DY1Gs6AF0NJphbTltDraGdpD2gcVuoqDSoQKV2W+So1Kg0qXyitVJVVz1UDVKarFqlWqh1WvqParKalZqLHU2Grz1GrUjqndUhtUp6s7qceqF6gvU9+jflH9uQZJw0IjRIOrUaqxXeOMxmM6Rjels+gc+iL6Dvo5eq8mUdNSM0IzV7NCc59mh+aAloaWq1ay1kytGq3jWt0MjGHBiGDkM1YwDjFuMj5pG2gHavO0l2rv1+7Sfq8zRidAh6dTrnNA54bOJ12mbohunu4q3UbdB3q4no3eBL0Zepv1zun1j9Ec4zOGM6Z8zKExd/VRfRv9eP3Z+tv12/UHDQwNwgyEBusNzhj0GzIMAwxzDdcYnjDsM6Ib+RnxjdYYnTR6wdRiBjLzmdXMs8wBY33jcGOJ8TbjDuMhE0uTJJMSkwMmD0wppp6mWaZrTFtNB8yMzMabzTGrN7trrmTuaZ5jvs68zfy9haVFisVii0aL55Y6lhGWxZb1lvetaFb+VtOtaq2uWxOtPa3zrDdZX7VBbdxscmxqbK7YorbutnzbTbaddgQ7LzuBXa3dLXuqfaB9kX29fY8DwyHaocSh0eHVWLOx6WNXjW0b+9XRzTHfcYfjPScNp0inEqdmp7+dbZw5zjXO111oLqEu812aXF672rryXDe73naju413W+zW6vbF3cNd5L7fvc/DzCPDY6PHLU9NzzjPZZ4XvAheQV7zvVq8Pnq7exd6H/L+y8feJ89nj8/zcZbjeON2jHvsa+LL9t3m2+3H9Mvw2+rX7W/sz/av9X8UYBrADdgZ8CzQOjA3cG/gqyDHIFHQ0aD3LG/WXNapYCw4LLg8uCNEIyQpZEPIw1CT0OzQ+tCBMLew2WGnwgnhUeGrwm9FGERwIuoiBiI9IudGno2iRiVEbYh6FG0TLYpuHo+Ojxy/evz9GPMYQUxjLIiNiF0d+yDOMm563G8TiBPiJtRMeBrvFD8nvi2BnjA1YU/Cu8SgxBWJ95KskiRJrcmqyZOS65LfpwSnVKZ0p45NnZt6OU0vjZ/WlE5KT07fmT44MWTi2om9k9wmlU26Odly8szJF6foTcmfcnyq6lT21MMZhIyUjD0Zn9mx7Fr2YGZE5sbMAQ6Ls47zkhvAXcPt4/nyKnnPsnyzKrOeZ/tmr87uy/HPqcrp57P4G/ivc8Nzt+S+z4vN25U3nJ+Sf6CAXJBRcEygIcgTnJ1mOG3mtE6hrbBM2D3de/ra6QOiKNFOMSKeLG4q1ITXnHaJleQnSU+RX1FN0YcZyTMOz1SfKZjZPstm1tJZz4pDi3+Zjc/mzG6dYzxn4ZyeuYFzt81D5mXOa51vOr90fu+CsAW7F1IW5i38vcSxpLLk7aKURc2lBqULSh//FPZTfZlKmajs1mKfxVuW4Ev4SzqWuixdv/RrObf8UoVjRVXF52WcZZd+dvq5+ufh5VnLO1a4r9i8krhSsPLmKv9VuyvVK4srH68ev7phDXNN+Zq3a6euvVjlWrVlHWWdZF13dXR103qz9SvXf96Qs+FGTVDNgY36G5dufL+Ju6lrc8Dm/VsMtlRs+bSVv/X2trBtDbUWtVXbiduLtj/dkbyj7RfPX+p26u2s2Plll2BX9+743WfrPOrq9ujvWVGP1kvq+/ZO2nt1X/C+pv32+7cdYByoOAgOSg6++DXj15uHog61HvY8vP+I+ZGNR+lHyxuQhlkNA405jd1NaU2dxyKPtTb7NB/9zeG3XS3GLTXHtY6vOEE5UXpi+GTxycFTwlP9p7NPP26d2nrvTOqZ62cnnO04F3XuwvnQ82faAttOXvC90HLR++KxS56XGi+7X25od2s/+rvb70c73DsarnhcabrqdbW5c1zniS7/rtPXgq+dvx5x/fKNmBudN5Nu3r416Vb3be7t53fy77y+W3R36N6C+4T75Q/UHlQ91H9Y+4f1Hwe63buP9wT3tD9KeHTvMefxyyfiJ597S5/SnlY9M3pW99z5eUtfaN/VFxNf9L4UvhzqL/tT/c+Nr6xeHfkr4K/2gdSB3tei18N/L3uj+2bXW9e3rYNxgw/fFbwbel/+QffD7o+eH9s+pXx6NjTjM+lz9RfrL81fo77eHy4YHhayRWzZVQCDDc3KAuDvXQDQ0gCgX4X3BxX520smiPy9KEPgP2H5+0wm7gDsWwBAPGwsePc4CJsFxLQAAKRX78QAgLq4jDaFiLNcnOWxqPAFQ/gwPPzGAABSMwBfRMPDQ5uGh7/sgGTvAHBquvzNJxUivN9vdZWiLobwA/hB/gEKCm6l7KI/MQAAAuVQTFRF/v7+/f398PDx9/j49PT09/f39vb38fHx7e3u7u7u39/f6urq/Pz8vb2+sLCxt7e4ubm6q6ysxsfHrq6wmpublZaXu7y8mJiZsbGym5ycwcHCwcHB7+/vkJCRoKGivLy9ra2tmpucmZqbq6yt6Ojpk5OUoqKjqamqrq+wvr+/4+Pku7u82NjYyMjJxMTFvr7Aw8PDwsLDpKSl1dXV1NTUv7/A09PTvr6/1tbWrq6vzMzO19fXy8zMwcLDy8vMxsbHqqus+vHv9+nn+Onn/Pf2+e7s/fr514GDvzE8wDE86r271n1/7MHAz2Rmw0VOwkJMwDVAwDE989vZwTpFwTtF7MG/xVdfw0pTwDZC9NrYwjxHwTZCxVVdwkROwz1I68G/xVdgw0pS89vYxVhgw0ROwT9JxlpiwkNNwj5Jx11lw0dQwTlExU9YwT1IwTtG1n2Axltjwj9Kz2RnxVpiwkZQwjtG14GExVhhw0JMwkVPwT5IwjpF57Oy2YSF2YSG2YKD0m1r0W1r03Ny135+8tfU56+u2YKE2IKE1Xh31HR01nt78tnW4qKg13190mpn2YGB2oSF8/r68Pn45/X18fn59+zm/vz8+vLw9OXf9+3q+O3p+O7q/Pj3+vPv9uvm+vXz+fPw9+zo9+7q/vz7+PDs9+3p9url+/b11e/vsuHgtOPhsuHhtuPi5PHu89/X/Pr59uzo/fr6+fHu8uHZ9unk8d3V9OLa8t7W9ebf8+Ha+/b0+vbz+O/r+vPw6ry55K2n5KKc35WM4aSd5Kuk5rWu+/bz/v79+fLw6Lqz46uk36GX4JeO46CZ5bGs6ru6+/Px+e3rwkFKwT5Jw0RNyVFX0G1vxlBZxE5X9Nza+e3qwkhRw0VPxUpT0G9xxE9Yw09X9NzZxUlTxE1Xw0hSxElS0G9wxE5Ww05XxElRwUVPxElTw0lRxEpT0G9ywUNMwUBLwkFMz2lswkBKwTxH5q+v6bu668LAB7j22AAAAAlwSFlzAAAWJQAAFiUBSVIk8AAAAAd0SU1FB+gDHwYnKnzqCVcAAAGXSURBVBgZBcE9iBwFAIDR9+3O7s3MbeRAMCDEQmKwCIitFiH40wXBzjK9iJWghY0Q24jYiVjaKRHS5MDuCisbEbzSH7CLXFzudNnzPVqA5WC1hoORaT7kYAMAg01VVVVVVT25UtUvAINrVZ09VdXpjT+fPb1R1Y/Xn64dAIDYYAMABEC4XaBjuL0AOoY39i7FcsC6QGDeA0sw7qyq82mACbgARot2GYDRqi7GgwGYLsYtAFOdmQHm/mUagGluC8BcZ7YAU/OWBTBNE8B1ZhMzeIF5njHgpVN/AICD8THA6cBqhwEAAH4FAH89t8aA9c2q6iE8c7Vq1wBu9c+mbvm+z3rv8979ovbLulRVd7+u2l52+OSK3oG+qaq3+ba/j97yoH6/Vvtl/63f9Oi37gIBx73my+dVVa9yUlWll0EA/FR9jE9ugp/rI/j0RTAAMFUAGAuMwAIA979agRNgOAeABQA+tASvgHE4AoAFAFbvrwFwfg8ALACwvL8AJ+DIYwAYALD8IAAM9wKAAHj9O6BDsN0Dd34A/wOkCk1s++qPwQAAACh0RVh0aWNjOmNvcHlyaWdodABDb3B5cmlnaHQgQXBwbGUgSW5jLiwgMjAxN7/zGNAAAAAXdEVYdGljYzpkZXNjcmlwdGlvbgBEaXNwbGF5FxuVuAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n        >\n          <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"groupByKey\"\n        title=\"\"\n        src=\"https://images.ctfassets.net/tushy4jlcik7/6XcUgU5bN51jHzig363qGr/84a4cf5389ea34f79862c0e3181730bf/groupByKey.png\"\n        srcset=\"https://images.ctfassets.net/tushy4jlcik7/6XcUgU5bN51jHzig363qGr/84a4cf5389ea34f79862c0e3181730bf/groupByKey.png?w=357 357w,\nhttps://images.ctfassets.net/tushy4jlcik7/6XcUgU5bN51jHzig363qGr/84a4cf5389ea34f79862c0e3181730bf/groupByKey.png?w=714 714w,\nhttps://images.ctfassets.net/tushy4jlcik7/6XcUgU5bN51jHzig363qGr/84a4cf5389ea34f79862c0e3181730bf/groupByKey.png?w=1428 1428w\"\n        sizes=\"(max-width: 650px) 100vw, 650px\"\n        loading=\"lazy\"\n      />\n        </span>\n      </span></p>\n<p>반면, groupByKey는 각 노드에 있는 데이터에 대해 바로 Shuffle 과정을 거치게 되고 결과를 내보냅니다.\n따라서 groupByKey는 네트워크를 통해 전송되는 데이터의 양이 많아질 뿐만 아니라, <strong>Out of disk</strong> 문제가 발생할 수도 있습니다.</p>\n<p>Shuffle은 기본적으로 비용이 큰 연산입니다.\ngroupByKey는 reduceByKey로 대체될 수 있기 때문에 많은 문서에서 이를 권장하고 있습니다.</p>\n<br>\n<h2 id=\"reference\" style=\"position:relative;\"><a href=\"#reference\" aria-label=\"reference permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Reference</h2>\n<ul>\n<li><a href=\"https://www.slideshare.net/databricks/strata-sj-everyday-im-shuffling-tips-for-writing-better-spark-programs\">https://www.slideshare.net/databricks/strata-sj-everyday-im-shuffling-tips-for-writing-better-spark-programs</a></li>\n</ul>\n<br>","excerpt":"Spark Application 성능 개선을 위한 에 대해 알아보겠습니다. groupByKey vs reduceBykey…"}}}},{"node":{"title":"Hive Metastore 구축 관련 문제와 해결과정","id":"376bb950-886b-5e07-b4c5-4a8ab940dfb2","slug":"hive-metastore-issue","publishDate":"August 11, 2017","heroImage":{"title":"cover-dataengineering","gatsbyImageData":{"images":{"sources":[{"srcSet":"https://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=400&h=267&q=50&fm=webp 400w,\nhttps://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=800&h=533&q=50&fm=webp 800w,\nhttps://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=1600&h=1067&q=50&fm=webp 1600w","sizes":"(min-width: 1600px) 1600px, 100vw","type":"image/webp"}],"fallback":{"src":"https://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=1600&h=1067&fl=progressive&q=50&fm=jpg","srcSet":"https://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=400&h=267&fl=progressive&q=50&fm=jpg 400w,\nhttps://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=800&h=533&fl=progressive&q=50&fm=jpg 800w,\nhttps://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=1600&h=1067&fl=progressive&q=50&fm=jpg 1600w","sizes":"(min-width: 1600px) 1600px, 100vw"}},"layout":"constrained","width":1800,"height":1200,"placeholder":{"fallback":"data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEAlgCWAAD/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wAARCAANABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAMBAgb/xAAcEAACAgMBAQAAAAAAAAAAAAAAAQIREiExYeH/xAAWAQEBAQAAAAAAAAAAAAAAAAABAgP/xAAUEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwDK1DF0vgtxW9EylQu8nTotmo+gHfAEP//Z"}},"ogimg":{"src":"https://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=1800&q=50"}},"body":{"childMarkdownRemark":{"timeToRead":2,"html":"<p>Hive Metastore를 구축하면서 겪은 이슈와 해결과정을 기록해두려고 합니다.\n사용 환경은 Spark 2.1.1, Hive 2.1.1 입니다.</p>\n<br>\n<h2 id=\"hive-partition\" style=\"position:relative;\"><a href=\"#hive-partition\" aria-label=\"hive partition permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Hive Partition</h2>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">CREATE</span> EXTERNAL <span class=\"token keyword\">TABLE</span> table_name <span class=\"token punctuation\">(</span>\ncol1 STRING<span class=\"token punctuation\">,</span>\ncol2 STRING\n<span class=\"token punctuation\">)</span>\nPARTITIONED <span class=\"token keyword\">BY</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">key</span> STRING<span class=\"token punctuation\">)</span>\nSTORED <span class=\"token keyword\">AS</span> PARQUET\nLOCATION <span class=\"token string\">'location'</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Hive에서 보통 위와 같은 쿼리로 테이블을 생성합니다.\nMetastore는 말 그대로 외부에 있는 테이블의 정보(스키마, 파티션 등)를 저장하는 개념입니다.\n따라서 <strong>EXTERNAL TABLE</strong> 로 생성하지 않은 상태에서 테이블을 DROP 시키면 다 날아가게 됩니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">ALTER</span> <span class=\"token keyword\">TABLE</span> table_name\n<span class=\"token keyword\">ADD</span> <span class=\"token keyword\">PARTITION</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">key</span><span class=\"token operator\">=</span><span class=\"token string\">'2017-08-11'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>도중에 Partition key를 추가하고 싶을 때는 위와 같은 쿼리를 통해 추가할 수 있습니다.\n그러나, 추가한 정보가 바로 반영이 안될 때가 있습니다.</p>\n<p>이 경우에는 <code class=\"language-text\">MSCK REPAIR TABLE table_name;</code> 쿼리로 해결할 수 있습니다.\nMSCK는 Metastore Check의 약자라고 합니다.</p>\n<br>\n<h2 id=\"hive-metastore-parquet\" style=\"position:relative;\"><a href=\"#hive-metastore-parquet\" aria-label=\"hive metastore parquet permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Hive Metastore, Parquet</h2>\n<p>먼저 겪었던 문제에 대해 설명드리자면 Hive Metastore에 분명히 테이블이 들어가있고,\nHue에서는 잘 보이는데 Zeppelin에서는 모든 데이터에 null 값이 찍혀있었습니다.</p>\n<p>우선 Spark으로 Hive를 사용하는 방식이 2.0 버전 이후 부터 조금 변경되었습니다.\n이전에는 HiveContext를 사용했다면, 이제 SparkSession에서 <code class=\"language-text\">.enableHiveSupport()</code> 추가만 하면 됩니다.\n제플린에서는 SparkSession이 spark이라는 변수로 제공되는데,\n이 경우 interpreter에 <code class=\"language-text\">zeppelin.spark.useHiveContext=true</code>를 추가해서 사용할 수 있습니다.</p>\n<p>다시 문제로 돌아와서 좀 더 확인해보니 컬럼명에 대문자가 들어가면 모든 값이 null로 출력되고 있었습니다.\nSpark 공식문서에 이와 관련된 내용이 잘 나와있습니다.</p>\n<p>Spark SQL에서 Hive metastore로 데이터를 불러오는 경우, 성능 상의 이슈로 SerDe 대신 Spark SQL의 <strong>MetastoreParquet</strong> 를 사용합니다.\n이때 주의사항으로 Hive는 대소문자를 구분하지 않지만, Parquet는 구분합니다. (Hive is case insensitive, while Parquet is not)</p>\n<p>이를 위해 Spark 2.1.1 버전부터 새로운 Spark Properties가 추가되었습니다.</p>\n<p>따라서, Zeppelin interpreter에 아래의 설정 값을 추가해주시면 해결됩니다.\n<code class=\"language-text\">spark.sql.hive.caseSensitiveInferenceMode = INFER_AND_SAVE</code></p>\n<br>\n<h2 id=\"hive-tblproperties\" style=\"position:relative;\"><a href=\"#hive-tblproperties\" aria-label=\"hive tblproperties permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Hive TBLPROPERTIES</h2>\n<p>위에서 말한대로 Spark Properties를 추가하면,\nHive metastore의 parameter에 <code class=\"language-text\">spark.sql.sources.schema.part</code>가 생기게 됩니다.</p>\n<p>여기에서 \"field: name\"에 대소문자가 잘 구분되는 경우, 문제가 없지만 간혹 소문자로 들어오는 경우가 있습니다.\n이 경우에는 아래의 쿼리를 통해 Hive parameter를 수정해주시면 됩니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">ALTER</span> <span class=\"token keyword\">TABLE</span> table_name <span class=\"token keyword\">SET</span> TBLPROPERTIES <span class=\"token punctuation\">(</span><span class=\"token string\">\"spark.sql.sources.schema.part.0\"</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"fix this line\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<br>\n<h2 id=\"reference\" style=\"position:relative;\"><a href=\"#reference\" aria-label=\"reference permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Reference</h2>\n<ul>\n<li><a href=\"https://spark.apache.org/docs/latest/sql-programming-guide.html#hive-metastore-parquet-table-conversion\">https://spark.apache.org/docs/latest/sql-programming-guide.html#hive-metastore-parquet-table-conversion</a></li>\n<li><a href=\"http://spark.apache.org/docs/latest/sql-programming-guide.html#upgrading-from-spark-sql-21-to-22\">http://spark.apache.org/docs/latest/sql-programming-guide.html#upgrading-from-spark-sql-21-to-22</a></li>\n</ul>\n<br>","excerpt":"Hive Metastore를 구축하면서 겪은 이슈와 해결과정을 기록해두려고 합니다.\n사용 환경은 Spark 2.1.1, Hive 2.1.…"}}}},{"node":{"title":"Bagging과 Boosting 그리고 Stacking","id":"b6f97b31-bd09-5915-81f9-4ad527909181","slug":"bagging-boosting","publishDate":"July 19, 2017","heroImage":{"title":"cover-datascience","gatsbyImageData":{"images":{"sources":[{"srcSet":"https://images.ctfassets.net/tushy4jlcik7/5l0PQJpz5C5IDFjHYigWJI/389fe4852b9cb39e9ada4938db33e6ca/cover_datascience.jpg?w=450&h=300&q=50&fm=webp 450w,\nhttps://images.ctfassets.net/tushy4jlcik7/5l0PQJpz5C5IDFjHYigWJI/389fe4852b9cb39e9ada4938db33e6ca/cover_datascience.jpg?w=900&h=600&q=50&fm=webp 900w,\nhttps://images.ctfassets.net/tushy4jlcik7/5l0PQJpz5C5IDFjHYigWJI/389fe4852b9cb39e9ada4938db33e6ca/cover_datascience.jpg?w=1800&h=1200&q=50&fm=webp 1800w","sizes":"(min-width: 1800px) 1800px, 100vw","type":"image/webp"}],"fallback":{"src":"https://images.ctfassets.net/tushy4jlcik7/5l0PQJpz5C5IDFjHYigWJI/389fe4852b9cb39e9ada4938db33e6ca/cover_datascience.jpg?w=1800&h=1200&fl=progressive&q=50&fm=jpg","srcSet":"https://images.ctfassets.net/tushy4jlcik7/5l0PQJpz5C5IDFjHYigWJI/389fe4852b9cb39e9ada4938db33e6ca/cover_datascience.jpg?w=450&h=300&fl=progressive&q=50&fm=jpg 450w,\nhttps://images.ctfassets.net/tushy4jlcik7/5l0PQJpz5C5IDFjHYigWJI/389fe4852b9cb39e9ada4938db33e6ca/cover_datascience.jpg?w=900&h=600&fl=progressive&q=50&fm=jpg 900w,\nhttps://images.ctfassets.net/tushy4jlcik7/5l0PQJpz5C5IDFjHYigWJI/389fe4852b9cb39e9ada4938db33e6ca/cover_datascience.jpg?w=1800&h=1200&fl=progressive&q=50&fm=jpg 1800w","sizes":"(min-width: 1800px) 1800px, 100vw"}},"layout":"constrained","width":1800,"height":1200,"placeholder":{"fallback":"data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEASABIAAD/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wAARCAANABQDASIAAhEBAxEB/8QAGQAAAgMBAAAAAAAAAAAAAAAAAAQBAwUG/8QAHxAAAgEEAgMAAAAAAAAAAAAAAQIAAwQRIQVCExSR/8QAFgEBAQEAAAAAAAAAAAAAAAAAAQAC/8QAFhEBAQEAAAAAAAAAAAAAAAAAAQAR/9oADAMBAAIRAxEAPwCthE7ioFIBOznEy05C8uWI8wpjHVZCF3uFSpUd99m18kpIXSYyTqES96ouiFMJnScb/9k="}},"ogimg":{"src":"https://images.ctfassets.net/tushy4jlcik7/5l0PQJpz5C5IDFjHYigWJI/389fe4852b9cb39e9ada4938db33e6ca/cover_datascience.jpg?w=1800&q=50"}},"body":{"childMarkdownRemark":{"timeToRead":2,"html":"<p>오늘은 머신러닝 성능을 최대로 끌어올릴 수 있는 앙상블 기법에 대해 정리해보았습니다.</p>\n<br>\n<h2 id=\"ensemble-hybrid-method\" style=\"position:relative;\"><a href=\"#ensemble-hybrid-method\" aria-label=\"ensemble hybrid method permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Ensemble, Hybrid Method</h2>\n<p>앙상블 기법은 동일한 학습 알고리즘을 사용해서 여러 모델을 학습하는 개념입니다.\nWeak learner를 결합한다면, Single learner보다 더 나은 성능을 얻을 수 있다는 아이디어입니다.\n<strong>Bagging</strong> 과 <strong>Boosting</strong> 이 이에 해당합니다.</p>\n<p>동일한 학습 알고리즘을 사용하는 방법을 앙상블이라고 한다면,\n서로 다른 모델을 결합하여 새로운 모델을 만들어내는 방법도 있습니다.\n대표적으로 <strong>Stacking</strong> 이 있으며, 최근 Kaggle 에서 많이 소개된 바 있습니다.</p>\n<br>\n<h2 id=\"bagging\" style=\"position:relative;\"><a href=\"#bagging\" aria-label=\"bagging permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Bagging</h2>\n<p>Bagging은 샘플을 여러 번 뽑아 각 모델을 학습시켜 결과를 <strong>집계(Aggregating)</strong> 하는 방법입니다. 아래의 그림을 통해 자세히 알아보겠습니다.</p>\n<p><span\n        class=\"gatsby-resp-image-wrapper\"\n        style=\"position: relative; display: block; ; max-width: 650px; margin-left: auto; margin-right: auto;\"\n      >\n        <span\n          class=\"gatsby-resp-image-background-image\"\n          style=\"padding-bottom: 67.3768308921438%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAbCAMAAAA5zj1cAAACVVBMVEX////q8vrW5vT4+/2tzepbm9Xl7/h5rd1zqdt3rNx5rt16rt1tptpvp9pqpNlyqdtlode00exppNno8fn2+v39/v/6/P75+/33+v3v9fv2+f38/f71+f37/f7y9/z0+Pzx9/v+/v76+vrt8vf7+/v9/f2IiIiBgYF/f39+fn7X19eAgIB/f4B8fHyFhYXOzs6QkJCXl5eSkpKWlpaLi4uDg4OVlZWTk5OJiYmEhISUlJSZmZmMjIyRkZGNjY2Pj4+CgoKYmJh9fX3R0dHNzc3w8PDx8fHU1NTy8vLv7+/b29v/3nj//fX/227/1FL/3Xb/9tv/++3/4ID/1FD/+eb///7/0UP//PT//vz/1FP//vn/3XX/9NT//PH/1lj/993/1llfzfZu0vZr0fZYy/XK7/xUyvVx0/do0PZs0vZWy/Vy0/fI7vxNyPVmz/Zjz/ZGxvTG7fxQyfVkz/ZezfZSyvW66vtSyfVlz/ZazPUcufIlu/IrvfMtvvMXt/Gx5/oNtPEmvPIvvvMStvEPtfElvPIxv/MsvvMWt/Eku/IywPMZuPEju/I0wPMqvfIeufKg4fkdufIhuvI1wfMovfIYt/EfuvILtPEiu/IVt/EOtPEguvITtvELs/EiuvIVtvEbufIauPIRtfFPyfVdzfXJ7vzM7/zN8PzC7PtczfV00/b9/v7w9vvstLTaaWnXZ2j55+fff3/LKyvKKSnIICDKJyfHHBz119fWWVnQQ0PONzfPPDzHHh7EERHQQUHMMDDPPT3KKirDCwv8/Pzqs7PYamr25eX9WfNmAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAB3RJTUUH6AMfBicqfOoJVwAAAbFJREFUGBmNwb1u01AAhuH3Oz5O7PyUliYgKFLLUi6CASgjoRSkCoTEwAUxcB+wMrIAM2wMMFSqqBAVFEVtfhzbh+OkIPkoA88j6iQqKghY6iJRUUHAEjCqZIQsgQZyRhkhQ11XsnJll//QYxkBfeFJLEgsZFSa36hYoCk8TTgXY0d4jSO8HnMCtg7wtg5YuC7kcELOqEDOfAXEtoQklEuFpUQyuaWQya00MaZsfgIstCSNWlIeDy8WRWnPZj3Goygt0/g47asYOzxDEqudcWpdJ2FoV6I2V/NpZ4MsnkUJw+m4TUXcFSCHJ4dnhCcHHG6WQPSGhXsDvPtUdvEe7FHZxXv4iDkDJAmwnz4GnrSfAp0O3rNVvJUV/hlQGbDcgDnxXEILM8UTooak4QVJeSwPjV4Clis6lzXzWNLUpVI3mXX01wjPsiHy6enlSVpGR5fGSnXYP+7/Xv9+tvlzXSdr/PiV4Fk+3pLDlB05tsv07Q43ymsfbrJa8PnO+9s5X3aEJ3oETtaoab3YZ6lXLCPqXgs5MHsELHVWUhlJhCyhWN6MkCXQVmVGSO+okaioIPAHGSR3NgT0ZroAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n        >\n          <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"boosting\"\n        title=\"\"\n        src=\"https://images.ctfassets.net/tushy4jlcik7/2Qi9V8VS1XzgWdLT3UiSpk/fe2d857d275ee85b2122f350bc18c718/boosting.png\"\n        srcset=\"https://images.ctfassets.net/tushy4jlcik7/2Qi9V8VS1XzgWdLT3UiSpk/fe2d857d275ee85b2122f350bc18c718/boosting.png?w=188 188w,\nhttps://images.ctfassets.net/tushy4jlcik7/2Qi9V8VS1XzgWdLT3UiSpk/fe2d857d275ee85b2122f350bc18c718/boosting.png?w=376 376w,\nhttps://images.ctfassets.net/tushy4jlcik7/2Qi9V8VS1XzgWdLT3UiSpk/fe2d857d275ee85b2122f350bc18c718/boosting.png?w=751 751w\"\n        sizes=\"(max-width: 650px) 100vw, 650px\"\n        loading=\"lazy\"\n      />\n        </span>\n      </span></p>\n<p>먼저 대상 데이터로부터 복원 랜덤 샘플링을 합니다.\n이렇게 추출한 데이터가 일종의 표본 집단이 됩니다.\n이제 여기에 동일한 모델을 학습시킵니다.\n그리고 학습된 모델의 예측변수들을 집계하여 그 결과로 모델을 생성해냅니다.</p>\n<p>이러한 방식을 <strong>Bootstrap Aggregating</strong> 이라고 부릅니다.</p>\n<p>이렇게 하는 이유는 \"알고리즘의 안정성과 정확성을 향상시키기 위해서\" 입니다.\n대부분 학습에서 나타나는 오류는 다음과 같습니다.</p>\n<ol>\n<li>높은 bias로 인한 Underfitting</li>\n<li>높은 Variance로 인한 Overfitting</li>\n</ol>\n<p>앙상블 기법은 이러한 오류를 최소화하는데 도움이 됩니다.\n특히 Bagging은 각 샘플에서 나타난 결과를 일종의 중간값으로 맞추어 주기 때문에,\nOverfitting을 피할 수 있습니다.</p>\n<p>일반적으로 Categorical Data인 경우, 투표 방식 (Voting)으로 집계하며\nContinuous Data인 경우, 평균 (Average)으로 집계합니다.</p>\n<p>대표적인 Bagging 알고리즘으로 <code class=\"language-text\">RandomForest</code> 모델이 있습니다.\n원래 단일 DecisionTree 모델은 boundary가 discrete 한 모양일 수 밖에 없지만,\nRandomForest는 여러 트리 모델을 결합하여 이를 넘어설 수 있게 되었습니다.</p>\n<p>결과는 아래와 같습니다.</p>\n<p><span\n        class=\"gatsby-resp-image-wrapper\"\n        style=\"position: relative; display: block; ; max-width: 650px; margin-left: auto; margin-right: auto;\"\n      >\n        <span\n          class=\"gatsby-resp-image-background-image\"\n          style=\"padding-bottom: 110.00000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEAYABgAAD/2wBDAAoHBwgHBgoICAgLCgoLDhgQDg0NDh0VFhEYIx8lJCIfIiEmKzcvJik0KSEiMEExNDk7Pj4+JS5ESUM8SDc9Pjv/2wBDAQoLCw4NDhwQEBw7KCIoOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozv/wAARCAAsACgDASIAAhEBAxEB/8QAGgAAAwADAQAAAAAAAAAAAAAAAAMEAQIFB//EAC0QAAIBAwIFAgUFAQAAAAAAAAECAwAEERIhEyIxQWEFUTKBkbHwFBVicaHx/8QAFwEBAQEBAAAAAAAAAAAAAAAAAAECA//EABoRAQEAAgMAAAAAAAAAAAAAAAABESECMVH/2gAMAwEAAhEDEQA/APUTcTJxDKHCqX3DfyOn/MVhZ53VtLFgHA1KxO3/AHFVzenxTsWZnz2wenv96XF6cYhIOJyuc8igEHOc71WcbSyXrIV30k5AHEOx8/UGnPNKsoIVmQqunmIG/U9d/nWsvp8XFEcUsiOyndl1bbdvmPpVD+nrLEscjyNpAGcgZ6+PNZnbpyss0ntblnulhfPxMMhyenTv4opsPpfAuUljuGAQYK6Rv7/mKK3b4y6FJu2kS1kaLOsLtinVpLpMZV20hhjNZEUt26zISApBK48fgFWQSGSIM2M98VzZrZf1EaRuTG6trkLLynG2R3zk1dZx8KIxmfjEHOcAY8VMxbFFFFFVBSLxWa0lVCASvf270+sMAylTuCMGg5kt04YZc5Dn4Qdhg1dbMXt1ZjqJ7+9L/b4N8lztgc52/qmwQJbx8OPVjOeZi33oG0UUUH//2Q=='); background-size: cover; display: block;\"\n        >\n          <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"agg result\"\n        title=\"\"\n        src=\"https://images.ctfassets.net/tushy4jlcik7/24IAgyNrQgeMlBCt81CroN/3d82eca18a1289219478efdbd24fbe2f/agg_result.png\"\n        srcset=\"https://images.ctfassets.net/tushy4jlcik7/24IAgyNrQgeMlBCt81CroN/3d82eca18a1289219478efdbd24fbe2f/agg_result.png?w=240 240w,\nhttps://images.ctfassets.net/tushy4jlcik7/24IAgyNrQgeMlBCt81CroN/3d82eca18a1289219478efdbd24fbe2f/agg_result.png?w=480 480w,\nhttps://images.ctfassets.net/tushy4jlcik7/24IAgyNrQgeMlBCt81CroN/3d82eca18a1289219478efdbd24fbe2f/agg_result.png?w=960 960w\"\n        sizes=\"(max-width: 650px) 100vw, 650px\"\n        loading=\"lazy\"\n      />\n        </span>\n      </span></p>\n<br>\n<h2 id=\"boosting\" style=\"position:relative;\"><a href=\"#boosting\" aria-label=\"boosting permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Boosting</h2>\n<p>Bagging이 일반적인 모델을 만드는데 집중되어있다면,\nBoosting은 맞추기 어려운 문제를 맞추는데 초점이 맞춰져 있습니다.</p>\n<p>수학 문제를 푸는데 9번 문제가 엄청 어려워서 계속 틀렸다고 가정해보겠습니다.\nBoosting 방식은 9번 문제에 가중치를 부여해서 9번 문제를 잘 맞춘 모델을 최종 모델로 선정합니다.\n아래 그림을 통해 자세히 알아보겠습니다.</p>\n<p><img src=\"https://quantdare.com/wp-content/uploads/2016/04/bb3.png\" alt=\"\"></p>\n<p>Boosting도 Bagging과 동일하게 복원 랜덤 샘플링을 하지만, 가중치를 부여한다는 차이점이 있습니다.\nBagging이 병렬로 학습하는 반면, Boosting은 순차적으로 학습시킵니다.\n학습이 끝나면 나온 결과에 따라 가중치가 재분배됩니다.</p>\n<p>오답에 대해 높은 가중치를 부여하고, 정답에 대해 낮은 가중치를 부여하기 때문에\n오답에 더욱 집중할 수 있게 되는 것 입니다.\nBoosting 기법의 경우, 정확도가 높게 나타납니다.\n하지만, 그만큼 Outlier에 취약하기도 합니다.</p>\n<p>AdaBoost, XGBoost, GradientBoost 등 다양한 모델이 있습니다.\n그 중에서도 XGBoost 모델은 강력한 성능을 보여줍니다. 최근 대부분의 Kaggle 대회 우승 알고리즘이기도 합니다.</p>\n<br>\n<h2 id=\"stacking\" style=\"position:relative;\"><a href=\"#stacking\" aria-label=\"stacking permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Stacking</h2>\n<p><strong>Meta Modeling</strong> 이라고 불리기도 하는 이 방법은 위의 2가지 방식과는 조금 다릅니다.\n“Two heads are better than one” 이라는 아이디어에서 출발합니다.</p>\n<p>Stacking은 서로 다른 모델들을 조합해서 최고의 성능을 내는 모델을 생성합니다.\n여기에서 사용되는 모델은 SVM, RandomForest, KNN 등 다양한 알고리즘을 사용할 수 있습니다.\n이러한 조합을 통해 서로의 장점은 취하고 약점을 보완할 수 있게 되는 것 입니다.</p>\n<p>Stacking은 이미 느끼셨겠지만 필요한 연산량이 어마어마합니다.\n적용해보고 싶다면 아래의 StackNet을 사용하는 방법을 추천합니다.</p>\n<p><a href=\"https://github.com/kaz-Anova/StackNet\">https://github.com/kaz-Anova/StackNet</a></p>\n<p>문제에 따라 정확도를 요구하기도 하지만, 안정성을 요구하기도 합니다.\n따라서, 주어진 문제에 적절한 모델을 선택하는 것이 중요합니다.</p>\n<br>","excerpt":"오늘은 머신러닝 성능을 최대로 끌어올릴 수 있는 앙상블 기법에 대해 정리해보았습니다. Ensemble, Hybrid Method…"}}}},{"node":{"title":"Spark DataFrame을 MySQL에 저장하는 방법","id":"0bf44cfd-a95d-5c55-a158-812503a3e3f3","slug":"spark-df-mysql","publishDate":"July 17, 2017","heroImage":{"title":"cover-dataengineering","gatsbyImageData":{"images":{"sources":[{"srcSet":"https://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=400&h=267&q=50&fm=webp 400w,\nhttps://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=800&h=533&q=50&fm=webp 800w,\nhttps://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=1600&h=1067&q=50&fm=webp 1600w","sizes":"(min-width: 1600px) 1600px, 100vw","type":"image/webp"}],"fallback":{"src":"https://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=1600&h=1067&fl=progressive&q=50&fm=jpg","srcSet":"https://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=400&h=267&fl=progressive&q=50&fm=jpg 400w,\nhttps://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=800&h=533&fl=progressive&q=50&fm=jpg 800w,\nhttps://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=1600&h=1067&fl=progressive&q=50&fm=jpg 1600w","sizes":"(min-width: 1600px) 1600px, 100vw"}},"layout":"constrained","width":1800,"height":1200,"placeholder":{"fallback":"data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEAlgCWAAD/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wAARCAANABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAMBAgb/xAAcEAACAgMBAQAAAAAAAAAAAAAAAQIREiExYeH/xAAWAQEBAQAAAAAAAAAAAAAAAAABAgP/xAAUEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwDK1DF0vgtxW9EylQu8nTotmo+gHfAEP//Z"}},"ogimg":{"src":"https://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=1800&q=50"}},"body":{"childMarkdownRemark":{"timeToRead":1,"html":"<p>Spark에서 MySQL에 접근하고 DataFrame을 read, write 하는 방법에 대해 정리해보았습니다.\n참고로 저는 Spark 2.1.0 버전을 사용 중 입니다.</p>\n<br>\n<h2 id=\"mysql-jdbc-driver\" style=\"position:relative;\"><a href=\"#mysql-jdbc-driver\" aria-label=\"mysql jdbc driver permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>MySQL JDBC Driver</h2>\n<p>JDBC를 통해 접근하기 때문에 드라이버가 필요합니다.\n만일 SBT를 사용하신다면, build.sbt에 maven의 <code class=\"language-text\">mysql-connector-java</code> 를 추가하시면 됩니다.</p>\n<p>직접 jar 파일을 사용해야하는 상황이라면, 다음 링크를 통해 다운받으시면 됩니다.\n<a href=\"https://dev.mysql.com/downloads/connector/j/\">https://dev.mysql.com/downloads/connector/j/</a></p>\n<p>그리고 받으신 jar 파일을 -jars 옵션으로 추가해주셔야 합니다.</p>\n<p><code class=\"language-text\">–jars /home/example/jars/mysql-connector-java-5.1.26.jar</code></p>\n<p>마지막으로 spark-submit 을 사용하신다면, --packages 옵션을 추가해주시면 됩니다.</p>\n<p><code class=\"language-text\">--packages mysql:mysql-connector-java:5.1.39</code></p>\n<br>\n<h2 id=\"spark-dataframe-mysql\" style=\"position:relative;\"><a href=\"#spark-dataframe-mysql\" aria-label=\"spark dataframe mysql permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Spark DataFrame MySQL</h2>\n<p>Spark의 DataFrame은 read, write 함수를 통해 쉽게 데이터를 가져오거나 저장할 수 있습니다.\n아래 예시는 Scala 언어로 작성했습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"scala\"><pre class=\"language-scala\"><code class=\"language-scala\"><span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>apache<span class=\"token punctuation\">.</span>spark<span class=\"token punctuation\">.</span>sql<span class=\"token punctuation\">.</span></span>SaveMode\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">java<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span></span>Properties\n\n<span class=\"token keyword\">val</span> tempDF <span class=\"token operator\">=</span> List<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"1\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"2017-06-01\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"2017-06-03\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>toDF<span class=\"token punctuation\">(</span><span class=\"token string\">\"id\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"start\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"end\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">val</span> properties <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> Properties<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nproperties<span class=\"token punctuation\">.</span>put<span class=\"token punctuation\">(</span><span class=\"token string\">\"user\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"userId\"</span><span class=\"token punctuation\">)</span>\nproperties<span class=\"token punctuation\">.</span>put<span class=\"token punctuation\">(</span><span class=\"token string\">\"password\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"password\"</span><span class=\"token punctuation\">)</span>\ntempDF<span class=\"token punctuation\">.</span>write<span class=\"token punctuation\">.</span>mode<span class=\"token punctuation\">(</span>SaveMode<span class=\"token punctuation\">.</span>Append<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>jdbc<span class=\"token punctuation\">(</span><span class=\"token string\">\"jdbc:mysql://url/database\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"table\"</span><span class=\"token punctuation\">,</span> properties<span class=\"token punctuation\">)</span></code></pre></div>\n<p>위 예제에서는 Properties를 통해 설정값을 넣어주었습니다.\n유저 정보나 주소는 맞게 변경해주시면 됩니다.</p>\n<p>mode 라는 것이 있는데 <code class=\"language-text\">SaveMode.Append</code>는 기존의 테이블에 추가하는 방식이고\n<code class=\"language-text\">SaveMode.Overwrite</code>의 경우 기존의 테이블을 새로운 데이터로 대체하는 방식입니다.</p>\n<br>","excerpt":"Spark에서 MySQL에 접근하고 DataFrame을 read, write 하는 방법에 대해 정리해보았습니다.\n참고로 저는 Spark 2.…"}}}},{"node":{"title":"Spark 2.2.0 릴리즈 업데이트 정리","id":"685d6694-ca41-5c2f-89a2-86556223c62c","slug":"spark22","publishDate":"July 14, 2017","heroImage":{"title":"cover-dataengineering","gatsbyImageData":{"images":{"sources":[{"srcSet":"https://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=400&h=267&q=50&fm=webp 400w,\nhttps://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=800&h=533&q=50&fm=webp 800w,\nhttps://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=1600&h=1067&q=50&fm=webp 1600w","sizes":"(min-width: 1600px) 1600px, 100vw","type":"image/webp"}],"fallback":{"src":"https://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=1600&h=1067&fl=progressive&q=50&fm=jpg","srcSet":"https://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=400&h=267&fl=progressive&q=50&fm=jpg 400w,\nhttps://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=800&h=533&fl=progressive&q=50&fm=jpg 800w,\nhttps://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=1600&h=1067&fl=progressive&q=50&fm=jpg 1600w","sizes":"(min-width: 1600px) 1600px, 100vw"}},"layout":"constrained","width":1800,"height":1200,"placeholder":{"fallback":"data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEAlgCWAAD/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wAARCAANABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAMBAgb/xAAcEAACAgMBAQAAAAAAAAAAAAAAAQIREiExYeH/xAAWAQEBAQAAAAAAAAAAAAAAAAABAgP/xAAUEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwDK1DF0vgtxW9EylQu8nTotmo+gHfAEP//Z"}},"ogimg":{"src":"https://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=1800&q=50"}},"body":{"childMarkdownRemark":{"timeToRead":2,"html":"<p>7월 11일 약 2개월 만에 Spark 2.2.0이 릴리즈 되었습니다.\n어떤 변경 사항들이 있었는지 릴리즈 노트를 통해 간략하게 정리해보았습니다.</p>\n<br>\n<h2 id=\"pypi-를-통한-pyspark-설치\" style=\"position:relative;\"><a href=\"#pypi-%EB%A5%BC-%ED%86%B5%ED%95%9C-pyspark-%EC%84%A4%EC%B9%98\" aria-label=\"pypi 를 통한 pyspark 설치 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>pypi 를 통한 PySpark 설치</h2>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">pip <span class=\"token function\">install</span> pyspark</code></pre></div>\n<p>드디어 PySpark이 <code class=\"language-text\">pip</code>을 지원하게 되었습니다.\n<code class=\"language-text\">pip install pyspark</code> 명령어를 통해 쉽게 설치 가능합니다.\n설치된 버전은 Spark 2.2.0 버전 입니다.</p>\n<p><code class=\"language-text\">numpy, pandas</code> 파이썬 패키지에 dependency가 있으며,\n자세한 사항은 <a href=\"https://pypi.python.org/pypi/pyspark\">pypi 패키지 링크</a>를 통해 확인하실 수 있습니다.\n이번 업데이트를 통해 standalone cluster에서 누구나 쉽게 사용해 볼 수 있을 듯 합니다.</p>\n<br>\n<h2 id=\"structured-streaming\" style=\"position:relative;\"><a href=\"#structured-streaming\" aria-label=\"structured streaming permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Structured Streaming</h2>\n<p>이번 버전부터 Structured Streaming이 새로 추가 되었습니다.\nStructured Streaming은 스트리밍 어플리케이션을 더 빠르고 쉽게 개발하기 위해 만들어진 패키지입니다.</p>\n<p>Spark Streaming이 내부적으로 RDD API를 지원하는 반면, Structured Streaming은 DataFrame, Dataset API를 지원합니다.\n언어는 Scala, Java, Python 모두 지원하며, <code class=\"language-text\">readStream</code> 이라는 메서드를 통해 다양한 저장소로부터 데이터를 읽을 수 있습니다.\n특히 이번 업데이트를 통해 Apache Kafka 스트리밍 지원이 추가되었습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># Subscribe to 1 topic</span>\ndf <span class=\"token operator\">=</span> spark \\\n  <span class=\"token punctuation\">.</span>readStream \\\n  <span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"kafka\"</span><span class=\"token punctuation\">)</span> \\\n  <span class=\"token punctuation\">.</span>option<span class=\"token punctuation\">(</span><span class=\"token string\">\"kafka.bootstrap.servers\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"host1:port1,host2:port2\"</span><span class=\"token punctuation\">)</span> \\\n  <span class=\"token punctuation\">.</span>option<span class=\"token punctuation\">(</span><span class=\"token string\">\"subscribe\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"topic1\"</span><span class=\"token punctuation\">)</span> \\\n  <span class=\"token punctuation\">.</span>load<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\ndf<span class=\"token punctuation\">.</span>selectExpr<span class=\"token punctuation\">(</span><span class=\"token string\">\"CAST(key AS STRING)\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"CAST(value AS STRING)\"</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Structured Streaming에 대한 자세한 내용은 <a href=\"http://spark.apache.org/docs/2.2.0/structured-streaming-programming-guide.html\">http://spark.apache.org/docs/2.2.0/structured-streaming-programming-guide.html</a> 에서 확인하실 수 있습니다.</p>\n<br>\n<h2 id=\"mllib\" style=\"position:relative;\"><a href=\"#mllib\" aria-label=\"mllib permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>MLlib</h2>\n<p>예상했던 대로 MLlib에도 많은 변화가 생겼습니다.\nRDD-based MLlib이 아니라 DataFrame-based MLlib을 확인하시면 됩니다.</p>\n<ul>\n<li>기존에 scala API만 지원하던 모델들에 <code class=\"language-text\">python, R API</code>가 추가되었습니다.</li>\n<li>지원이 추가된 모델은 <strong>Gradient Boosted Trees, Bisecting K-Means, LSH, Distributed PCA, SVD</strong> 입니다.</li>\n<li>DataFreame-based MLlib에 새로운 모델이 추가되었습니다.</li>\n<li>추가된 모델은 **LinearSVC (Linear SVM Classifier), ChiSquare test, Correlation,</li>\n</ul>\n<p>Imputer feature transformer, Tweedie distribution, FPGrowth frequent pattern mining, AssociationRules** 입니다.</p>\n<br>\n<h2 id=\"sparkr\" style=\"position:relative;\"><a href=\"#sparkr\" aria-label=\"sparkr permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>SparkR</h2>\n<p>이번 업데이트를 통해 SparkR에서 Spark SQL API가 확대되었습니다.</p>\n<ul>\n<li>R API에 Structured Streaming, Catalog가 추가되었습니다.</li>\n<li>to_json, from_json 메서드가 추가되었습니다.</li>\n<li>Coalesce, DataFrame checkpointing, Multi-column approxQuantile 기능이 추가되었습니다.</li>\n</ul>\n<br>\n<h2 id=\"graphx\" style=\"position:relative;\"><a href=\"#graphx\" aria-label=\"graphx permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>GraphX</h2>\n<p>GraphX는 버그 수정, 최적화 업데이트가 추가되었습니다.\n이번 Structured Steaming이 메인에 추가된 것으로 보아,\n추후에 DataFrame, DataSet API 기반의 GraphFrame이 추가될 수도 있다고 예상합니다.</p>\n<ul>\n<li>PageRank, vertexRDD/EdgeRDD checkpoint 버그를 수정했습니다.</li>\n<li>PageRank, Pregel API가 개선되었습니다.</li>\n</ul>\n<br>\n<h2 id=\"core-and-sparksql-deprecations\" style=\"position:relative;\"><a href=\"#core-and-sparksql-deprecations\" aria-label=\"core and sparksql deprecations permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Core and SparkSQL, Deprecations</h2>\n<p>마지막으로 Core, SparkSQL 그리고 Deprecation 업데이트 입니다.\n전체 업데이트 및 기타 자세한 내용은 맨 아래의 링크를 참고하시면 됩니다.</p>\n<ul>\n<li>Python 2.6, Java 7, Hadoop 2.5 지원이 종료되었습니다.</li>\n<li><code class=\"language-text\">ALTER TABLE table_name ADD COLUMNS</code> 구문이 추가되었습니다.</li>\n<li>Cost-Based Optimizer 성능이 개선되었습니다.</li>\n<li>CSV, JSON 포멧의 File listing/IO 성능이 개선되었습니다.</li>\n</ul>\n<br>\n<h2 id=\"reference\" style=\"position:relative;\"><a href=\"#reference\" aria-label=\"reference permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Reference</h2>\n<ul>\n<li><a href=\"http://spark.apache.org/releases/spark-release-2-2-0.html\">http://spark.apache.org/releases/spark-release-2-2-0.html</a></li>\n</ul>\n<br>","excerpt":"7월 11일 약 2개월 만에 Spark 2.2.…"}}}}]}},"pageContext":{"basePath":"","paginationPath":"","pageNumber":8,"humanPageNumber":9,"skip":49,"limit":6,"numberOfPages":16,"previousPagePath":"/8","nextPagePath":"/10"}},"staticQueryHashes":["1946181227","2744905544","3732430097"]}