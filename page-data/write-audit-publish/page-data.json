{"componentChunkName":"component---src-templates-post-js","path":"/write-audit-publish/","result":{"data":{"contentfulPost":{"title":"데이터 파이프라인의 Write-Audit-Publish 패턴","slug":"write-audit-publish","metaDescription":null,"publishDate":"March 31, 2024","publishDateISO":"2024-03-31","tags":[{"title":"DataEngineering","id":"25d7d0d6-3cf7-5e19-a5cb-9c3fa926046f","slug":"dataengineering"}],"heroImage":{"title":"cover-dataengineering","gatsbyImageData":{"images":{"sources":[{"srcSet":"https://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=400&h=267&q=50&fm=webp 400w,\nhttps://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=800&h=533&q=50&fm=webp 800w,\nhttps://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=1600&h=1067&q=50&fm=webp 1600w","sizes":"(min-width: 1600px) 1600px, 100vw","type":"image/webp"}],"fallback":{"src":"https://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=1600&h=1067&fl=progressive&q=50&fm=jpg","srcSet":"https://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=400&h=267&fl=progressive&q=50&fm=jpg 400w,\nhttps://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=800&h=533&fl=progressive&q=50&fm=jpg 800w,\nhttps://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=1600&h=1067&fl=progressive&q=50&fm=jpg 1600w","sizes":"(min-width: 1600px) 1600px, 100vw"}},"layout":"constrained","width":1800,"height":1200,"placeholder":{"fallback":"data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEAlgCWAAD/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wAARCAANABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAMBAgb/xAAcEAACAgMBAQAAAAAAAAAAAAAAAQIREiExYeH/xAAWAQEBAQAAAAAAAAAAAAAAAAABAgP/xAAUEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwDK1DF0vgtxW9EylQu8nTotmo+gHfAEP//Z"}},"ogimg":{"src":"https://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=1800&q=50"}},"body":{"childMarkdownRemark":{"timeToRead":3,"html":"<p>Write-Audit-Publish (WAP) 패턴이란, 데이터 엔지니어링 영역에서 데이터 품질과 안정성을 보장하기 위해 ETL에서 사용되는 설계 패턴입니다. 이번 글에서는 WAP 패턴을 알아보고 이를 통해 얻을 수 있는 장점에 대해 알아보겠습니다.</p>\n<br>\n<h2 id=\"write-audit-publish-패턴\" style=\"position:relative;\"><a href=\"#write-audit-publish-%ED%8C%A8%ED%84%B4\" aria-label=\"write audit publish 패턴 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Write-Audit-Publish 패턴</h2>\n<p>오늘날 데이터 환경에는 데이터 생산자와 데이터 사용자가 존재합니다. 일부 데이터 생산자는 데이터 사용자에게 신뢰할 수 있는 데이터를 제공하기 위해 데이터 품질을 적용하고 있지만 이를 전체로 확산하는 것은 어렵습니다. 이러한 문제를 해결하기 위해 WAP 패턴은 데이터 사용자가 항상 신뢰할 수 있는 데이터에 접근하도록 보장합니다.\n<br></p>\n<p><span\n        class=\"gatsby-resp-image-wrapper\"\n        style=\"position: relative; display: block; ; max-width: 650px; margin-left: auto; margin-right: auto;\"\n      >\n        <span\n          class=\"gatsby-resp-image-background-image\"\n          style=\"padding-bottom: 35.285714285714285%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAOCAMAAABq1a50AAABcVBMVEX////y8u/s59bp5NHr5tLm4c/l4dDx7Nnt6dnx7+r17dDf2L7h2sHTzbrg2sPr48bw6dPx8Ovr5M3r48fj3cjUz7ru587w6dHn4c709PTw8PDu7u7Z3fTU2vP+/v/Y3PDQ1e/8/P7s7/ra3/XU2fP19/z8/Pz+/v79/f35+fn19fXx8fHu7/Dy8vL6+vr7+/v5+fv4+Pvt7e3r6+vq6ur1+f3S4fX/9/Prwrjv7+/Ix8jW1tbV1dXp6enu4ujhwdDkwtHv5+v4+Pjs7Oz08fXXvtPfwdLs3eXx7vTXv9Xgw9Tv4uqm1e593PvJ2Ofn5ufb29vv7u7j4+OeyO2HuNy92+bm7fHn5+fm5ubd6PVcpNyzzt3V4+vo6Oja2trL3/Jpq9zZ5ezF2+Cx4Kfc6PO20u2ev9vD1+Lp7vLp8PiTv+PI2ePi6/Df6/aexeTK2uTm7fLR0dHS0dLe3t739/fQ0NDLy8vi4uLc3Nzd3d3Z2dmQI8iPAAAACXBIWXMAABcRAAAXEQHKJvM/AAAAB3RJTUUH6AMfBich6zjQ3wAAAQVJREFUGBmNwQVTwgAAgNHP7s4xxV7hNgWMKRjDbjFAEbs7ENFfL57ccXqe8B5/ycnNyy8oLComk5LSsvKKyqpqMqmpratvaGxqJguCQHYcIv9oaXWS0tbewbfOru4eUiRkBVVzOXp1zQAk0+zrN00D0NyeJK8XBgaHhq2RUZ/kV8fGJybtAKDKU9Mzs4oKuJmbX1jED86l5RXX6pq4HmRjc2ubUMhthdnZjexhR8P+fQ4OI0cEgOOTU75YnJ1fXCICBlfXN7eogIu7+4dHLNL8gv70rAsewFaN8ItuxoCAw/saDzmCpNn2WyLhi6mkyLJCUjTue/d98INmeUV+kyVDMSSy9wmiXS1quuzu8wAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n        >\n          <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"wap-arch\"\n        title=\"\"\n        src=\"https://images.ctfassets.net/tushy4jlcik7/YnWBeX1cL5dlGsbEicb7i/1da940c762abfbf193c893d58093d05a/wap1.png\"\n        srcset=\"https://images.ctfassets.net/tushy4jlcik7/YnWBeX1cL5dlGsbEicb7i/1da940c762abfbf193c893d58093d05a/wap1.png?w=175 175w,\nhttps://images.ctfassets.net/tushy4jlcik7/YnWBeX1cL5dlGsbEicb7i/1da940c762abfbf193c893d58093d05a/wap1.png?w=350 350w,\nhttps://images.ctfassets.net/tushy4jlcik7/YnWBeX1cL5dlGsbEicb7i/1da940c762abfbf193c893d58093d05a/wap1.png?w=700 700w\"\n        sizes=\"(max-width: 650px) 100vw, 650px\"\n        loading=\"lazy\"\n      />\n        </span>\n      </span></p>\n<p>WAP 패턴은 다음과 같이 3단계로 구성되어 있습니다.</p>\n<ul>\n<li><strong>Write</strong>: 데이터 소스로부터 처리한 데이터를 데이터 사용자가 접근할 수 없는 영역에 저장합니다. 임시 또는 스테이지 영역이 될 수 있습니다.</li>\n<li><strong>Audit</strong>: 새로 생성된 데이터에 대해 품질 테스트를 수행하여 데이터를 검증합니다. 이 단계에서 NULL 값, 중복 데이터 식별, 참조 무결성 테스트 실행 등과 같은 부분을 확인합니다.</li>\n<li><strong>Publish</strong>: 프로덕션 테이블에서 데이터를 사용할 수 있도록 배포합니다. Publish 단계는 테이블을 사용하는 사람이 모든 변경 사항을 볼 수 있거나 전혀 볼 수 없도록 Atomic하게 이루어져야 합니다. 테이블 포멧을 통해 스냅샷을 만들고 병합하는 방식으로 이를 구현할 수 있습니다.</li>\n</ul>\n<p><br><br></p>\n<h2 id=\"write-audit-publish-패턴의-장점\" style=\"position:relative;\"><a href=\"#write-audit-publish-%ED%8C%A8%ED%84%B4%EC%9D%98-%EC%9E%A5%EC%A0%90\" aria-label=\"write audit publish 패턴의 장점 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Write-Audit-Publish 패턴의 장점</h2>\n<p>Write-Audit-Publish 패턴을 통해 얻을 수 있는 장점은 다음과 같습니다.\n<br></p>\n<p><strong>데이터 무결성과 품질을 보장</strong><br>\nWAP 패턴은 Audit 단계를 통해 데이터의 정확성, 품질, 표준화 준수 여부를 확인하여 불일치나 예외 사항을 모두 수정합니다. 이러한 검증 과정을 통해 신뢰할 수 있는 데이터 원본만 프로덕션에 게시되도록 보장합니다.</p>\n<br>\n<p><strong>파이프라인의 신뢰성, 안정성 강화</strong><br>\nWrite, Audit, Publish 단계를 분리하면 오류 대응과 롤백 프로세스가 가능하다는 장점이 있습니다. 일반적인 소프트웨어 엔지니어링의 <code class=\"language-text\">Blue-Green 배포</code>는 언제든지 되돌릴 수 있으며 모든 트래픽을 새로운 버전으로 라우팅하는 구조를 가지고 있습니다. WAP 패턴도 Blue-Green 배포와 유사한 구조를 가지고 있어 데이터 파이프라인의 전반적인 신뢰성과 안정성이 강화됩니다.</p>\n<p><strong>데이터 보안 강화</strong><br>\n여러 단계를 통해 구조화된 패턴은 원천 데이터와 감사된 데이터를 분리하여 민감하고 검증되지 않은 정보를 조기 노출로부터 보호하는 보안 계층을 제공합니다. 이를 통해 데이터 보안을 유지하는데 도움을 줄 수 있습니다.</p>\n<p><br><br></p>\n<h2 id=\"wap-with-apache-iceberg\" style=\"position:relative;\"><a href=\"#wap-with-apache-iceberg\" aria-label=\"wap with apache iceberg permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>WAP with Apache Iceberg</h2>\n<p>Apache Iceberg 테이블 포멧에서는 공식적으로 WAP 패턴을 구현하는 데 필요한 <a href=\"https://iceberg.apache.org/docs/latest/branching/\">Branching 기능</a>을 지원하고 있습니다. Branching 기능을 통해 Git의 Branch와 같이 분기를 통해 데이터 테스트 환경과 운영 환경을 격리할 수 있습니다. Iceberg에서 Branch는 테이블의 특정 시점을 가리키는 스냅샷과 동일하며 Branch에 데이터 쓰기를 수행할 수 있습니다. WAP 패턴에 적용 시 작업 절차는 다음과 같습니다.</p>\n<p><span\n        class=\"gatsby-resp-image-wrapper\"\n        style=\"position: relative; display: block; ; max-width: 650px; margin-left: auto; margin-right: auto;\"\n      >\n        <span\n          class=\"gatsby-resp-image-background-image\"\n          style=\"padding-bottom: 93.71428571428571%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAlCAMAAAAHvluBAAACVVBMVEX////o8P/k7v/q8//r9P/s9f79/f3U4f+oxf/x9v/a6P/b6//e3t7FxcXGxsbf39/d3d3Q0NDT09PLy8vIyMjZ5P/b5v/Q4P+60//I3//o6OjOzs7h4eG1yf+LrP+Mr/+Xuv+syv/+/v7u7u76+vrt8v/A0fve6P/g4ODr6+vs7Ozn5+fv7+/39/fw8PD5+fnMzMzKysrNzc3b29va2try8vLp6enl5eXk5OTW4OXk6Ovq6ur9/f/+/v/4+P3i4uLn2+fQq8bbscbCq8d0td90q9fy8/vZ3fTN1PHJ0PD19/z19fXz8/Pm5ualyutYodu51eK41eKTutnS4/Hx8fHc3NzU1NTW1talyepYodrh6O37+/vx8fDj4+Pm7/e2x9fT2d7M0tf19vjt7e3byMjUqKjS0tLY2NjR0dHZyMjXoaHo8N/n7t3x9ezg6tPq8eLz9+77+/7z9Pz09fz3+vP1+fDv8uv1+PD7/Pn89/Xj3dvd4PPj5vfP1fLV1dXk4+TOzs/Eta/239To8N3k7dfb6Mri7NTm79vHx8f4+Pn08/Tv7u/b58rg69LY5sXh69Ld3t329vbj4+Tx8vPp8PH09PT4+Pi+vr7lvM/pvc+btNd+ueDZ6PQbdcq0zt2VvdiGt9zz+PwYd8230+DH2uTm5ueYv+PY4+nX4ujk7PHq6/HX3PTL0fD4+f3x8fPy9Pv09vz6+/67u7vb29zJycn7+/z7/P/t7vH2+f+oy/+cxf/09//Hxsfv8/+ozP+dxf/8/Pzl8P9Mmv9HmP/Z6f/3+v/1+f+F3fTbAAAACXBIWXMAABcRAAAXEQHKJvM/AAAAB3RJTUUH6AMfBich6zjQ3wAAAh9JREFUGBmNwYdXEgEAwOFfi5Z6qE2kdWrJHSgicNRl115IaaFUZMtS28v2zrK9w7Jhw/YetpfNv6tL89l7dMD3Ea1T5y5du4GJeLr36Nmrd1JyimBOTUtP7ZOEkb79+g8YiM6SYSWWQYOHDB2GTszMIqbs4SNITA4JspEgiUTINrvDLuXmEY/Tme8qcKd7iC3XKys+nzJylCqMLhzDv2RV0YQkQZN96FQYO278hImTsE2eMnXadDoIJo+fIkBGF4AZM4tLZs1GSFNsUpAOpaaMMq8zlCxK6DSYM7ekeB6oYcAbnk87jb9UdOWwYOGixUugAt3SZaWVbldFGJ1criiKucorWdDJkuwrq660SBVudMtXFFRXCtUukXa5Em1E08pVq9esXSeK6AJEccis37ARXc2mzVtqttKqnGjbtu/YuauQP2y0y9mdZi1LtdNhz959+2U/bbxQe+Bgbd0hBNGdfzjvCB2OBuxZSMdoZYbjdSdO1tWdOo3I/3gsZJ4pKjrrOXc+GHEAORiov2CHiw0Nly5fIQJoGDF5EK82Nl67fgM/EMCQn8KbTU23QKy6rfiCGArCnbv37gMPHj56jLEiyDS7g8CTp8+eYyzof/EyZM2olCNh4sh3pjQ3O8uJK8thVz2RVyQik8SYzCTm9RsS8vbd+w/u5gzVFQgpoY8Y+/T5S7aY51OtmkVuacHY12/ff4AmaGqSUE8sP38R5TciGXlV+sFd/QAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n        >\n          <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"wap-branch\"\n        title=\"\"\n        src=\"https://images.ctfassets.net/tushy4jlcik7/7MtxVsTkElzigm41aSiAdo/4441addddcf75d808af107e1164ee7c2/wap-iceberg.png\"\n        srcset=\"https://images.ctfassets.net/tushy4jlcik7/7MtxVsTkElzigm41aSiAdo/4441addddcf75d808af107e1164ee7c2/wap-iceberg.png?w=175 175w,\nhttps://images.ctfassets.net/tushy4jlcik7/7MtxVsTkElzigm41aSiAdo/4441addddcf75d808af107e1164ee7c2/wap-iceberg.png?w=350 350w,\nhttps://images.ctfassets.net/tushy4jlcik7/7MtxVsTkElzigm41aSiAdo/4441addddcf75d808af107e1164ee7c2/wap-iceberg.png?w=700 700w\"\n        sizes=\"(max-width: 650px) 100vw, 650px\"\n        loading=\"lazy\"\n      />\n        </span>\n      </span></p>\n<p><strong>Write</strong>:<br></p>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">ALTER</span> <span class=\"token keyword\">TABLE</span> db<span class=\"token punctuation\">.</span><span class=\"token keyword\">table</span> <span class=\"token keyword\">SET</span> TBLPROPERTIES <span class=\"token punctuation\">(</span>\n    <span class=\"token string\">'write.wap.enabled'</span><span class=\"token operator\">=</span><span class=\"token string\">'true'</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">ALTER</span> <span class=\"token keyword\">TABLE</span> db<span class=\"token punctuation\">.</span><span class=\"token keyword\">table</span> <span class=\"token keyword\">CREATE</span> BRANCH feature<span class=\"token operator\">-</span><span class=\"token number\">0305</span> RETAIN <span class=\"token number\">7</span> DAYS<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">SET</span> spark<span class=\"token punctuation\">.</span>wap<span class=\"token punctuation\">.</span>branch <span class=\"token operator\">=</span> feature<span class=\"token operator\">-</span><span class=\"token number\">0305</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> db<span class=\"token punctuation\">.</span><span class=\"token keyword\">table</span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'c'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>기존 Iceberg 테이블에서 새로운 작업 Branch를 생성하고 새로 작성된 ETL 변경 사항을 Branch에 반영합니다. 예시에서는 <code class=\"language-text\">feature-0305</code> 라는 이름의 Branch를 사용하겠습니다.</p>\n<br>\n<p><strong>Audit</strong>:<br>\nBranch에서 필요한 품질 테스트를 수행합니다.<br>\n이 단계에서는 Great Expectations와 같은 Data Quality 도구를 활용할 수 있습니다.</p>\n<br>\n<p><strong>Publish</strong>:<br></p>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">CALL</span> catalog_name<span class=\"token punctuation\">.</span>system<span class=\"token punctuation\">.</span>cherrypick_snapshot<span class=\"token punctuation\">(</span>\n    <span class=\"token string\">'db.table'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'main'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'feature-0305'</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">ALTER</span> <span class=\"token keyword\">TABLE</span> db<span class=\"token punctuation\">.</span><span class=\"token keyword\">table</span> <span class=\"token keyword\">DROP</span> BRANCH feature<span class=\"token operator\">-</span><span class=\"token number\">0305</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>프로덕션 테이블에 새로운 데이터를 배포합니다. 반영이 완료되고 안정성이 확인되면 작업 Branch는 삭제합니다. Publish 작업은 기본적으로 원본 데이터를 변경하거나 제거하지 않고 기존 스냅샷에서 새 스냅샷을 생성하는 Iceberg의 <a href=\"https://iceberg.apache.org/docs/latest/spark-procedures/#cherrypick_snapshot\">cherry-pick procedure</a>에 의해 실행됩니다.</p>\n<p>만약 Iceberg 1.2 이전 버전을 사용한다면 <code class=\"language-text\">WAP.id</code> property를 사용해야합니다.</p>\n<p><br><br></p>\n<h2 id=\"reference\" style=\"position:relative;\"><a href=\"#reference\" aria-label=\"reference permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Reference</h2>\n<p>Write-Audit-Publish 패턴을 통해 대규모 데이터를 처리할 때 프로덕션 워크로드에 영향을 주지 않고 격리된 품질 테스트 및 검증을 수행할 수 있습니다. 데이터 품질 커버리지를 확대하고자 할 때 WAP 패턴을 고려해보시면 좋을 것 같습니다. 그리고 Iceberg와 같은 테이블 포멧을 사용한다면 더 나은 개발 경험을 제공할 수 있습니다.</p>\n<ul>\n<li><a href=\"https://lakefs.io/blog/data-engineering-patterns-write-audit-publish/\">lakefs - Data Engineering Patterns: WAP</a></li>\n<li><a href=\"https://www.dremio.com/blog/streamlining-data-quality-in-apache-iceberg-with-write-audit-publish-branching/\">Dremio - Iceberg with WAP</a></li>\n<li><a href=\"https://dagster.io/blog/python-write-audit-publish\">Dagster - Write-Audit-Publish in data pipelines</a></li>\n</ul>","excerpt":"Write-Audit-Publish (WAP) 패턴이란, 데이터 엔지니어링 영역에서 데이터 품질과 안정성을 보장하기 위해 ETL에서 사용되는 설계 패턴입니다. 이번 글에서는 WAP 패턴을 알아보고 이를 통해 얻을 수 있는 장점에 대해 알아보겠습니다. Write-Audit-Publish 패턴 오늘날 데이터 환경에는 데이터 생산자와 데이터 사용자가 존재합니다. 일부 데이터 생산자는 데이터 사용자에게 신뢰할 수 있는 데이터를 제공하기 위해 데이터 품질을 적용하고 있지만 이를 전체로 확산하는 것은 어렵습니다. 이러한 문제를 해결하기 위해 WAP…"}}}},"pageContext":{"slug":"write-audit-publish","basePath":"","prev":null,"next":{"slug":"llm-dataplatform","publishDate":"2024-01-21"}}},"staticQueryHashes":["1946181227","2744905544","3732430097"]}