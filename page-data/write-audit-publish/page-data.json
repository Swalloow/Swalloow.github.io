{"componentChunkName":"component---src-templates-post-js","path":"/write-audit-publish/","result":{"data":{"contentfulPost":{"title":"데이터 파이프라인의 Write-Audit-Publish 패턴","slug":"write-audit-publish","metaDescription":null,"publishDate":"March 31, 2024","publishDateISO":"2024-03-31","tags":[{"title":"DataEngineering","id":"25d7d0d6-3cf7-5e19-a5cb-9c3fa926046f","slug":"dataengineering"}],"heroImage":{"title":"cover-dataengineering","gatsbyImageData":{"images":{"sources":[{"srcSet":"https://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=400&h=267&q=50&fm=webp 400w,\nhttps://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=800&h=533&q=50&fm=webp 800w,\nhttps://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=1600&h=1067&q=50&fm=webp 1600w","sizes":"(min-width: 1600px) 1600px, 100vw","type":"image/webp"}],"fallback":{"src":"https://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=1600&h=1067&fl=progressive&q=50&fm=jpg","srcSet":"https://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=400&h=267&fl=progressive&q=50&fm=jpg 400w,\nhttps://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=800&h=533&fl=progressive&q=50&fm=jpg 800w,\nhttps://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=1600&h=1067&fl=progressive&q=50&fm=jpg 1600w","sizes":"(min-width: 1600px) 1600px, 100vw"}},"layout":"constrained","width":1800,"height":1200,"placeholder":{"fallback":"data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wAARCAANABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAIBAwb/xAAcEAACAgMBAQAAAAAAAAAAAAAAAQIREiFBMeH/xAAWAQEBAQAAAAAAAAAAAAAAAAABAgP/xAAUEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwDK1DF0vgjileglOuFeTk6fC2ZH6BKV7ugEP//Z"}},"ogimg":{"src":"https://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=1800&q=50"}},"body":{"childMarkdownRemark":{"timeToRead":3,"html":"<p>Write-Audit-Publish (WAP) 패턴이란, 데이터 엔지니어링 영역에서 데이터 품질과 안정성을 보장하기 위해 ETL에서 사용되는 설계 패턴입니다. 이번 글에서는 WAP 패턴을 알아보고 이를 통해 얻을 수 있는 장점에 대해 알아보겠습니다.</p>\n<br>\n<h2 id=\"write-audit-publish-패턴\" style=\"position:relative;\"><a href=\"#write-audit-publish-%ED%8C%A8%ED%84%B4\" aria-label=\"write audit publish 패턴 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Write-Audit-Publish 패턴</h2>\n<p>오늘날 데이터 환경에는 데이터 생산자와 데이터 사용자가 존재합니다. 일부 데이터 생산자는 데이터 사용자에게 신뢰할 수 있는 데이터를 제공하기 위해 데이터 품질을 적용하고 있지만 이를 전체로 확산하는 것은 어렵습니다. 이러한 문제를 해결하기 위해 <code class=\"language-text\">WAP 패턴</code>은 데이터 사용자가 항상 신뢰할 수 있는 데이터에 접근하도록 보장합니다.\n<br></p>\n<p><span\n        class=\"gatsby-resp-image-wrapper\"\n        style=\"position: relative; display: block; ; max-width: 650px; margin-left: auto; margin-right: auto;\"\n      >\n        <span\n          class=\"gatsby-resp-image-background-image\"\n          style=\"padding-bottom: 35.285714285714285%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAOCAMAAABq1a50AAABjFBMVEX////39/Xw693p5NTu6Njs5tfp5Nfx7Nz18OP39fD479bv58zr5M7j3Mnt5tD17NH38N7+/v739vP07tv28Nvt6Nfo49L28N7y7eD+/v/+/v3///74+Pf//v719fXq7Pj9/v/p6/Xk5vP8/P/29/3p6/jm6Pf6+v7//fz7+/v39/f5+fn4+Pj6+vr09fby8/X29vf9/f35+fv4+Pv29fb08/b39vf09/zb5/fy8PXy2Nr5+fjd3t7h4eHu7u7t5u3gztrj0tr07/H8/Pz18/fYyNrh0Nrt5uvz8/Pv6/HTw9Xezdfs5enx8fH7+/3H3u+u3fDb4Ovv7+/09PTy8vLH0OyXudu4097r8fTl6feAqNm21uHZ5uzs7Ozd4/SFrdu52ePd6e729vbh6+fN583x8/fd5PS70uTN4ebz9/n9/f7z9fu/z+PO3+To7/L9/Pz29vXw8/rB0OPQ4OXs8fT39vXq6ejq6eny8fD6+fn39/bt7Ov19fTt7ezm5ubj4+Pe3t3o6Ojp6On7+/rTyBF1AAABHElEQVQYGY3BBVMCQRgG4NduZW3Cxdbbu1M/u1HXOAMDz27sxgAbjD8uDI7jODrwPPhLQmJSckpqWjpiycjMys7JzbMwxJBfUFhUXGIptSIWm93hACtDHDjH/6xOZzm+VFRWIaq6prYOUfWKUDWmq46GxiZNB0BEzS1EBEAVorWtXXCgo7Oru6e3r1/hNtfA4BBxBkj78MjoGCQAQ45PTE6RmzA9MzunGh5t3sTC4tIyTLfgBlZW19YhDcPcwObW9g68BOzu7SOMNBwcHh2D6yek4/Ts/AKXiiQfrq5vbiEYADsimCn8gTufMBkgpc1//0A6A7za41PgWTcYvpF8CYaCOkMYQwRDmOc19BZ8l/hJUb0afmPKh5QS8fsEVMg1EU+mD+MAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n        >\n          <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"wap-arch\"\n        title=\"\"\n        src=\"https://images.ctfassets.net/tushy4jlcik7/YnWBeX1cL5dlGsbEicb7i/1da940c762abfbf193c893d58093d05a/wap1.png\"\n        srcset=\"https://images.ctfassets.net/tushy4jlcik7/YnWBeX1cL5dlGsbEicb7i/1da940c762abfbf193c893d58093d05a/wap1.png?w=175 175w,\nhttps://images.ctfassets.net/tushy4jlcik7/YnWBeX1cL5dlGsbEicb7i/1da940c762abfbf193c893d58093d05a/wap1.png?w=350 350w,\nhttps://images.ctfassets.net/tushy4jlcik7/YnWBeX1cL5dlGsbEicb7i/1da940c762abfbf193c893d58093d05a/wap1.png?w=700 700w\"\n        sizes=\"(max-width: 650px) 100vw, 650px\"\n        loading=\"lazy\"\n      />\n        </span>\n      </span></p>\n<p>WAP 패턴은 다음과 같이 3단계로 구성되어 있습니다.</p>\n<ul>\n<li><strong>Write</strong>: 데이터 소스로부터 처리한 데이터를 데이터 사용자가 접근할 수 없는 영역에 저장합니다. 임시 또는 스테이지 영역이 될 수 있습니다.</li>\n<li><strong>Audit</strong>: 새로 생성된 데이터에 대해 품질 테스트를 수행하여 데이터를 검증합니다. 이 단계에서 NULL 값, 중복 데이터 식별, 참조 무결성 테스트 실행 등과 같은 부분을 확인합니다.</li>\n<li><strong>Publish</strong>: 프로덕션 테이블에서 데이터를 사용할 수 있도록 배포합니다. Publish 단계는 테이블 사용자가 모든 변경 사항을 볼 수 있거나 전혀 볼 수 없도록 Atomic하게 이루어져야 합니다. 테이블 포멧을 통해 스냅샷을 만들고 병합하는 방식으로 이를 구현할 수 있습니다.</li>\n</ul>\n<p><br><br></p>\n<h2 id=\"write-audit-publish-패턴의-장점\" style=\"position:relative;\"><a href=\"#write-audit-publish-%ED%8C%A8%ED%84%B4%EC%9D%98-%EC%9E%A5%EC%A0%90\" aria-label=\"write audit publish 패턴의 장점 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Write-Audit-Publish 패턴의 장점</h2>\n<p>Write-Audit-Publish 패턴을 통해 얻을 수 있는 장점은 다음과 같습니다.\n<br></p>\n<p><strong>데이터 무결성과 품질을 보장</strong><br>\nWAP 패턴은 Audit 단계를 통해 데이터의 정확성, 품질, 표준화 준수 여부를 확인하여 불일치나 예외 사항을 모두 수정합니다. 이러한 검증 과정을 통해 신뢰할 수 있는 데이터 원본만 프로덕션에 게시되도록 보장합니다.</p>\n<br>\n<p><strong>파이프라인의 신뢰성, 안정성 강화</strong><br>\nWrite, Audit, Publish 단계를 분리하면 오류 대응과 롤백 프로세스가 가능하다는 장점이 있습니다. 일반적인 소프트웨어 엔지니어링의 <code class=\"language-text\">Blue-Green 배포</code>는 언제든지 되돌릴 수 있으며 모든 트래픽을 새로운 버전으로 라우팅하는 구조를 가지고 있습니다. WAP 패턴도 Blue-Green 배포와 유사한 구조를 가지고 있어 데이터 파이프라인의 전반적인 신뢰성과 안정성이 강화됩니다.</p>\n<p><strong>데이터 보안 강화</strong><br>\n여러 단계를 통해 구조화된 패턴은 원천 데이터와 감사된 데이터를 분리하여 민감하고 검증되지 않은 정보를 조기 노출로부터 보호하는 보안 계층을 제공합니다. 이를 통해 데이터 보안을 유지하는데 도움을 줄 수 있습니다.</p>\n<p><br><br></p>\n<h2 id=\"wap-with-apache-iceberg\" style=\"position:relative;\"><a href=\"#wap-with-apache-iceberg\" aria-label=\"wap with apache iceberg permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>WAP with Apache Iceberg</h2>\n<p>Apache Iceberg 테이블 포멧에서는 공식적으로 WAP 패턴을 구현하는 데 필요한 <a href=\"https://iceberg.apache.org/docs/latest/branching/\">Branching 기능</a>을 지원하고 있습니다. Branching 기능을 통해 Git의 Branch와 같이 분기를 통해 데이터 테스트 환경과 운영 환경을 격리할 수 있습니다. Iceberg에서 Branch는 테이블의 특정 시점을 가리키는 스냅샷과 동일하며 Branch에 데이터 쓰기를 수행할 수 있습니다. WAP 패턴에 적용하는 경우, 작업 절차는 다음과 같습니다.</p>\n<p><span\n        class=\"gatsby-resp-image-wrapper\"\n        style=\"position: relative; display: block; ; max-width: 650px; margin-left: auto; margin-right: auto;\"\n      >\n        <span\n          class=\"gatsby-resp-image-background-image\"\n          style=\"padding-bottom: 93.71428571428571%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAlCAMAAAAHvluBAAACr1BMVEX////s8f/k7P/w9v/x9//z+f/9/v7///7+/v7a4//H1v/r8v/f6v/m8f/q7O3f397g4ODs7Ozt7e3q6url5eXj4+Pi4uLc4//W4P/Q3f+80f/M3v/7/P79/fz8/Pzy8vLr6+v9/f37+/vS2v+nuv+ZtP+owv/J2v/8/f/6+vrv7+/4+Pjz9v/R2vrq7//z8u////319fX09PTx8fHf39/h4eHp6Ofj4+L19fT39/f29vb29fX19PPy8vPd6vHn7vP39/bw8PD7+/34+P33+Pz5+v3t5O3WuM/kx9LPvtJzrtmkwN/3+Pvo6vfi5PXj5fX5+f3u7u/z8/PJ0u52pNu+3OS52eO70OPo7PXv7+7n5+fK1O97q9y+3ua83eXs8vTz9PT8/f3y8/Pu7u729/zW3Obd4+Te5Ob6+/zh1dXVu7vo6Oju7ezq6enr6url3Nzj0NDp6en4+fjr7+fp7eTs8Ojn7OLr7+jy9fD29/3u7/ny8/r+///6/Pn5+/f19/T5+vf6/Pj9/vz79PPx6Obr7fXt7/nq7Pj8/P719fbk5OTU1dXXzMvy5eP29/b4+Pf+/f7w9O3r8OXl7N/t8ujo7+Pt8unm5ubc3Nzd3d35+fn19vbr8OTq8OXo7uPm7eDp7+Tr8Obr7Ov7+/rz8/L5+fjy9vjl7/T29/j9/v38+vvdxtnlytbmy9asu9lyr9rk6vTw7/D09fpzlNm10OC/2eKxzN3A0OX4+vz+/f308/Nqm9602ee94OjR5ev+/v/X3evZ4eXa4eTr7/Hw8ffl5/bf4vT3+P37+vnx8PDw7+/5+Pj4+Pn4+f3Y2Njm5uXk4+Pe3d7+/v36+vnv7u3z9v7v8vv3+f+wyf+mw//19//s6+vu8v+ev/+Wuv/q8P/7+vrx9f+TuP+Ls//r8f+fJf5FAAACT0lEQVQYGZXBBXMTQQAG0A9rFo81aPeyiyaH3SaB3tFCgzslePEGL+7uWtxpoLg7xbW4u7v/EK5hmDB0joT3kF+BgoUKF4kzEURTtFjxEiVLlTZbrDZ7vCPeCiNlypYrX6FiAiWS2ckYZzBSqXKVqtWqA3C5ZfxTjZq1EJvadRAbhSE2MmJArFZJSB4PRxTc7vXZnXXrJRL8jRDCdAR5VEmrn5SU3KBhir9R4yZN8QePEJLH75EkP3QaR7PmLVq2ao2UNm3btU9FRAceEK6AqhIJOoWjY6fOXbp2Q/e0RE1TEWHlTptwWpxUgU5w9OjZq3cfIKAwRvv2S+eMIyzISR5QCTrB0X/AwEGDAZkBGDI03mz2WgQBoHgkKTmYIRQFOi2gJA4bPkJRVTcFMHKUf7TN7bQx/CYLhBE6Zuy48RMmTqIcunTkw0Xc5ClTpwGYPmPmrNlzEOZHfnPnzV+wcBHyLCYgCLM6be60TA0RliVLly1fgV+UlVi1es3adetZkG7YmCUoIkLpmwg0gTALxebsLVu3ZW/fAUIZ8gtJITXk2rlr9569+2QO7A/CAPcKHDh46PCRo8fAARyHEVcIOSdOnjp95uy58yFZc8MI48i5cPHSZSBBUjWVwwjjyL1y9dp1gNy4ees2DDGVsjt3791nzPXgYWoujDH50eMnVrPXQ02IIs2c5fA9TUZUhKsa5QQxeKYiNs9fIDYvX8FECAh0FMZev3n77n2WQ3IELVKmj8DQh4+fPpu+ZNh9dnumxmDs67fvPwBVaLIIEPyvn8FkkGw9h1RSAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n        >\n          <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"wap-branch\"\n        title=\"\"\n        src=\"https://images.ctfassets.net/tushy4jlcik7/7MtxVsTkElzigm41aSiAdo/4441addddcf75d808af107e1164ee7c2/wap-iceberg.png\"\n        srcset=\"https://images.ctfassets.net/tushy4jlcik7/7MtxVsTkElzigm41aSiAdo/4441addddcf75d808af107e1164ee7c2/wap-iceberg.png?w=175 175w,\nhttps://images.ctfassets.net/tushy4jlcik7/7MtxVsTkElzigm41aSiAdo/4441addddcf75d808af107e1164ee7c2/wap-iceberg.png?w=350 350w,\nhttps://images.ctfassets.net/tushy4jlcik7/7MtxVsTkElzigm41aSiAdo/4441addddcf75d808af107e1164ee7c2/wap-iceberg.png?w=700 700w\"\n        sizes=\"(max-width: 650px) 100vw, 650px\"\n        loading=\"lazy\"\n      />\n        </span>\n      </span></p>\n<p><strong>Write</strong>:<br>\n기존 Iceberg 테이블에서 새로운 작업 Branch를 생성하고 새로 작성된 ETL 변경 사항을 Branch에 반영합니다. 예시에서는 <code class=\"language-text\">feature-0305</code> 라는 이름의 Branch를 사용하겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">ALTER</span> <span class=\"token keyword\">TABLE</span> db<span class=\"token punctuation\">.</span><span class=\"token keyword\">table</span> <span class=\"token keyword\">SET</span> TBLPROPERTIES <span class=\"token punctuation\">(</span>\n    <span class=\"token string\">'write.wap.enabled'</span><span class=\"token operator\">=</span><span class=\"token string\">'true'</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">ALTER</span> <span class=\"token keyword\">TABLE</span> db<span class=\"token punctuation\">.</span><span class=\"token keyword\">table</span> <span class=\"token keyword\">CREATE</span> BRANCH feature<span class=\"token operator\">-</span><span class=\"token number\">0305</span> RETAIN <span class=\"token number\">7</span> DAYS<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">SET</span> spark<span class=\"token punctuation\">.</span>wap<span class=\"token punctuation\">.</span>branch <span class=\"token operator\">=</span> feature<span class=\"token operator\">-</span><span class=\"token number\">0305</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> db<span class=\"token punctuation\">.</span><span class=\"token keyword\">table</span> <span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'c'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<br>\n<p><strong>Audit</strong>:<br>\nBranch에서 필요한 품질 테스트를 수행합니다.<br>\n이 단계에서는 <code class=\"language-text\">Great Expectations</code>와 같은 Data Quality 도구를 활용할 수 있습니다.</p>\n<br>\n<p><strong>Publish</strong>:<br>\n프로덕션 테이블에 새로운 데이터를 배포합니다. 반영이 완료되고 안정성이 확인되면 작업 Branch는 삭제합니다. Publish 작업은 기본적으로 원본 데이터를 변경하거나 제거하지 않고 기존 스냅샷에서 새 스냅샷을 생성하는 Iceberg의 <a href=\"https://iceberg.apache.org/docs/latest/spark-procedures/#cherrypick_snapshot\">cherry-pick procedure</a>에 의해 실행됩니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">CALL</span> catalog_name<span class=\"token punctuation\">.</span>system<span class=\"token punctuation\">.</span>cherrypick_snapshot<span class=\"token punctuation\">(</span>\n    <span class=\"token string\">'db.table'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'main'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'feature-0305'</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">ALTER</span> <span class=\"token keyword\">TABLE</span> db<span class=\"token punctuation\">.</span><span class=\"token keyword\">table</span> <span class=\"token keyword\">DROP</span> BRANCH feature<span class=\"token operator\">-</span><span class=\"token number\">0305</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>만약 Iceberg 1.2 이전 버전을 사용한다면 <code class=\"language-text\">WAP.id</code> property를 사용해야합니다.</p>\n<p><br><br></p>\n<h2 id=\"reference\" style=\"position:relative;\"><a href=\"#reference\" aria-label=\"reference permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Reference</h2>\n<p>Write-Audit-Publish 패턴을 통해 대규모 데이터를 처리할 때 프로덕션 워크로드에 영향을 주지 않고 격리된 품질 테스트 및 검증을 수행할 수 있습니다. 데이터 품질 커버리지를 확대하고자 할 때 WAP 패턴을 고려해보시면 좋을 것 같습니다. 그리고 Iceberg와 같은 테이블 포멧을 사용한다면 더 나은 개발 경험을 제공할 수 있습니다.</p>\n<ul>\n<li><a href=\"https://lakefs.io/blog/data-engineering-patterns-write-audit-publish/\">lakefs - Data Engineering Patterns: WAP</a></li>\n<li><a href=\"https://www.dremio.com/blog/streamlining-data-quality-in-apache-iceberg-with-write-audit-publish-branching/\">Dremio - Iceberg with WAP</a></li>\n<li><a href=\"https://dagster.io/blog/python-write-audit-publish\">Dagster - Write-Audit-Publish in data pipelines</a></li>\n</ul>","excerpt":"Write-Audit-Publish (WAP) 패턴이란, 데이터 엔지니어링 영역에서 데이터 품질과 안정성을 보장하기 위해 ETL에서 사용되는 설계 패턴입니다. 이번 글에서는 WAP 패턴을 알아보고 이를 통해 얻을 수 있는 장점에 대해 알아보겠습니다. Write-Audit-Publish…"}}}},"pageContext":{"slug":"write-audit-publish","basePath":"","prev":{"slug":"rag-application-for-production-1","publishDate":"2024-10-13"},"next":{"slug":"llm-dataplatform","publishDate":"2024-01-21"}}},"staticQueryHashes":["1946181227","2744905544","3732430097"]}