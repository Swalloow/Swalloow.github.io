{"componentChunkName":"component---src-templates-post-js","path":"/spark-shuffling/","result":{"data":{"contentfulPost":{"title":"Spark의 Shuffling 이해하기","slug":"spark-shuffling","metaDescription":null,"publishDate":"August 25, 2017","publishDateISO":"2017-08-25","tags":[{"title":"DataEngineering","id":"25d7d0d6-3cf7-5e19-a5cb-9c3fa926046f","slug":"dataengineering"}],"heroImage":{"title":"cover-dataengineering","gatsbyImageData":{"images":{"sources":[{"srcSet":"https://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=400&h=267&q=50&fm=webp 400w,\nhttps://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=800&h=533&q=50&fm=webp 800w,\nhttps://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=1600&h=1067&q=50&fm=webp 1600w","sizes":"(min-width: 1600px) 1600px, 100vw","type":"image/webp"}],"fallback":{"src":"https://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=1600&h=1067&fl=progressive&q=50&fm=jpg","srcSet":"https://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=400&h=267&fl=progressive&q=50&fm=jpg 400w,\nhttps://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=800&h=533&fl=progressive&q=50&fm=jpg 800w,\nhttps://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=1600&h=1067&fl=progressive&q=50&fm=jpg 1600w","sizes":"(min-width: 1600px) 1600px, 100vw"}},"layout":"constrained","width":1800,"height":1200,"placeholder":{"fallback":"data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEAlgCWAAD/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wAARCAANABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAMBAgb/xAAcEAACAgMBAQAAAAAAAAAAAAAAAQIREiExYeH/xAAWAQEBAQAAAAAAAAAAAAAAAAABAgP/xAAUEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwDK1DF0vgtxW9EylQu8nTotmo+gHfAEP//Z"}},"ogimg":{"src":"https://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=1800&q=50"}},"body":{"childMarkdownRemark":{"timeToRead":2,"html":"<p>효율적인 Spark Application을 개발하기 위해 <strong>Shuffling</strong> 은 상당히 중요한 개념입니다.\n이에 대해 간단히 정리해보았습니다.</p>\n<br>\n<h2 id=\"spark-architecture-shuffle\" style=\"position:relative;\"><a href=\"#spark-architecture-shuffle\" aria-label=\"spark architecture shuffle permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Spark Architecture: Shuffle</h2>\n<p><span\n        class=\"gatsby-resp-image-wrapper\"\n        style=\"position: relative; display: block; ; max-width: 650px; margin-left: auto; margin-right: auto;\"\n      >\n        <span\n          class=\"gatsby-resp-image-background-image\"\n          style=\"padding-bottom: 51.078167115902964%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,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'); background-size: cover; display: block;\"\n        >\n          <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"shuffle\"\n        title=\"\"\n        src=\"https://images.ctfassets.net/tushy4jlcik7/3fP7fYiSGEL6nBHzgL6ecs/8f09dc1944d8620be57f0a537329bca3/shuffle.png\"\n        srcset=\"https://images.ctfassets.net/tushy4jlcik7/3fP7fYiSGEL6nBHzgL6ecs/8f09dc1944d8620be57f0a537329bca3/shuffle.png?w=371 371w,\nhttps://images.ctfassets.net/tushy4jlcik7/3fP7fYiSGEL6nBHzgL6ecs/8f09dc1944d8620be57f0a537329bca3/shuffle.png?w=742 742w,\nhttps://images.ctfassets.net/tushy4jlcik7/3fP7fYiSGEL6nBHzgL6ecs/8f09dc1944d8620be57f0a537329bca3/shuffle.png?w=1484 1484w\"\n        sizes=\"(max-width: 650px) 100vw, 650px\"\n        loading=\"lazy\"\n      />\n        </span>\n      </span></p>\n<p>Shuffle을 설명하기 전에 한 가지 예시를 들어보겠습니다.\n테이블에 전화 통화 기록 목록이 있고 매일 발생한 통화량을 계산한다고 가정 해보겠습니다.\n“날짜”를 키로 설정하고 각 레코드에 대해 값으로 “1”을 지정한 다음, 각 키의 값을 합산하여 결과 값을 계산할 수 있을 것 입니다.</p>\n<p>만일 데이터가 여러 클러스터에 저장되어 있다면 어떻게 해야 동일한 키의 값을 합산할 수 있을까요?\n이를 위한 유일한 방법은 같은 키의 모든 값을 동일한 시스템에 두는 것입니다. 그런 다음 이 값들을 합치면 됩니다.</p>\n<br>\n<h2 id=\"narrow-and-wide-transformation\" style=\"position:relative;\"><a href=\"#narrow-and-wide-transformation\" aria-label=\"narrow and wide transformation permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Narrow and Wide Transformation</h2>\n<p><span\n        class=\"gatsby-resp-image-wrapper\"\n        style=\"position: relative; display: block; ; max-width: 650px; margin-left: auto; margin-right: auto;\"\n      >\n        <span\n          class=\"gatsby-resp-image-background-image\"\n          style=\"padding-bottom: 63.89111289031224%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,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'); background-size: cover; display: block;\"\n        >\n          <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"narrow and wide\"\n        title=\"\"\n        src=\"https://images.ctfassets.net/tushy4jlcik7/3MR55280VY3jq97WtgvlqZ/ccfe293913bd8be4c76d3bca47b8e315/narrow_and_wide.png\"\n        srcset=\"https://images.ctfassets.net/tushy4jlcik7/3MR55280VY3jq97WtgvlqZ/ccfe293913bd8be4c76d3bca47b8e315/narrow_and_wide.png?w=312 312w,\nhttps://images.ctfassets.net/tushy4jlcik7/3MR55280VY3jq97WtgvlqZ/ccfe293913bd8be4c76d3bca47b8e315/narrow_and_wide.png?w=625 625w,\nhttps://images.ctfassets.net/tushy4jlcik7/3MR55280VY3jq97WtgvlqZ/ccfe293913bd8be4c76d3bca47b8e315/narrow_and_wide.png?w=1249 1249w\"\n        sizes=\"(max-width: 650px) 100vw, 650px\"\n        loading=\"lazy\"\n      />\n        </span>\n      </span></p>\n<p>몇 가지 사례를 통해 더 자세히 알아보겠습니다.\n만일 데이터가 이미 키 값으로 파티셔닝 되어 있고 키 값에 대해 변화를 주고 싶다면, 좌측의 그림처럼 수행하게 됩니다.\n<code class=\"language-text\">filter(), sample(), map(), flatMap()</code> 등의 transformation이 이에 해당하며, 이 경우 Shuffle이 필요 없습니다.\n이를 <strong>Narrow Transformation</strong> 이라고 합니다.</p>\n<p>반면, 서로 다른 파티션으로부터 특정한 값을 기준으로 추출하고 싶은 경우, 그 값을 기준으로 Shuffle이 발생하게 됩니다.\n<code class=\"language-text\">groupByKey(), reduceByKey()</code> 등이 이에 해당하며, 이를 <strong>Wide Transformation</strong> 이라고 합니다.</p>\n<br>\n<h2 id=\"shuffled-hashjoin\" style=\"position:relative;\"><a href=\"#shuffled-hashjoin\" aria-label=\"shuffled hashjoin permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Shuffled HashJoin</h2>\n<p><span\n        class=\"gatsby-resp-image-wrapper\"\n        style=\"position: relative; display: block; ; max-width: 650px; margin-left: auto; margin-right: auto;\"\n      >\n        <span\n          class=\"gatsby-resp-image-background-image\"\n          style=\"padding-bottom: 60.83061889250815%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAYCAYAAACIhL/AAAAACXBIWXMAABcRAAAXEQHKJvM/AAAAB3RJTUUH6AEUDTMq89DlggAABXVJREFUSMe1l21MW1UYxztg0/gSDcRP6jRBZOCcMU4/mJiYmChu4JhhW11wQgJb4pxOfAHdhjLYYO4FVhgDCgxJ5rLWQYHSwcpagcteoGPQAqUtjJeSeJH2toWuHbDyeM5pe+naLoOiJ/n1nPvc5/7z7zn3Pudejkwmu08pBh3ULc0iCswSYgitbsixevXqcI5Xi4iIiFJrdD75/jT8xa7dGnQgbzbOgFrjOCAwwkEhA3kNZtIfEBjg54sGMj4psXjEpsg4t96Zh6ENZlizZo2Pwejo6KjxKTub59b+6cKkTyzDTyyndgp0Op2dox7UOJILlZBcpIL9lQOkT+L1QlJhrzNW4Rv7it9Pesz1zm4IDg5+25/BEXqGzXNrf3H69pJiX/P7nAaHhoYcqMFSsU8bwTqlZ1m4P48Nvo88RXobBNSWo20zTbK6d6cmFg3CMprlch4YizaB8Uws2ErjYJoecS/xM4i3EEGeBpfTTBf2gpH3EdFnij8JzKBRkgc0Lxbooi1gKo6Fm7JGPIPvuCYuGLER8XQgBqf+2Ad0QQzQhXFAF3/qNCiRSCiVStWxVJS9PR29PbdZVCplh8vg6x4rHBUWFvbucnS9tZUI5E3O+Q/b467Ze8p1/AJi3YpVy8vLvxOLxd+vhJCQkGc9JLGpl9auXRtWVVWVnZaWdlwkEgWky+fz93M0Gq2jtusuiBQ2Fnxc4xUTKXDM6hWzge3evL86+FxoaOg2g2UWajqtcLyagovt/5D8S50zPhr+YuJuq/MexIV6N38M9pTr4XANTfrd/FFwx3LrJl2xMRLH40OCv0mPoW4oAM1gtJ+dJLpBSkEyr4/k7S9qh10nFZBaOsJe69ZOLb3jE0urHnMa1Gi1DiE1BsL2RQTto4RHxTD2WVIHP0Se3kA86VkHmZl7UFnbAblVMpJbLe6CoxVXfDQEbSM+sfob+sDKzIyyCYzNpwjTLfkwO2N0L/EqxCtuo55lxmw2g0KhgLm5ObBYLNDV1UUKs3czXz/PajPSggALddMxMPG3galiJ9jPbQdFWzNe4jc9VhcbjUD34Far1cpet7CwAD09PUDTNDGHTWKzDxj88wdgzm4h2qaqXQHOYH8LMFfPEKblxWgGGbzE7yFTGxDrXeWGExUVFa3VaokpT6Pj4+PQ19dHxmq1GiYmJhb/fKeA1WZkZ50GMzMzt/B4vPiVgAy67z28zUVgs2jZN+bn529FxCckJHATExMzs7KyduL89PT0eC6Xm46PU1JStiUlJWX400Xe4jj/Y3vMNaMbXEV7lcs8vkefcD9LiBfx1ugq8sE+Kmg7aUfbDLUS0Avr89664eHhL7vPt7W19dfV1fWUlJRQLS0tHU1NTRo0sxTqqdbW1v6ysjIK3QrX0HmlUChkdRsbG2XkfTBHZIKjdWb4TWwhfU4tA9kIPMYvrLg/gnKya4xkfKLRGcOYpu34KX7V9e9ZIiMj1/cN0WwevuYI6tNKe2FfAQV7T/0F2QI9OfeLgIYvT8rh0PlRyKszOPPFxsVCzeVp4TOeDr75fYT03NMaAh5/Wz3qE9tTfof0mM5upbsOrvMEvSxsrm2+xua5r9lRoGb1th+WwscZYog92IxiWth08Ap8fqyVnE8t1ToNoh/HxKQJPNG7eFQMg0vGw1755+bv++TracYnNqqnQd5+AyTSVqiXSKGmoRnUQ2OBlRmmpRDoswkIVAvLd4DNMPFQg8vRnZ2dBYPwR+j89QPQndgMwwXxKyjUZdgcF+yVCdBNSSEoKCgGeXrNE7TEcbjeLRX0sIC+cjcwhTHAlGwlmwExKJfLHcPDw7BU+m/KoffqJYJSVgPawQF42GfncnQxKuryA9ros9P+L241uownC7ixAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n        >\n          <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"shuffle join\"\n        title=\"\"\n        src=\"https://images.ctfassets.net/tushy4jlcik7/5UW8BXEFxUTnUiCTERknJh/79783cc53e1824dae0f3ead7e85cb08d/shuffle_join.png\"\n        srcset=\"https://images.ctfassets.net/tushy4jlcik7/5UW8BXEFxUTnUiCTERknJh/79783cc53e1824dae0f3ead7e85cb08d/shuffle_join.png?w=307 307w,\nhttps://images.ctfassets.net/tushy4jlcik7/5UW8BXEFxUTnUiCTERknJh/79783cc53e1824dae0f3ead7e85cb08d/shuffle_join.png?w=614 614w,\nhttps://images.ctfassets.net/tushy4jlcik7/5UW8BXEFxUTnUiCTERknJh/79783cc53e1824dae0f3ead7e85cb08d/shuffle_join.png?w=1228 1228w\"\n        sizes=\"(max-width: 650px) 100vw, 650px\"\n        loading=\"lazy\"\n      />\n        </span>\n      </span></p>\n<p>두 개의 테이블을 <code class=\"language-text\">Join</code> 할 때에도 Shuffle 이 발생할 수 있습니다.\n위의 예시 처럼 두 테이블에서 키 값을 기준으로 Join 하게 되면, 동일한 키를 가진 데이터가 동일한 파티션으로 이동합니다.</p>\n<p>하지만 이 때, 셔플 되는 데이터의 양이 성능에 영향을 미칠 수 있습니다.\n만일 C의 데이터의 크기가 A보다 훨씬 크다면, C에 대한 작업으로 인해 전체의 수행시간이 오래 걸리게 될 것 입니다.</p>\n<br>\n<h2 id=\"broadcast-hashjoin\" style=\"position:relative;\"><a href=\"#broadcast-hashjoin\" aria-label=\"broadcast hashjoin permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Broadcast HashJoin</h2>\n<p><span\n        class=\"gatsby-resp-image-wrapper\"\n        style=\"position: relative; display: block; ; max-width: 650px; margin-left: auto; margin-right: auto;\"\n      >\n        <span\n          class=\"gatsby-resp-image-background-image\"\n          style=\"padding-bottom: 60.83061889250815%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAYCAYAAACIhL/AAAAACXBIWXMAABcRAAAXEQHKJvM/AAAAB3RJTUUH6AEUDTMq89DlggAABXRJREFUSMetl2tMk1cYx4uA4cO2BBwDdyVjmIjZls1tH5bFD2bzghRkoKCZmX5As+zmLskYIsu8uyiD1lah1WUsZg4DLVIYuFISLmabYKGA0AtS5GIrtm9rkaJSnj3ntO/blxYnFk/y4xz+Oc8//7Tved5TgUajmW5t7/e0duj9tBPmoSEGo8kTGRmZKAgYSUlJy/v0xqD9c3nMpV3q6PdgtknB1T69Z0+FDQrO2+FIjYPOeypuQf4ft+j6eJ2Tp43T9eEL3n0Ex8RdWLx4cVDA5OTk5dfH3dw+1vv7362cxnrn8TTW+4BiHIxGo1vQ16/37BDrYMeJbth95iqdt4u6YLu4y6udDtY+k/XSmeCcmHpgwEGLi9vHen9covVrp4M11vsLWY83oMlk8uCA+eK+bYOJ8WGOmen7DwwIOPy107PqHgap4QLCIwznn0fAdiIFbJJUmCwVQv+VNggPD1+FmV7iExcX977ZbAaWzo7L4JBgnWiNF/SwS4TglqVTL5toLdXtqDOSDeC5fy+0gLa6I2ARpYLlRDow0lQ4VXSIBHwPQz3BJyEhYaXL5QLCyMgI/FC4F8ZEQrhRvI5iEQuph6M0g66pXvQBWEpSwCpK8Qesq6tr7e7ubpsvuq7Otq5OLUdDfX1bWFhYGoZ6hf8VJyYmJpD9arW6VyqVdioUiks6Xt3/QfaRWszWJHhM4zXkaeRNJIynv4rEIW+E7CyXy79RqVTfLoSIiIgYtHodCUfeQmKjoqLWnjt3rqCwsPAQzntD8ZXJZLsFer3Bo7h8B5Ttkxzk/6oATdlOtIkAbRImp7hT/DwJhjyDpC9dunTN2E0GJFXds/ZX/usK8phLU12Z8D6DpFHvlA3BLvkw7Kuy0HmnzAysdrja6tOGqE7Weytu0JngmN0H032nWBAfH/9u0clybh/rnVs6yGmsd27pNU5jvb8uH/IG1BsMnvOtQ3C+xU9Fi5nyMI0wdZd+gkmYaaXveUsmAZcsWbLKMGCGg2U1cLbR6PdpHgzymEu78PdwaG3GpasHW0MR5bb6ZxgfHYRFixZt9D1/9ACTAxMbG5tF9s/MzIBWq4Wx0RFgLhZxtQS7z4OvUR33zWBjD61R1x8FRrYJmNNbwf3LZpAeP0gCrsdQK3h8FxMTk9bT0wMsn36yCxzybLBLhUga2GWbgTmzFaZ+2waMPMerkSZdmgmOsszQG7WrVw32RgnldpMUrMPXSMA0Xnt5llxm8E2SytbodDoYuT4EjEbC1fI9AjWyj/sEsQ2ki0SijQsB3yRP+drLk752I8Dn8p2CgoJt2dnZefn5+SH5Yjah4DGPDOQF35o07i0BjfvRB75OWvC10roQ8ML6HDm4yIu+frg6Ojp6dXNzs1apVIbsW1tbq6H3wQNKBg5VO+AnlZPOBxR22I+QNblUkvkg7tlfZaPrY7VejeC8w11Y2dcZ+YpfxkOy+frNO/B5cSutZb33Vd7ialnvH3ka631MZfM36hyRAbaIjPDlr4N0zinRU8j6q3JzkLZLfo3OBMY1RW4zGzBUNPI2efxIymXLliVXN7RA1tEOWJ9Xw3lnF/dxtaw3X2O9c0sN3oD4xzNiZYDPsI+HaQSn00lOcabvYhDGv7Deuz8NLZcug7L2Imh7jV4fiz3IYy5tbNwRWpuxq8VgOZmFYC/EvnZWJmbvg3PeqMkYHR0FcUkxWGkdIXOWB5ktUr9mPbVpgY26bBNtru4zWdD2l4p8gusCGvUKfNUJ+Y26plqBjRqbM23UCPXYAlPlH9GQVBOvB/upDLzEfugP2NTU5BkYGID50vtPE3Q1VlJ0miow9F+FB/3s5NeZjEbcX8nV8j0CtS7cN2AyAf7sdP8Hyn6MCRFbKX8AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n        >\n          <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"broadcast join\"\n        title=\"\"\n        src=\"https://images.ctfassets.net/tushy4jlcik7/2uLtkdnwuEke0F2ULvRfDD/48413f8752d889d652ee925b9c946745/broadcast_join.png\"\n        srcset=\"https://images.ctfassets.net/tushy4jlcik7/2uLtkdnwuEke0F2ULvRfDD/48413f8752d889d652ee925b9c946745/broadcast_join.png?w=307 307w,\nhttps://images.ctfassets.net/tushy4jlcik7/2uLtkdnwuEke0F2ULvRfDD/48413f8752d889d652ee925b9c946745/broadcast_join.png?w=614 614w,\nhttps://images.ctfassets.net/tushy4jlcik7/2uLtkdnwuEke0F2ULvRfDD/48413f8752d889d652ee925b9c946745/broadcast_join.png?w=1228 1228w\"\n        sizes=\"(max-width: 650px) 100vw, 650px\"\n        loading=\"lazy\"\n      />\n        </span>\n      </span></p>\n<p>이를 개선하기 위해 Spark에서는 <strong>Broadcast Join</strong> 을 제공합니다.\n이 경우 RDD 중 하나가 모든 파티션으로 브로드 캐스팅되며 복사됩니다.\n만일 RDD 중 하나가 다른 것에 비해 상당히 작다면 큰 RDD가 전혀 셔플 할 필요가 없습니다.\n작은 RDD 만 모든 작업자 서버에 복사해야 하므로 Broadcast Join은 전체적으로 네트워크 트래픽을 줄여주는 효과가 있습니다.</p>\n<p>Spark 1.2에서는 <code class=\"language-text\">spark.sql.autoBroadcastJoinThreshold</code> 값을 설정해주어야 했지만,\n2.0 이후 버전의 경우 Spark SQL이 알아서 최적화 잘 해줍니다.</p>\n<br>\n<h2 id=\"spark-shuffle-properties\" style=\"position:relative;\"><a href=\"#spark-shuffle-properties\" aria-label=\"spark shuffle properties permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Spark Shuffle Properties</h2>\n<ul>\n<li><code class=\"language-text\">spark.shuffle.compress</code>: 엔진이 shuffle 출력을 압축할지 여부를 지정</li>\n<li><code class=\"language-text\">spark.shuffle.spill.compress</code>: 중간 shuffle spill 파일을 압축할지 여부를 지정</li>\n</ul>\n<p>Shuffle에는 위의 두 가지 중요한 Spark Property 가 있습니다.</p>\n<p>둘 다 기본적으로 값이 “true”이며, <code class=\"language-text\">spark.io.compression.codec</code> 압축 코덱을 기본으로합니다.\n그리고 위에서 설명한 것처럼 Spark에는 여러 가지 셔플 구현이 있습니다.\n특정 구현에서 사용되는 Shuffle은 <code class=\"language-text\">spark.shuffle.manager</code> 값에 의해 결정됩니다.\n가능한 옵션은 <strong>hash, sort, tungsten-sort</strong> 이며, “sort” 옵션은 기본적으로 Spark 1.2.0부터 시작합니다.</p>\n<p>이외에도 Spark Shuffle 관련된 Property는 아래의 공식문서에서 확인하실 수 있습니다.\n<a href=\"https://spark.apache.org/docs/latest/configuration.html#shuffle-behavior\">https://spark.apache.org/docs/latest/configuration.html#shuffle-behavior</a></p>\n<br>\n<h2 id=\"reference\" style=\"position:relative;\"><a href=\"#reference\" aria-label=\"reference permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Reference</h2>\n<ul>\n<li><a href=\"https://0x0fff.com/spark-architecture-shuffle\">https://0x0fff.com/spark-architecture-shuffle</a></li>\n<li><a href=\"https://www.slideshare.net/databricks/strata-sj-everyday-im-shuffling-tips-for-writing-better-spark-programs\">https://www.slideshare.net/databricks/strata-sj-everyday-im-shuffling-tips-for-writing-better-spark-programs</a></li>\n</ul>\n<br>","excerpt":"효율적인 Spark Application을 개발하기 위해 Shuffling 은 상당히 중요한 개념입니다.\n이에 대해 간단히 정리해보았습니다. Spark Architecture: Shuffle  Shuffle을 설명하기 전에 한 가지 예시를 들어보겠습니다.\n테이블에 전화 통화 기록 목록이 있고 매일 발생한 통화량을 계산한다고 가정 해보겠습니다.\n“날짜”를 키로 설정하고 각 레코드에 대해 값으로 “…"}}}},"pageContext":{"slug":"spark-shuffling","basePath":"","prev":{"slug":"aws-emr-s3-spark","publishDate":"2017-09-09"},"next":{"slug":"spark-reduceByKey-groupByKey","publishDate":"2017-08-22"}}},"staticQueryHashes":["1946181227","2744905544","3732430097"]}