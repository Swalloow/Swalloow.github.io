{"componentChunkName":"component---src-templates-post-js","path":"/spark-shuffling/","result":{"data":{"contentfulPost":{"title":"Spark의 Shuffling 이해하기","slug":"spark-shuffling","metaDescription":null,"publishDate":"August 25, 2017","publishDateISO":"2017-08-25","tags":[{"title":"DataEngineering","id":"25d7d0d6-3cf7-5e19-a5cb-9c3fa926046f","slug":"dataengineering"}],"heroImage":{"title":"cover-dataengineering","gatsbyImageData":{"images":{"sources":[{"srcSet":"https://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=400&h=267&q=50&fm=webp 400w,\nhttps://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=800&h=533&q=50&fm=webp 800w,\nhttps://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=1600&h=1067&q=50&fm=webp 1600w","sizes":"(min-width: 1600px) 1600px, 100vw","type":"image/webp"}],"fallback":{"src":"https://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=1600&h=1067&fl=progressive&q=50&fm=jpg","srcSet":"https://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=400&h=267&fl=progressive&q=50&fm=jpg 400w,\nhttps://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=800&h=533&fl=progressive&q=50&fm=jpg 800w,\nhttps://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=1600&h=1067&fl=progressive&q=50&fm=jpg 1600w","sizes":"(min-width: 1600px) 1600px, 100vw"}},"layout":"constrained","width":1800,"height":1200,"placeholder":{"fallback":"data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wAARCAANABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAIBAwb/xAAcEAACAgMBAQAAAAAAAAAAAAAAAQIREiFBMeH/xAAWAQEBAQAAAAAAAAAAAAAAAAABAgP/xAAUEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwDK1DF0vgjileglOuFeTk6fC2ZH6BKV7ugEP//Z"}},"ogimg":{"src":"https://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=1800&q=50"}},"body":{"childMarkdownRemark":{"timeToRead":2,"html":"<p>효율적인 Spark Application을 개발하기 위해 <strong>Shuffling</strong> 은 상당히 중요한 개념입니다.\n이에 대해 간단히 정리해보았습니다.</p>\n<br>\n<h2 id=\"spark-architecture-shuffle\" style=\"position:relative;\"><a href=\"#spark-architecture-shuffle\" aria-label=\"spark architecture shuffle permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Spark Architecture: Shuffle</h2>\n<p><span\n        class=\"gatsby-resp-image-wrapper\"\n        style=\"position: relative; display: block; ; max-width: 650px; margin-left: auto; margin-right: auto;\"\n      >\n        <span\n          class=\"gatsby-resp-image-background-image\"\n          style=\"padding-bottom: 51.078167115902964%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,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'); background-size: cover; display: block;\"\n        >\n          <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"shuffle\"\n        title=\"\"\n        src=\"https://images.ctfassets.net/tushy4jlcik7/3fP7fYiSGEL6nBHzgL6ecs/8f09dc1944d8620be57f0a537329bca3/shuffle.png\"\n        srcset=\"https://images.ctfassets.net/tushy4jlcik7/3fP7fYiSGEL6nBHzgL6ecs/8f09dc1944d8620be57f0a537329bca3/shuffle.png?w=371 371w,\nhttps://images.ctfassets.net/tushy4jlcik7/3fP7fYiSGEL6nBHzgL6ecs/8f09dc1944d8620be57f0a537329bca3/shuffle.png?w=742 742w,\nhttps://images.ctfassets.net/tushy4jlcik7/3fP7fYiSGEL6nBHzgL6ecs/8f09dc1944d8620be57f0a537329bca3/shuffle.png?w=1484 1484w\"\n        sizes=\"(max-width: 650px) 100vw, 650px\"\n        loading=\"lazy\"\n      />\n        </span>\n      </span></p>\n<p>Shuffle을 설명하기 전에 한 가지 예시를 들어보겠습니다.\n테이블에 전화 통화 기록 목록이 있고 매일 발생한 통화량을 계산한다고 가정 해보겠습니다.\n“날짜”를 키로 설정하고 각 레코드에 대해 값으로 “1”을 지정한 다음, 각 키의 값을 합산하여 결과 값을 계산할 수 있을 것 입니다.</p>\n<p>만일 데이터가 여러 클러스터에 저장되어 있다면 어떻게 해야 동일한 키의 값을 합산할 수 있을까요?\n이를 위한 유일한 방법은 같은 키의 모든 값을 동일한 시스템에 두는 것입니다. 그런 다음 이 값들을 합치면 됩니다.</p>\n<br>\n<h2 id=\"narrow-and-wide-transformation\" style=\"position:relative;\"><a href=\"#narrow-and-wide-transformation\" aria-label=\"narrow and wide transformation permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Narrow and Wide Transformation</h2>\n<p><span\n        class=\"gatsby-resp-image-wrapper\"\n        style=\"position: relative; display: block; ; max-width: 650px; margin-left: auto; margin-right: auto;\"\n      >\n        <span\n          class=\"gatsby-resp-image-background-image\"\n          style=\"padding-bottom: 63.89111289031224%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,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'); background-size: cover; display: block;\"\n        >\n          <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"narrow and wide\"\n        title=\"\"\n        src=\"https://images.ctfassets.net/tushy4jlcik7/3MR55280VY3jq97WtgvlqZ/ccfe293913bd8be4c76d3bca47b8e315/narrow_and_wide.png\"\n        srcset=\"https://images.ctfassets.net/tushy4jlcik7/3MR55280VY3jq97WtgvlqZ/ccfe293913bd8be4c76d3bca47b8e315/narrow_and_wide.png?w=312 312w,\nhttps://images.ctfassets.net/tushy4jlcik7/3MR55280VY3jq97WtgvlqZ/ccfe293913bd8be4c76d3bca47b8e315/narrow_and_wide.png?w=625 625w,\nhttps://images.ctfassets.net/tushy4jlcik7/3MR55280VY3jq97WtgvlqZ/ccfe293913bd8be4c76d3bca47b8e315/narrow_and_wide.png?w=1249 1249w\"\n        sizes=\"(max-width: 650px) 100vw, 650px\"\n        loading=\"lazy\"\n      />\n        </span>\n      </span></p>\n<p>몇 가지 사례를 통해 더 자세히 알아보겠습니다.\n만일 데이터가 이미 키 값으로 파티셔닝 되어 있고 키 값에 대해 변화를 주고 싶다면, 좌측의 그림처럼 수행하게 됩니다.\n<code class=\"language-text\">filter(), sample(), map(), flatMap()</code> 등의 transformation이 이에 해당하며, 이 경우 Shuffle이 필요 없습니다.\n이를 <strong>Narrow Transformation</strong> 이라고 합니다.</p>\n<p>반면, 서로 다른 파티션으로부터 특정한 값을 기준으로 추출하고 싶은 경우, 그 값을 기준으로 Shuffle이 발생하게 됩니다.\n<code class=\"language-text\">groupByKey(), reduceByKey()</code> 등이 이에 해당하며, 이를 <strong>Wide Transformation</strong> 이라고 합니다.</p>\n<br>\n<h2 id=\"shuffled-hashjoin\" style=\"position:relative;\"><a href=\"#shuffled-hashjoin\" aria-label=\"shuffled hashjoin permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Shuffled HashJoin</h2>\n<p><span\n        class=\"gatsby-resp-image-wrapper\"\n        style=\"position: relative; display: block; ; max-width: 650px; margin-left: auto; margin-right: auto;\"\n      >\n        <span\n          class=\"gatsby-resp-image-background-image\"\n          style=\"padding-bottom: 60.83061889250815%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,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'); background-size: cover; display: block;\"\n        >\n          <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"shuffle join\"\n        title=\"\"\n        src=\"https://images.ctfassets.net/tushy4jlcik7/5UW8BXEFxUTnUiCTERknJh/79783cc53e1824dae0f3ead7e85cb08d/shuffle_join.png\"\n        srcset=\"https://images.ctfassets.net/tushy4jlcik7/5UW8BXEFxUTnUiCTERknJh/79783cc53e1824dae0f3ead7e85cb08d/shuffle_join.png?w=307 307w,\nhttps://images.ctfassets.net/tushy4jlcik7/5UW8BXEFxUTnUiCTERknJh/79783cc53e1824dae0f3ead7e85cb08d/shuffle_join.png?w=614 614w,\nhttps://images.ctfassets.net/tushy4jlcik7/5UW8BXEFxUTnUiCTERknJh/79783cc53e1824dae0f3ead7e85cb08d/shuffle_join.png?w=1228 1228w\"\n        sizes=\"(max-width: 650px) 100vw, 650px\"\n        loading=\"lazy\"\n      />\n        </span>\n      </span></p>\n<p>두 개의 테이블을 <code class=\"language-text\">Join</code> 할 때에도 Shuffle 이 발생할 수 있습니다.\n위의 예시 처럼 두 테이블에서 키 값을 기준으로 Join 하게 되면, 동일한 키를 가진 데이터가 동일한 파티션으로 이동합니다.</p>\n<p>하지만 이 때, 셔플 되는 데이터의 양이 성능에 영향을 미칠 수 있습니다.\n만일 C의 데이터의 크기가 A보다 훨씬 크다면, C에 대한 작업으로 인해 전체의 수행시간이 오래 걸리게 될 것 입니다.</p>\n<br>\n<h2 id=\"broadcast-hashjoin\" style=\"position:relative;\"><a href=\"#broadcast-hashjoin\" aria-label=\"broadcast hashjoin permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Broadcast HashJoin</h2>\n<p><span\n        class=\"gatsby-resp-image-wrapper\"\n        style=\"position: relative; display: block; ; max-width: 650px; margin-left: auto; margin-right: auto;\"\n      >\n        <span\n          class=\"gatsby-resp-image-background-image\"\n          style=\"padding-bottom: 60.83061889250815%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,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'); background-size: cover; display: block;\"\n        >\n          <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"broadcast join\"\n        title=\"\"\n        src=\"https://images.ctfassets.net/tushy4jlcik7/2uLtkdnwuEke0F2ULvRfDD/48413f8752d889d652ee925b9c946745/broadcast_join.png\"\n        srcset=\"https://images.ctfassets.net/tushy4jlcik7/2uLtkdnwuEke0F2ULvRfDD/48413f8752d889d652ee925b9c946745/broadcast_join.png?w=307 307w,\nhttps://images.ctfassets.net/tushy4jlcik7/2uLtkdnwuEke0F2ULvRfDD/48413f8752d889d652ee925b9c946745/broadcast_join.png?w=614 614w,\nhttps://images.ctfassets.net/tushy4jlcik7/2uLtkdnwuEke0F2ULvRfDD/48413f8752d889d652ee925b9c946745/broadcast_join.png?w=1228 1228w\"\n        sizes=\"(max-width: 650px) 100vw, 650px\"\n        loading=\"lazy\"\n      />\n        </span>\n      </span></p>\n<p>이를 개선하기 위해 Spark에서는 <strong>Broadcast Join</strong> 을 제공합니다.\n이 경우 RDD 중 하나가 모든 파티션으로 브로드 캐스팅되며 복사됩니다.\n만일 RDD 중 하나가 다른 것에 비해 상당히 작다면 큰 RDD가 전혀 셔플 할 필요가 없습니다.\n작은 RDD 만 모든 작업자 서버에 복사해야 하므로 Broadcast Join은 전체적으로 네트워크 트래픽을 줄여주는 효과가 있습니다.</p>\n<p>Spark 1.2에서는 <code class=\"language-text\">spark.sql.autoBroadcastJoinThreshold</code> 값을 설정해주어야 했지만,\n2.0 이후 버전의 경우 Spark SQL이 알아서 최적화 잘 해줍니다.</p>\n<br>\n<h2 id=\"spark-shuffle-properties\" style=\"position:relative;\"><a href=\"#spark-shuffle-properties\" aria-label=\"spark shuffle properties permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Spark Shuffle Properties</h2>\n<ul>\n<li><code class=\"language-text\">spark.shuffle.compress</code>: 엔진이 shuffle 출력을 압축할지 여부를 지정</li>\n<li><code class=\"language-text\">spark.shuffle.spill.compress</code>: 중간 shuffle spill 파일을 압축할지 여부를 지정</li>\n</ul>\n<p>Shuffle에는 위의 두 가지 중요한 Spark Property 가 있습니다.</p>\n<p>둘 다 기본적으로 값이 “true”이며, <code class=\"language-text\">spark.io.compression.codec</code> 압축 코덱을 기본으로합니다.\n그리고 위에서 설명한 것처럼 Spark에는 여러 가지 셔플 구현이 있습니다.\n특정 구현에서 사용되는 Shuffle은 <code class=\"language-text\">spark.shuffle.manager</code> 값에 의해 결정됩니다.\n가능한 옵션은 <strong>hash, sort, tungsten-sort</strong> 이며, “sort” 옵션은 기본적으로 Spark 1.2.0부터 시작합니다.</p>\n<p>이외에도 Spark Shuffle 관련된 Property는 아래의 공식문서에서 확인하실 수 있습니다.\n<a href=\"https://spark.apache.org/docs/latest/configuration.html#shuffle-behavior\">https://spark.apache.org/docs/latest/configuration.html#shuffle-behavior</a></p>\n<br>\n<h2 id=\"reference\" style=\"position:relative;\"><a href=\"#reference\" aria-label=\"reference permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Reference</h2>\n<ul>\n<li><a href=\"https://0x0fff.com/spark-architecture-shuffle\">https://0x0fff.com/spark-architecture-shuffle</a></li>\n<li><a href=\"https://www.slideshare.net/databricks/strata-sj-everyday-im-shuffling-tips-for-writing-better-spark-programs\">https://www.slideshare.net/databricks/strata-sj-everyday-im-shuffling-tips-for-writing-better-spark-programs</a></li>\n</ul>\n<br>","excerpt":"효율적인 Spark Application을 개발하기 위해 Shuffling 은 상당히 중요한 개념입니다.\n이에 대해 간단히 정리해보았습니다. Spark Architecture: Shuffle  Shuffle을 설명하기 전에 한 가지 예시를 들어보겠습니다.\n테이블에 전화 통화 기록 목록이 있고 매일 발생한 통화량을 계산한다고 가정 해보겠습니다.\n“날짜”를 키로 설정하고 각 레코드에 대해 값으로 “…"}}}},"pageContext":{"slug":"spark-shuffling","basePath":"","prev":{"slug":"aws-emr-s3-spark","publishDate":"2017-09-09"},"next":{"slug":"spark-reduceByKey-groupByKey","publishDate":"2017-08-22"}}},"staticQueryHashes":["1946181227","2744905544","3732430097"]}