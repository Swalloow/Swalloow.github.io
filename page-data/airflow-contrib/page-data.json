{"componentChunkName":"component---src-templates-post-js","path":"/airflow-contrib/","result":{"data":{"contentfulPost":{"title":"Apache Airflow에 기여하면서 배운 점들","slug":"airflow-contrib","metaDescription":null,"publishDate":"December 08, 2018","publishDateISO":"2018-12-08","tags":[{"title":"DataEngineering","id":"25d7d0d6-3cf7-5e19-a5cb-9c3fa926046f","slug":"dataengineering"}],"heroImage":{"title":"cover-dataengineering","gatsbyImageData":{"images":{"sources":[{"srcSet":"https://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=400&h=267&q=50&fm=webp 400w,\nhttps://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=800&h=533&q=50&fm=webp 800w,\nhttps://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=1600&h=1067&q=50&fm=webp 1600w","sizes":"(min-width: 1600px) 1600px, 100vw","type":"image/webp"}],"fallback":{"src":"https://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=1600&h=1067&fl=progressive&q=50&fm=jpg","srcSet":"https://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=400&h=267&fl=progressive&q=50&fm=jpg 400w,\nhttps://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=800&h=533&fl=progressive&q=50&fm=jpg 800w,\nhttps://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=1600&h=1067&fl=progressive&q=50&fm=jpg 1600w","sizes":"(min-width: 1600px) 1600px, 100vw"}},"layout":"constrained","width":1800,"height":1200,"placeholder":{"fallback":"data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEAlgCWAAD/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wAARCAANABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAMBAgb/xAAcEAACAgMBAQAAAAAAAAAAAAAAAQIREiExYeH/xAAWAQEBAQAAAAAAAAAAAAAAAAABAgP/xAAUEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwDK1DF0vgtxW9EylQu8nTotmo+gHfAEP//Z"}},"ogimg":{"src":"https://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=1800&q=50"}},"body":{"childMarkdownRemark":{"timeToRead":4,"html":"<p>Apache Airflow는 코드를 통해 워크플로우를 관리하고 모니터링 할 수 있도록 도와주는 플랫폼이다.\nAirflow 프로젝트에 대한 설명은 다른 글에서도 많이 다루기 때문에 생략하고\n이 글에서는 처음으로 아파치 프로젝트에 기여해본 경험을 정리해보려 한다.</p>\n<br>\n<h2 id=\"기여하게-된-배경\" style=\"position:relative;\"><a href=\"#%EA%B8%B0%EC%97%AC%ED%95%98%EA%B2%8C-%EB%90%9C-%EB%B0%B0%EA%B2%BD\" aria-label=\"기여하게 된 배경 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>기여하게 된 배경</h2>\n<p>당시에 관리하던 데이터 인프라에는 의존성이 얽혀있는 배치 작업이 상당히 많았다.\n여기에서 의존성이 얽혀있다는 말은 A 작업과 B 작업이 성공적으로 끝나고 난 뒤 C 작업을 해야하는 경우를 말한다.\n또한 각 작업들은 서로 다른 시간에 스케줄링 되어야 했고, 작업이 실패하는 경우 재시도 또는 특정 로직을 실행시킬 수 있어야 했다.</p>\n<p>처음에는 단순한 구조이다 보니 스크립트로 관리했지만 점차 늘어나는 운영 이슈에 대응하기 위해 Airflow를 활용하기로 결정했다.\n하지만 운영하다 보니 AWS 관련 컴포넌트들의 여러 버그를 발견하게 되었고 이를 수정하기 위해 PR을 추가했었다.</p>\n<br>\n<h2 id=\"아파치-프로젝트-pr-프로세스\" style=\"position:relative;\"><a href=\"#%EC%95%84%ED%8C%8C%EC%B9%98-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8-pr-%ED%94%84%EB%A1%9C%EC%84%B8%EC%8A%A4\" aria-label=\"아파치 프로젝트 pr 프로세스 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>아파치 프로젝트 PR 프로세스</h2>\n<p>아파치 프로젝트는 이슈 관리 도구로 JIRA를 사용한다. CI 도구는 프로젝트마다 다른 편인데 Airflow의 경우 TravisCI를 사용한다.\n모든 프로젝트에는 처음 프로젝트에 기여하려는 개발자를 위해 <strong>CONTRIBUTING.md</strong> 라는 문서를 제공한다.\n문서에는 개발 및 테스트 환경을 어떻게 구축해야하는지, 지켜야할 규칙, PR 가이드라인 등에 대해 설명되어 있다.\n그리고 PR template를 준수해야 하는데 잘 모르겠다면, 이전 PR들을 확인하고 비슷한 양식으로 작성하면 된다.</p>\n<p>내가 처음 접했던 Airflow 문서에는 AWS 관련 Hook, Operator도 반영되어 있지 않았다.\n그래서 첫 PR로 AWS, GCP 관련 컴포넌트를 업데이트하는 문서 기여를 하게 되었다.\n문서 관리에는 <a href=\"https://readthedocs.org/\">readthedocs</a>를 사용하고 있었고 Sphinx 빌드를 통해 문서를 확인할 수 있었다.</p>\n<p>사용하다보니 특히 EMR 관련 Hook과 Operator에 버그가 많았다.\n만일 JIRA에 이미 등록되어 있는 이슈가 아니라면 이슈를 새로 생성한 다음 PR을 추가해주어야 한다.</p>\n<p><span\n        class=\"gatsby-resp-image-wrapper\"\n        style=\"position: relative; display: block; ; max-width: 650px; margin-left: auto; margin-right: auto;\"\n      >\n        <span\n          class=\"gatsby-resp-image-background-image\"\n          style=\"padding-bottom: 59.89743589743589%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,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'); background-size: cover; display: block;\"\n        >\n          <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"pr1\"\n        title=\"\"\n        src=\"https://images.ctfassets.net/tushy4jlcik7/3osQpfWzHK4tY5CXDRahJo/bb37e4751c3631d4f96b9159bba46a7b/pr1.png\"\n        srcset=\"https://images.ctfassets.net/tushy4jlcik7/3osQpfWzHK4tY5CXDRahJo/bb37e4751c3631d4f96b9159bba46a7b/pr1.png?w=488 488w,\nhttps://images.ctfassets.net/tushy4jlcik7/3osQpfWzHK4tY5CXDRahJo/bb37e4751c3631d4f96b9159bba46a7b/pr1.png?w=975 975w,\nhttps://images.ctfassets.net/tushy4jlcik7/3osQpfWzHK4tY5CXDRahJo/bb37e4751c3631d4f96b9159bba46a7b/pr1.png?w=1950 1950w\"\n        sizes=\"(max-width: 650px) 100vw, 650px\"\n        loading=\"lazy\"\n      />\n        </span>\n      </span></p>\n<p>비슷한 이슈를 겪고 있는 사람들이 있어서 좀 신기했다.\n그리고 <strong>아주 작은 수정이라도 테스트 케이스를 추가</strong>해야 한다는 사실을 알게 되었다.</p>\n<p><span\n        class=\"gatsby-resp-image-wrapper\"\n        style=\"position: relative; display: block; ; max-width: 650px; margin-left: auto; margin-right: auto;\"\n      >\n        <span\n          class=\"gatsby-resp-image-background-image\"\n          style=\"padding-bottom: 63.306908267270664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,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'); background-size: cover; display: block;\"\n        >\n          <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"pr2\"\n        title=\"\"\n        src=\"https://images.ctfassets.net/tushy4jlcik7/2MTNBdDgOxA1Tcvl1Zhayn/6a024d91a846c60726fedbc2e206dbf4/pr2.png\"\n        srcset=\"https://images.ctfassets.net/tushy4jlcik7/2MTNBdDgOxA1Tcvl1Zhayn/6a024d91a846c60726fedbc2e206dbf4/pr2.png?w=442 442w,\nhttps://images.ctfassets.net/tushy4jlcik7/2MTNBdDgOxA1Tcvl1Zhayn/6a024d91a846c60726fedbc2e206dbf4/pr2.png?w=883 883w,\nhttps://images.ctfassets.net/tushy4jlcik7/2MTNBdDgOxA1Tcvl1Zhayn/6a024d91a846c60726fedbc2e206dbf4/pr2.png?w=1766 1766w\"\n        sizes=\"(max-width: 650px) 100vw, 650px\"\n        loading=\"lazy\"\n      />\n        </span>\n      </span></p>\n<p>양식만 잘 지키면 커미터들은 정말 친절하다. 내가 파악하지 못한 부분까지 알려주고, 코드 리뷰도 받을 수 있다.\n다른 PR을 참고하면서 많이 배울 수 있었다.</p>\n<br>\n<h2 id=\"클라우드-인프라-테스트-방법\" style=\"position:relative;\"><a href=\"#%ED%81%B4%EB%9D%BC%EC%9A%B0%EB%93%9C-%EC%9D%B8%ED%94%84%EB%9D%BC-%ED%85%8C%EC%8A%A4%ED%8A%B8-%EB%B0%A9%EB%B2%95\" aria-label=\"클라우드 인프라 테스트 방법 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>클라우드 인프라 테스트 방법</h2>\n<p>AWS는 기본적으로 클라우드 환경이다.\n따라서 과금문제로 인해 실제로 추가, 변경한 오퍼레이터가 잘 동작하는지 매번 확인해보기가 힘들다.\nAirflow에서는 AWS 서비스를 Mocking 하기 위해 <a href=\"https://github.com/spulec/moto\">moto</a> 라는 라이브러를 활용해서 테스트를 작성한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token decorator annotation punctuation\">@mock_s3</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">test_my_model_save</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token comment\"># Create Bucket so that test can run</span>\n    conn <span class=\"token operator\">=</span> boto3<span class=\"token punctuation\">.</span>resource<span class=\"token punctuation\">(</span><span class=\"token string\">'s3'</span><span class=\"token punctuation\">,</span> region_name<span class=\"token operator\">=</span><span class=\"token string\">'us-east-1'</span><span class=\"token punctuation\">)</span>\n    conn<span class=\"token punctuation\">.</span>create_bucket<span class=\"token punctuation\">(</span>Bucket<span class=\"token operator\">=</span><span class=\"token string\">'mybucket'</span><span class=\"token punctuation\">)</span>\n    model_instance <span class=\"token operator\">=</span> MyModel<span class=\"token punctuation\">(</span><span class=\"token string\">'steve'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'is awesome'</span><span class=\"token punctuation\">)</span>\n    model_instance<span class=\"token punctuation\">.</span>save<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    body <span class=\"token operator\">=</span> conn<span class=\"token punctuation\">.</span>Object<span class=\"token punctuation\">(</span><span class=\"token string\">'mybucket'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'steve'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token string\">'Body'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>decode<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">assert</span> body <span class=\"token operator\">==</span> <span class=\"token string\">'is awesome'</span></code></pre></div>\n<p>위와 같이 moto에서 미리 정의한 mock object를 decorator를 사용하여 쉽게 활용할 수 있다.\n하지만 AWS에서 공식으로 지원하는 라이브러리가 아니다보니 업데이트가 늦어지기도 한다.\n이런 이유로 인해 unittest의 mock으로 작성된 테스트 코드도 많이 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">TestEmrAddStepsOperator</span><span class=\"token punctuation\">(</span>unittest<span class=\"token punctuation\">.</span>TestCase<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token comment\"># When</span>\n    _config <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">{</span>\n        <span class=\"token string\">'Name'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'test_step'</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">'ActionOnFailure'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'CONTINUE'</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">'HadoopJarStep'</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token string\">'Jar'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'command-runner.jar'</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">'Args'</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n                <span class=\"token string\">'/usr/lib/spark/bin/run-example'</span>\n            <span class=\"token punctuation\">]</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span>\n\n    <span class=\"token keyword\">def</span> <span class=\"token function\">setUp</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        configuration<span class=\"token punctuation\">.</span>load_test_config<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n        <span class=\"token comment\"># Mock out the emr_client (moto has incorrect response)</span>\n        self<span class=\"token punctuation\">.</span>emr_client_mock <span class=\"token operator\">=</span> MagicMock<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        self<span class=\"token punctuation\">.</span>operator <span class=\"token operator\">=</span> EmrAddStepsOperator<span class=\"token punctuation\">(</span>\n            task_id<span class=\"token operator\">=</span><span class=\"token string\">'test_task'</span><span class=\"token punctuation\">,</span>\n            job_flow_id<span class=\"token operator\">=</span><span class=\"token string\">'j-8989898989'</span><span class=\"token punctuation\">,</span>\n            aws_conn_id<span class=\"token operator\">=</span><span class=\"token string\">'aws_default'</span><span class=\"token punctuation\">,</span>\n            steps<span class=\"token operator\">=</span>self<span class=\"token punctuation\">.</span>_config\n        <span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">def</span> <span class=\"token function\">test_init</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        self<span class=\"token punctuation\">.</span>assertEqual<span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>operator<span class=\"token punctuation\">.</span>aws_conn_id<span class=\"token punctuation\">,</span> <span class=\"token string\">'aws_default'</span><span class=\"token punctuation\">)</span>\n        self<span class=\"token punctuation\">.</span>assertEqual<span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>operator<span class=\"token punctuation\">.</span>emr_conn_id<span class=\"token punctuation\">,</span> <span class=\"token string\">'emr_default'</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">def</span> <span class=\"token function\">test_render_template</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        ti <span class=\"token operator\">=</span> TaskInstance<span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>operator<span class=\"token punctuation\">,</span> DEFAULT_DATE<span class=\"token punctuation\">)</span>\n        ti<span class=\"token punctuation\">.</span>render_templates<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n        expected_args <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">{</span>\n            <span class=\"token string\">'Name'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'test_step'</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">'ActionOnFailure'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'CONTINUE'</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">'HadoopJarStep'</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token string\">'Jar'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'command-runner.jar'</span><span class=\"token punctuation\">,</span>\n                <span class=\"token string\">'Args'</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n                    <span class=\"token string\">'/usr/lib/spark/bin/run-example'</span>\n                <span class=\"token punctuation\">]</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span>\n\n        self<span class=\"token punctuation\">.</span>assertListEqual<span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>operator<span class=\"token punctuation\">.</span>steps<span class=\"token punctuation\">,</span> expected_args<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">if</span> __name__ <span class=\"token operator\">==</span> <span class=\"token string\">'__main__'</span><span class=\"token punctuation\">:</span>\n    unittest<span class=\"token punctuation\">.</span>main<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>unittest로 작성된 테스트 케이스는 API로 주고 받는 json을 직접 정의해줘야 하는 번거로움이 있다.\n테스트 케이스를 작성하고 난 다음 바로 PR을 추가하는 것보다 로컬 CI를 미리 돌려보는게 좋다.</p>\n<p><img src=\"http://drive.google.com/uc?export=view&#x26;id=1MEOqsKocQTV8y5y_y2xrpIppkw2ndOvT\" alt=\"\"></p>\n<p>TravisCI는 오픈소스인 경우 무료로 사용할 수 있으며, yml 파일에 미리 정의되어 있으니 참고하면 된다. 로컬에서 CI가 통과되고 나면 PR을 추가해도 좋다.\n작업이 길어지면서 커밋이 여러 개로 늘어나는 경우, <strong>commit을 squash</strong> 해주는 것이 좋다.\n(나중에 문제가 생겼을 때 쉽게 rebase 하기 위함)</p>\n<br>\n<h2 id=\"잡다한-정리\" style=\"position:relative;\"><a href=\"#%EC%9E%A1%EB%8B%A4%ED%95%9C-%EC%A0%95%EB%A6%AC\" aria-label=\"잡다한 정리 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>잡다한 정리</h2>\n<ul>\n<li><a href=\"https://issues.apache.org/jira/browse/AIRFLOW-713\">[AIRFLOW-713] EmrCreateJobFlowOperator and EmrAddStepsOperator attributes are not jinjafied</a></li>\n<li><a href=\"https://issues.apache.org/jira/browse/AIRFLOW-950\">[AIRFLOW-950] Missing AWS integrations on documentation::integrations</a></li>\n<li><a href=\"https://issues.apache.org/jira/browse/AIRFLOW-1453\">[AIRFLOW-1453] Add 'steps' into template_fields in EmrAddSteps</a></li>\n<li><a href=\"https://issues.apache.org/jira/browse/AIRFLOW-1436\">[AIRFLOW-1436, AIRFLOW-1475] EmrJobFlowSensor consideres Cancelled step as Successful</a></li>\n</ul>\n<p>그 동안 5개 정도의 버그를 해결했고 수정했던 AWS EMR 관련 버그들은 1.9 - 10 버전에 모두 반영 되었다.\n이외에도 Airflow에는 여전히 자잘한 버그가 많이 남아있다.\n(Docker로 운영했을 때 로그가 이상하게 나타난다거나, SubDag Deadlock 문제 등)\n당시에 블로그를 열심히 했다면 운영 관련해서 글을 남겼을텐데 하는 아쉬움이 남아있다.</p>\n<p>어쨋든 Airflow를 적용하고 난 뒤, 편히 새벽에 잠들 수 있게 되었다.\n지금은 머신러닝 파이프라인 관련 도구가 많이 나왔지만, Airflow도 충분히 해당 영역을 커버할 수 있다.</p>\n<p>그리고 오픈소스에 대해 다시 한번 생각해보게 되었다.\n많은 사람들이 참여하는 오픈소스이다 보니 당연히 버그나 이슈가 생길 수 있고,\n문제가 생겼을 때 고쳐달라고 강요하거나 기다리는 것보다 스스로 수정해서 기여하는 것이 올바른 태도가 아닌가 싶다.</p>","excerpt":"Apache Airflow는 코드를 통해 워크플로우를 관리하고 모니터링 할 수 있도록 도와주는 플랫폼이다.\nAirflow 프로젝트에 대한 설명은 다른 글에서도 많이 다루기 때문에 생략하고\n이 글에서는 처음으로 아파치 프로젝트에 기여해본 경험을 정리해보려 한다. 기여하게 된 배경 당시에 관리하던 데이터 인프라에는 의존성이 얽혀있는 배치 작업이 상당히 많았다.\n여기에서 의존성이 얽혀있다는 말은 A 작업과 B 작업이 성공적으로 끝나고 난 뒤 C…"}}}},"pageContext":{"slug":"airflow-contrib","basePath":"","prev":{"slug":"container-patterns","publishDate":"2019-01-26"},"next":{"slug":"kafka-connect","publishDate":"2018-11-16"}}},"staticQueryHashes":["1946181227","2744905544","3732430097"]}