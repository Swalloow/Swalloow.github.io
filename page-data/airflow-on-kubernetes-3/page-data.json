{"componentChunkName":"component---src-templates-post-js","path":"/airflow-on-kubernetes-3/","result":{"data":{"contentfulPost":{"title":"Airflow on Kubernetes (3)","slug":"airflow-on-kubernetes-3","metaDescription":null,"publishDate":"February 05, 2021","publishDateISO":"2021-02-05","tags":[{"title":"DataEngineering","id":"25d7d0d6-3cf7-5e19-a5cb-9c3fa926046f","slug":"dataengineering"}],"heroImage":{"title":"cover-dataengineering","gatsbyImageData":{"images":{"sources":[{"srcSet":"https://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=400&h=267&q=50&fm=webp 400w,\nhttps://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=800&h=533&q=50&fm=webp 800w,\nhttps://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=1600&h=1067&q=50&fm=webp 1600w","sizes":"(min-width: 1600px) 1600px, 100vw","type":"image/webp"}],"fallback":{"src":"https://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=1600&h=1067&fl=progressive&q=50&fm=jpg","srcSet":"https://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=400&h=267&fl=progressive&q=50&fm=jpg 400w,\nhttps://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=800&h=533&fl=progressive&q=50&fm=jpg 800w,\nhttps://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=1600&h=1067&fl=progressive&q=50&fm=jpg 1600w","sizes":"(min-width: 1600px) 1600px, 100vw"}},"layout":"constrained","width":1800,"height":1200,"placeholder":{"fallback":"data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wAARCAANABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAIBAwb/xAAcEAACAgMBAQAAAAAAAAAAAAAAAQIREiFBMeH/xAAWAQEBAQAAAAAAAAAAAAAAAAABAgP/xAAUEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwDK1DF0vgjileglOuFeTk6fC2ZH6BKV7ugEP//Z"}},"ogimg":{"src":"https://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=1800&q=50"}},"body":{"childMarkdownRemark":{"timeToRead":2,"html":"<p>최근 Airflow에는 Kubernetes 지원을 위해 다양한 컴포넌트들이 추가되고 있습니다. 이러한 변화의 흐름에 따라 Airflow를 Kubernetes 위에 배포하고 운영하는 방법에 대해 글을 작성해보고자 합니다. 이 글은 시리즈로 연재됩니다.</p>\n<ul>\n<li><a href=\"https://swalloow.github.io/airflow-on-kubernetes-1\">Airflow on Kubernetes (1): CeleryExecutor</a></li>\n<li><a href=\"https://swalloow.github.io/airflow-on-kubernetes-2\">Airflow on Kubernetes (2): KubernetesExecutor</a></li>\n<li><a href=\"https://swalloow.github.io/airflow-on-kubernetes-3\">Airflow on Kubernetes (3): Airflow Logging, Monitoring</a></li>\n</ul>\n<br>\n<h2 id=\"airflow-logging\" style=\"position:relative;\"><a href=\"#airflow-logging\" aria-label=\"airflow logging permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Airflow Logging</h2>\n<p><span\n        class=\"gatsby-resp-image-wrapper\"\n        style=\"position: relative; display: block; ; max-width: 650px; margin-left: auto; margin-right: auto;\"\n      >\n        <span\n          class=\"gatsby-resp-image-background-image\"\n          style=\"padding-bottom: 58.93271461716937%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAYCAMAAAC/Wk/yAAACHFBMVEX////+/v7v8fzEzfTx8/z6+vr4+Pj5+fn6+vn6+fn39/f9/f2wvPEASeO2wfH///7///37+/z9/f77+/v8/Pza3/iPpOze4/ns7/vr7vv+/v/m6frw8vz+/v2jsu+cre/w8vr9/fz6+vv7/Pzk6PqbrO6mtfD3+Pv09v2isvCXqevj5u7r7e/p6+7q7O7o6+709feXqu6jsuvo6u7r7O73+Pn6+/v8/f33+P3m6e/r7e7b3+6ruO3Aye3o6u309fbz9fvn6e/b4O7q4uH37u3s7u/t7u/Fze2fsPGeru3m6e7z9PWfr/H39/j09vbjxMPBZV2/eXTv4N/e4eqtuOXHzujf4uutuebGzef29/j+///an5y/AACfAADjxsXq7O/i5Obe4ODg4uPo6uzn6e3z9Pb6+/zk5eff4OHn6u3rzczLcGjGgHrw8fLy8/Tx8vPy8/X19vf9/v719vjo4N/06+rm5eXp6eno6Ofo6Ojl5eXv7+/09fX3+Pj//v75+frz9PT19vby8vP4+fnq7PG3wuy5w+zs7vL8/PvX3O2tuuzN0+z4+fjCyuyxvezh5e/c4PCaq+6Zq+7g4/L+/vu1wOyjs/Gks+zu8PWaq+2fsPDK0e7+/vzr7fGwvOmyvent7/LY3e2hsOfM0+u+x+qmtOjj5u/x8/Tl5ufk5ubt7/Dh4uPq7O329vfo6uvi4+Tv8PL29vb19fXm5uZzIwCVAAAB+klEQVQYGZXBzUsUcQDH4c93nJl9mdkd153DutAtTKJXxJROQREdis519yodOxUFgofoFHUMOggR9B9Ux4oOdQkLBINMQ3RxXWdWnV1/zW4q2ZLQ84h94p8MCEtqkXJkLDoE2uEPO44ibPJKJWAy2qIjLtKy2BMBRUXY5JRaA6dp6KpKC+wZiA1dgiNLVUmNuLIe1FSDo5JWgYDamhEGypsRgv6KUshYxtInGKxI2pSxDNkPwsA5vceG5Mu4EldSnUDA0jE13OK26pSadBUEfeAmP4br5UwmEzTaA3OeW5n12gN9nhM0mtVvmSvzV4czmeOzFpygtMSi7/sLeBsmir6fNWYx8IJlrGKi14nfgUVqa8QdKRQKo2ZoiNQZt6RSvv+0zs8Rx8wEQbCBRer6tl8sLvv+xcIrUv6F0cvr/fX4Unaejse53EtsUjOUx3RS0hQdD0mFK+zLio4xUmEYemWPLi8kIHsHvBAJyDtg89sKENF1V0ytuxMPvOykNB0DOSXY9HCk+5Lu6Y0v5SJSuQiLHv6u5jXf96fZZdOjIOnnoHRrfEKaZJdNj7z07N0T6fYpSciwJ7zJAXKcKnI9CDPyBJRD6IPsZ/eAxJZlOc+/rhVot/wm0MrG2FDjL7aJQB/VMi/ourEK4jDh07dA+1EE4lAOqeIq/+EXob2RwJWg0D8AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n        >\n          <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"airflow-log\"\n        title=\"\"\n        src=\"https://images.ctfassets.net/tushy4jlcik7/4XkuIbWLKoTk3S0k2k7vl5/41a71e9051c7fc2e6e0bffb9e9540dda/airflow-log.png\"\n        srcset=\"https://images.ctfassets.net/tushy4jlcik7/4XkuIbWLKoTk3S0k2k7vl5/41a71e9051c7fc2e6e0bffb9e9540dda/airflow-log.png?w=323 323w,\nhttps://images.ctfassets.net/tushy4jlcik7/4XkuIbWLKoTk3S0k2k7vl5/41a71e9051c7fc2e6e0bffb9e9540dda/airflow-log.png?w=647 647w,\nhttps://images.ctfassets.net/tushy4jlcik7/4XkuIbWLKoTk3S0k2k7vl5/41a71e9051c7fc2e6e0bffb9e9540dda/airflow-log.png?w=1293 1293w\"\n        sizes=\"(max-width: 650px) 100vw, 650px\"\n        loading=\"lazy\"\n      />\n        </span>\n      </span></p>\n<p>Airflow의 Task 로그는 PV를 통해 영구 볼륨에 저장하거나 <strong>Remote Logging</strong> 설정을 통해 외부 저장소로 수집할 수 있습니다. S3, ES, GCS 등 다양한 저장소를 지원합니다.\n예를 들어 S3로 설정하면 Task 로그의 수명주기를 S3 Lifecycle에 의해 관리할 수 있게 됩니다.\n참고로 2.0 버전부터 로그 관련 설정은 <code class=\"language-text\">core</code>에서 <code class=\"language-text\">logging</code> 섹션으로 이동했습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">logging:\n  remote_logging: \"True\"\n  remote_base_log_folder: \"s3://mybucketname/airflow\"\n  remote_log_conn_id: \"aws_default\"\n  logging_level: INFO</code></pre></div>\n<br>\n<h2 id=\"airflow-metrics\" style=\"position:relative;\"><a href=\"#airflow-metrics\" aria-label=\"airflow metrics permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Airflow Metrics</h2>\n<p>Airflow는 <a href=\"https://airflow.apache.org/docs/apache-airflow/stable/logging-monitoring/metrics.html\">StatsD를 통한 메트릭 전송 방법</a>을 공식 지원합니다.\nK8S 환경에서 많이 사용하는 Prometheus을 통해 메트릭을 수집하는 방법은 아래와 같이 2가지가 있습니다.\nOfficial Helm Chart의 경우 statsd-export를 통해 전송하는 방법을 지원하고 있습니다.\n<code class=\"language-text\">Values.statsd.enabled</code> 옵션을 통해 쉽게 설정하실 수 있습니다.</p>\n<br>\n<p><strong>1. airflow-prometheus-exporter</strong>:\nairflow model 객체를 활용하여 prometheus metrics collector를 구현한 모듈입니다.\nstable/airflow chart에서 옵션을 통해 설정할 수 있으며 airflow plugin 형태로 구현되어 있어 UI의 /metrics 경로에서 로그를 확인할 수 있습니다.</p>\n<p><strong>2. airflow-statsd-exporter</strong>:\nstatsd는 UDP, TCP를 통해 메트릭을 수집에서 전송하는 프록시입니다.\nairflow에서는 공식적으로 statsd를 통해 메트릭을 지원하고 있습니다.\nofficial helm chart에서는 statsd를 통해 메트릭을 수집하고 exporter를 통해 prometheus에 저장할 수 있습니다.</p>\n<br>\n<p><span\n        class=\"gatsby-resp-image-wrapper\"\n        style=\"position: relative; display: block; ; max-width: 650px; margin-left: auto; margin-right: auto;\"\n      >\n        <span\n          class=\"gatsby-resp-image-background-image\"\n          style=\"padding-bottom: 56.55172413793104%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAXCAMAAABODP0nAAACnVBMVEX////N1Papt/D3+P2brO5Edebo6/r+/v7///79/f79/f37/P38/P3v8vzi5vjh5fm5xPPq7fvv8fzd4fnM0/aAmOvK0e/y8/Pw8fLw8vLv8PLu8PLx8vT+///g5PmEnOy0wO3v8fLv8PP8/f35+v/b4PPl6O3r7e7h5O28xu3T2O3q7O7o6u3s7fD+/v/g5Pbh5e7o6+7Hz+3EzO3n6e7p6+77/Pz19vbs7u7L0u2arPCvu+3r7O/8/Pz6+vr4+Pj9/fz09fTr7O7i5u+gsO+dru/f4+7q7O/5+v7O1fbZ3/jz9Pbf4uuzveTP1efs7vD19fX39/jj5ejAyOW9xeXj5enu8PyuvPG0wPDt7/Px8vPw8fPv8fPn6evi5OXk5ufs7vH4+Pnk5ejj5OXk5ujg5fba3u3j5u7L0u7Y3e7q6+7u7/L///35+fr5+vr6+vv6+/v6+/z29vf3+Pj09PTs7e7R1+6ywPS6xPDy9Pzj5/n5+fn19ve4wujO0+mdre5Fdefq7fr9/v74+frl5+nh4+Xi5Obo6+3J0fWltO/s7/vm6fr7+/78/P67xvKxvvH4+f39/v37+/vs7Ozu7u7s7O3v8PH7+/z5+vuQpO3T2vX8/Pv6+/r6+/6puPCIn+vj5vHt7/Hw8PDx8fHi5vqmte7W2+3d4e3m6O7o6u7q7fjZ3u2/yO3Gzu309fa7xe34+fnc4O6bre+jsu7l6O7U2u2Yquzr7e/z8/P29/jByOTJz+Xr7O3y9PXn6u3m6OrR1N7e4eXr7fDQ1erR1eXV2ebQ1uv3+Pny8/Ty8/Lv8fqisu+mtfCIn+xsi+nr7vn+/v39/v/g5fn19/78/P+/yfTI0PXFzvWwvfH6+v/h5fjEzfTz9f2+yPPh5vkx7aYEAAACBklEQVQYGa3BPUiUcQDH8e/vuefu/7+n614sdIkIF2lQiigbCmt1EIMWwaUlSBrEslApybo4qAZLMEiXhgZpcKlcWhovhF6huwJ7sUIhHKzLx5d7euTSc2zo8+HfyYnwD4SrUOCwTrDmruIACuSs+GxyiSu0wIaasv1BhWELgU1oXeBI+sJuyQ+EXTZanvfZ5AJpbShCWlqJKYTyhiqB8ZvLEYX8pbRC83UKrUYX8vaY9JgKFyLs/FTrSYVk/Uw6M3ni51yDpI81sJSUOgTSwiMHAohGM5mMS4Znk6QhnU6lCNmJZHJuezKVerEHwdmRQ82SggDdBaKnFJHWyowBXU9aJT3l21eXPpl8noqmAr5/B1qOZIGmgm+9aW+/Sh44xGL9WBMaMubkADaRsObgWxMqgGHxsLWdv9sROYXOs+GWpO7hC7Xz+LcVKtJQLO8Nzgjs8XbpddP9fYEzDOOS+i6Rvd5vZ++hd1kqBHZMupLs0dXLD6Z8mNDoaVc5UN4rscmBoDOebfv12dTdxAFiowfisdhgqcYezVHlQIRxjxuN9IIGprz44vRDay2zHfleqlwI6NHFVm3r0rmZrFfKl4YSknZ1D/qGKheEN/I9rrZoy8orSlyL7FAop7xhC4FXAl5Kjfz1RusaMPhslfA8zxafvzdDXoUZttZYz0sYqkTFB6me/+IPG1GRLJiaR00AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n        >\n          <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"airflow-mon\"\n        title=\"\"\n        src=\"https://images.ctfassets.net/tushy4jlcik7/1zXAgK4SzbiJPqbJkfKlaS/53bd066e8011479c197296bc0cefa14e/airflow-mon.png\"\n        srcset=\"https://images.ctfassets.net/tushy4jlcik7/1zXAgK4SzbiJPqbJkfKlaS/53bd066e8011479c197296bc0cefa14e/airflow-mon.png?w=363 363w,\nhttps://images.ctfassets.net/tushy4jlcik7/1zXAgK4SzbiJPqbJkfKlaS/53bd066e8011479c197296bc0cefa14e/airflow-mon.png?w=725 725w,\nhttps://images.ctfassets.net/tushy4jlcik7/1zXAgK4SzbiJPqbJkfKlaS/53bd066e8011479c197296bc0cefa14e/airflow-mon.png?w=1450 1450w\"\n        sizes=\"(max-width: 650px) 100vw, 650px\"\n        loading=\"lazy\"\n      />\n        </span>\n      </span></p>\n<p>수집하는 과정은 위의 그림과 같습니다. statsd-exporter는 Deployment 형태로 배포되며 수집 어노테이션이 정의되어 있습니다.</p>\n<br>\n<h2 id=\"monitoring\" style=\"position:relative;\"><a href=\"#monitoring\" aria-label=\"monitoring permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Monitoring</h2>\n<p><span\n        class=\"gatsby-resp-image-wrapper\"\n        style=\"position: relative; display: block; ; max-width: 650px; margin-left: auto; margin-right: auto;\"\n      >\n        <span\n          class=\"gatsby-resp-image-background-image\"\n          style=\"padding-bottom: 47.854588796185936%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,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'); background-size: cover; display: block;\"\n        >\n          <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"airflow-grafana\"\n        title=\"\"\n        src=\"https://images.ctfassets.net/tushy4jlcik7/jcdEsS57RUBfhTQyNx67X/fd363a47e8bedf709df7f117b3f74b4a/airflow-grafana.png\"\n        srcset=\"https://images.ctfassets.net/tushy4jlcik7/jcdEsS57RUBfhTQyNx67X/fd363a47e8bedf709df7f117b3f74b4a/airflow-grafana.png?w=839 839w,\nhttps://images.ctfassets.net/tushy4jlcik7/jcdEsS57RUBfhTQyNx67X/fd363a47e8bedf709df7f117b3f74b4a/airflow-grafana.png?w=1678 1678w,\nhttps://images.ctfassets.net/tushy4jlcik7/jcdEsS57RUBfhTQyNx67X/fd363a47e8bedf709df7f117b3f74b4a/airflow-grafana.png?w=3356 3356w\"\n        sizes=\"(max-width: 650px) 100vw, 650px\"\n        loading=\"lazy\"\n      />\n        </span>\n      </span></p>\n<p>Prometheus에 저장된 메트릭은 Grafana를 통해 데이터 소스로 지정하고 원하는 지표를 시각화할 수 있습니다. 위의 대시보드에 활용한 지표는 다음과 같습니다.</p>\n<ul>\n<li>Airflow Scheduler Health</li>\n<li>Number of Queued Tasks</li>\n<li>Number of Running Tasks</li>\n<li>Scheduling Delay by DAG</li>\n<li>DAG Import Time</li>\n<li>DAG Running Duration</li>\n</ul>\n<br>\n<p>사용자가 작성한 DAG은 Parser를 통해 객체로 변환되고 메타데이터 DB에 저장되는데 <code class=\"language-text\">DAG Import Time</code>은 이 과정을 수행하는데 있어 걸리는 시간을 의미합니다. 위에 언급된 지표 외에도 다양한 지표를 지원합니다. 자세한 리스트는 <a href=\"https://airflow.apache.org/docs/apache-airflow/stable/logging-monitoring/metrics.html#counters\">Airflow Metrics 공식 문서</a>를 통해 확인하실 수 있습니다.</p>\n<br>","excerpt":"최근 Airflow에는 Kubernetes 지원을 위해 다양한 컴포넌트들이 추가되고 있습니다. 이러한 변화의 흐름에 따라 Airflow를 Kubernetes 위에 배포하고 운영하는 방법에 대해 글을 작성해보고자 합니다. 이 글은 시리즈로 연재됩니다. Airflow on Kubernetes (1): CeleryExecutor Airflow on Kubernetes (2): KubernetesExecutor Airflow on Kubernetes (3): Airflow Logging, Monitoring Airflow Logging  Airflow의 Task 로그는 PV…"}}}},"pageContext":{"slug":"airflow-on-kubernetes-3","basePath":"","prev":{"slug":"airflow-sidecar","publishDate":"2021-08-01"},"next":{"slug":"airflow-on-kubernetes-2","publishDate":"2020-07-12"}}},"staticQueryHashes":["1946181227","2744905544","3732430097"]}