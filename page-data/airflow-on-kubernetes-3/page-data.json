{"componentChunkName":"component---src-templates-post-js","path":"/airflow-on-kubernetes-3/","result":{"data":{"contentfulPost":{"title":"Airflow on Kubernetes (3)","slug":"airflow-on-kubernetes-3","metaDescription":null,"publishDate":"February 05, 2021","publishDateISO":"2021-02-05","tags":[{"title":"DataEngineering","id":"25d7d0d6-3cf7-5e19-a5cb-9c3fa926046f","slug":"dataengineering"}],"heroImage":{"title":"cover-dataengineering","gatsbyImageData":{"images":{"sources":[{"srcSet":"https://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=400&h=267&q=50&fm=webp 400w,\nhttps://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=800&h=533&q=50&fm=webp 800w,\nhttps://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=1600&h=1067&q=50&fm=webp 1600w","sizes":"(min-width: 1600px) 1600px, 100vw","type":"image/webp"}],"fallback":{"src":"https://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=1600&h=1067&fl=progressive&q=50&fm=jpg","srcSet":"https://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=400&h=267&fl=progressive&q=50&fm=jpg 400w,\nhttps://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=800&h=533&fl=progressive&q=50&fm=jpg 800w,\nhttps://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=1600&h=1067&fl=progressive&q=50&fm=jpg 1600w","sizes":"(min-width: 1600px) 1600px, 100vw"}},"layout":"constrained","width":1800,"height":1200,"placeholder":{"fallback":"data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEAlgCWAAD/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wAARCAANABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAMBAgb/xAAcEAACAgMBAQAAAAAAAAAAAAAAAQIREiExYeH/xAAWAQEBAQAAAAAAAAAAAAAAAAABAgP/xAAUEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwDK1DF0vgtxW9EylQu8nTotmo+gHfAEP//Z"}},"ogimg":{"src":"https://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=1800&q=50"}},"body":{"childMarkdownRemark":{"timeToRead":2,"html":"<p>최근 Airflow에는 Kubernetes 지원을 위해 다양한 컴포넌트들이 추가되고 있습니다. 이러한 변화의 흐름에 따라 Airflow를 Kubernetes 위에 배포하고 운영하는 방법에 대해 글을 작성해보고자 합니다. 이 글은 시리즈로 연재됩니다.</p>\n<ul>\n<li><a href=\"https://swalloow.github.io/airflow-on-kubernetes-1\">Airflow on Kubernetes (1): CeleryExecutor</a></li>\n<li><a href=\"https://swalloow.github.io/airflow-on-kubernetes-2\">Airflow on Kubernetes (2): KubernetesExecutor</a></li>\n<li><a href=\"https://swalloow.github.io/airflow-on-kubernetes-3\">Airflow on Kubernetes (3): Airflow Logging, Monitoring</a></li>\n</ul>\n<br>\n<h2 id=\"airflow-logging\" style=\"position:relative;\"><a href=\"#airflow-logging\" aria-label=\"airflow logging permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Airflow Logging</h2>\n<p><span\n        class=\"gatsby-resp-image-wrapper\"\n        style=\"position: relative; display: block; ; max-width: 650px; margin-left: auto; margin-right: auto;\"\n      >\n        <span\n          class=\"gatsby-resp-image-background-image\"\n          style=\"padding-bottom: 58.93271461716937%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAYCAMAAAC/Wk/yAAAB1FBMVEX////n7vyeuvPr8fzv7+/l5eWLrPA9dOaPr/D5+vv6+vv6+/vr6+z5+vrG1vhtl+3O3Pnc5vrj6/vR3vnt8v1zm+12ne73+fz7+/zu7u/9/f3P3fmApO+Cpe/9/v7y9v10nO1jj+nl6O7p6+7z9Pbh6vtplOx3ner29/jp6+/W3u6Ao+yju+z6+/zX3+7UwsD67Or+/v6sweyPr/FvmOvx8vT8/Pz7+/v3+PitweyOrvHt7e/q6+zi4uLYo5y3WEy7ZVrryMTj5uyatOnAz+2ctuu+zezWiH+1QTOtPjDjr6nW2NvMzdDNz9Lm5+rc3uHOz9LMztHkrqjGZlrBa2D+///09ff09fby8/Xax8Xv4eD29vbBwcHPz8/IyMjOzs7Gxsba2tr5+fno6Oj4+Pj6+vrv8PLx8vP39/j8/f319vfr7O34+frr7O7s7vCRr+uUsezt7vHP2u2BpOu+ze2pv+yHp+vf5O75+fra4fB4nu53ne7g5vGPreuxx/V4nepwmOyUs/G0x+yZtOyctuyGp+vC0O2uw+2Mq+vX2dvY2t3t7/Hq7O/Ky87m6Or29vjx8/Tf4eTQ0tTz8/Pu7+/29vfq6uvt7e3p6enKysrJycnLy8tHIUfMAAAACXBIWXMAABibAAAYmwFJdYOUAAAAB3RJTUUH6AEUCgUVyeVPTwAAAZBJREFUKM9jYCAaMDIxg2kW3IAVrICNnYOTi4uLm4cLAri5EICTixdsBlghH7+AoBCcBwLCIgj7uBAKGbhERMXEJSQkJYBACsiXlpGVgAI5VIXyCopKyhCgAuSrqqlDecoaqAoZ5DSVlbW0daAKGXSBDD0wF6pQ3wCq0BAoZmRsAiRNzczNzS2ADEsrENeaxYaFxdbO3sERpJAbrNDJ2QVmogSI6+oGNpEbyHf38PRCmOjt4+uHpNA/IBBudVBwiCNEYWhYWHgYGHOCBKSA7LAIECEBcWNkFDyoomNi4+ITEqGBJwUESSACGo7J0YgwZTAEIzAwMwOqSQEpTIVI2pohKUQAjbT0jMys7CzdnKzcLE6UcEQFefkFhZxFxSVZpqVl5RV4FFZWVddw1tbVZ5k2NDbhU5jX3FLIqdXalmXa3qGET2FhZ1c3V09vX/+EiZN68ClkmGwOk2RBSRQSXJzI6ZWba8pUIAVOx9O4kH2NAZKmA5N/MguMYGGZwUAIpM6cBYSzpQgqBEamGTgmSQAAAMpTo49TZjIAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n        >\n          <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"airflow-log\"\n        title=\"\"\n        src=\"https://images.ctfassets.net/tushy4jlcik7/4XkuIbWLKoTk3S0k2k7vl5/41a71e9051c7fc2e6e0bffb9e9540dda/airflow-log.png\"\n        srcset=\"https://images.ctfassets.net/tushy4jlcik7/4XkuIbWLKoTk3S0k2k7vl5/41a71e9051c7fc2e6e0bffb9e9540dda/airflow-log.png?w=323 323w,\nhttps://images.ctfassets.net/tushy4jlcik7/4XkuIbWLKoTk3S0k2k7vl5/41a71e9051c7fc2e6e0bffb9e9540dda/airflow-log.png?w=647 647w,\nhttps://images.ctfassets.net/tushy4jlcik7/4XkuIbWLKoTk3S0k2k7vl5/41a71e9051c7fc2e6e0bffb9e9540dda/airflow-log.png?w=1293 1293w\"\n        sizes=\"(max-width: 650px) 100vw, 650px\"\n        loading=\"lazy\"\n      />\n        </span>\n      </span></p>\n<p>Airflow의 Task 로그는 PV를 통해 영구 볼륨에 저장하거나 <strong>Remote Logging</strong> 설정을 통해 외부 저장소로 수집할 수 있습니다. S3, ES, GCS 등 다양한 저장소를 지원합니다.\n예를 들어 S3로 설정하면 Task 로그의 수명주기를 S3 Lifecycle에 의해 관리할 수 있게 됩니다.\n참고로 2.0 버전부터 로그 관련 설정은 <code class=\"language-text\">core</code>에서 <code class=\"language-text\">logging</code> 섹션으로 이동했습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">logging:\n  remote_logging: \"True\"\n  remote_base_log_folder: \"s3://mybucketname/airflow\"\n  remote_log_conn_id: \"aws_default\"\n  logging_level: INFO</code></pre></div>\n<br>\n<h2 id=\"airflow-metrics\" style=\"position:relative;\"><a href=\"#airflow-metrics\" aria-label=\"airflow metrics permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Airflow Metrics</h2>\n<p>Airflow는 <a href=\"https://airflow.apache.org/docs/apache-airflow/stable/logging-monitoring/metrics.html\">StatsD를 통한 메트릭 전송 방법</a>을 공식 지원합니다.\nK8S 환경에서 많이 사용하는 Prometheus을 통해 메트릭을 수집하는 방법은 아래와 같이 2가지가 있습니다.\nOfficial Helm Chart의 경우 statsd-export를 통해 전송하는 방법을 지원하고 있습니다.\n<code class=\"language-text\">Values.statsd.enabled</code> 옵션을 통해 쉽게 설정하실 수 있습니다.</p>\n<br>\n<p><strong>1. airflow-prometheus-exporter</strong>:\nairflow model 객체를 활용하여 prometheus metrics collector를 구현한 모듈입니다.\nstable/airflow chart에서 옵션을 통해 설정할 수 있으며 airflow plugin 형태로 구현되어 있어 UI의 /metrics 경로에서 로그를 확인할 수 있습니다.</p>\n<p><strong>2. airflow-statsd-exporter</strong>:\nstatsd는 UDP, TCP를 통해 메트릭을 수집에서 전송하는 프록시입니다.\nairflow에서는 공식적으로 statsd를 통해 메트릭을 지원하고 있습니다.\nofficial helm chart에서는 statsd를 통해 메트릭을 수집하고 exporter를 통해 prometheus에 저장할 수 있습니다.</p>\n<br>\n<p><span\n        class=\"gatsby-resp-image-wrapper\"\n        style=\"position: relative; display: block; ; max-width: 650px; margin-left: auto; margin-right: auto;\"\n      >\n        <span\n          class=\"gatsby-resp-image-background-image\"\n          style=\"padding-bottom: 56.55172413793104%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAXCAMAAABODP0nAAAB+FBMVEX///+1yvZ9ou/3+f5wme1Adufd5vn6+/v7+/z6+vv6+/z7/Pzo7vzO2/fS3/mVs/Lg6fucuPLE1PepwfRul+2uw+7u7/Lu8PLH1/h1nO2NrO33+v7J1/Po6+7p6+7i5u6VsevJ1e3q7O/P3Pbh5e6yxeykvOzy8/W4ye2YtfKCpOvq6+77+/v6+vr8/Pzu7/B5n+13ne7i5++uxfW90Pfj5uuXsebF0en09PTk5OT3+Pnj5eiwwuanvOfl5unx9f2HqfCKq+/v8fPx8vTh4+XV19rY2t3b3d/T1djR3fbQ2u7n6u6wxO3N2O3r7fD5+vv9/f3x8vP4+Pn+/v7t7u/F0u2mv/Sbtu/4+v7f5/j39/j5+vr39/nl6O2Ys+q6y+12ne4+dObi6fnj5OXk5OXd3+LV1tnS1NafuvNtluzw9P3b5fqivPOKq/D+/v/f4ODm5ubm5+j4+fqyx/WBpO+5zfR9ou5fjOrj6PHt7/Hj5OTz8/PE1fh3ne3L1u3g6PjM1+6lvOzP2e19oe6guezj5+/19fbI1e1vmO2Nq+vx8fH19vfl5+qnvOixw+fo6u3Cx9HY2t/T2ufJz9rO0tnP2On09ffs7vD3+Pp8oe51nOxNf+jm7PjZ4/j6+/79/v+ApO+GqfCatvJwmO309/75+fqkvvPr8fyE//4wAAAACXBIWXMAABibAAAYmwFJdYOUAAAAB3RJTUUH6AEUCgUVyeVPTwAAAatJREFUKM9jYCAaMDIxE6eQhZWNnYOdk4ODkx2IuTi4IEwQxY2ikIeXj18AiSsoBGdzohrJLiwiKgYG4kCehKQUhCPGzcCOqpBbWkZWTl5BUU5OCcRVVpGTU1WTk5NjZ0C1moGDQV1OTkNTS05OW0dXR08fqMbA0AikkIPB2ARJISdIoamZOchEC0sGKzk5axtbO5BCTnsHRycwcIab6OLqBrUaqNDdzcMNYqKnl5y3j6+cnB9EoZ4/BIB9GQBkBAYBiWAGdr0QObnQsHCIwohITkg4siPCMQoSjtEMMXJysXHxEIUJiUkYAZ6cAqZ0QQpT09IhCjMys7KRAyEnN49BB8zSyy8oKLQCgyIQn6u4pJQTDMABXFZeIVYJCfCqgoJq5Jipqa2Tk5OVg/q6vkFOrlEVHOBRWAK8qbkFETythgZAhUE6bVgUtnd0AmNGr8tSr1tOrqe3rx8SjiiAC6TQesJEhImTJk+ZClLIhZZ6GKZVVlZOB2IxSIDPqJ05a/YcUICjmwgCc+fBBeYvWLho8RK4DBwsBcUMr8MydowUzoElQyzPlWCgDgAAHxxav+/v5BcAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n        >\n          <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"airflow-mon\"\n        title=\"\"\n        src=\"https://images.ctfassets.net/tushy4jlcik7/1zXAgK4SzbiJPqbJkfKlaS/53bd066e8011479c197296bc0cefa14e/airflow-mon.png\"\n        srcset=\"https://images.ctfassets.net/tushy4jlcik7/1zXAgK4SzbiJPqbJkfKlaS/53bd066e8011479c197296bc0cefa14e/airflow-mon.png?w=363 363w,\nhttps://images.ctfassets.net/tushy4jlcik7/1zXAgK4SzbiJPqbJkfKlaS/53bd066e8011479c197296bc0cefa14e/airflow-mon.png?w=725 725w,\nhttps://images.ctfassets.net/tushy4jlcik7/1zXAgK4SzbiJPqbJkfKlaS/53bd066e8011479c197296bc0cefa14e/airflow-mon.png?w=1450 1450w\"\n        sizes=\"(max-width: 650px) 100vw, 650px\"\n        loading=\"lazy\"\n      />\n        </span>\n      </span></p>\n<p>수집하는 과정은 위의 그림과 같습니다. statsd-exporter는 Deployment 형태로 배포되며 수집 어노테이션이 정의되어 있습니다.</p>\n<br>\n<h2 id=\"monitoring\" style=\"position:relative;\"><a href=\"#monitoring\" aria-label=\"monitoring permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Monitoring</h2>\n<p><span\n        class=\"gatsby-resp-image-wrapper\"\n        style=\"position: relative; display: block; ; max-width: 650px; margin-left: auto; margin-right: auto;\"\n      >\n        <span\n          class=\"gatsby-resp-image-background-image\"\n          style=\"padding-bottom: 47.854588796185936%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,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'); background-size: cover; display: block;\"\n        >\n          <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"airflow-grafana\"\n        title=\"\"\n        src=\"https://images.ctfassets.net/tushy4jlcik7/jcdEsS57RUBfhTQyNx67X/fd363a47e8bedf709df7f117b3f74b4a/airflow-grafana.png\"\n        srcset=\"https://images.ctfassets.net/tushy4jlcik7/jcdEsS57RUBfhTQyNx67X/fd363a47e8bedf709df7f117b3f74b4a/airflow-grafana.png?w=839 839w,\nhttps://images.ctfassets.net/tushy4jlcik7/jcdEsS57RUBfhTQyNx67X/fd363a47e8bedf709df7f117b3f74b4a/airflow-grafana.png?w=1678 1678w,\nhttps://images.ctfassets.net/tushy4jlcik7/jcdEsS57RUBfhTQyNx67X/fd363a47e8bedf709df7f117b3f74b4a/airflow-grafana.png?w=3356 3356w\"\n        sizes=\"(max-width: 650px) 100vw, 650px\"\n        loading=\"lazy\"\n      />\n        </span>\n      </span></p>\n<p>Prometheus에 저장된 메트릭은 Grafana를 통해 데이터 소스로 지정하고 원하는 지표를 시각화할 수 있습니다. 위의 대시보드에 활용한 지표는 다음과 같습니다.</p>\n<ul>\n<li>Airflow Scheduler Health</li>\n<li>Number of Queued Tasks</li>\n<li>Number of Running Tasks</li>\n<li>Scheduling Delay by DAG</li>\n<li>DAG Import Time</li>\n<li>DAG Running Duration</li>\n</ul>\n<br>\n<p>사용자가 작성한 DAG은 Parser를 통해 객체로 변환되고 메타데이터 DB에 저장되는데 <code class=\"language-text\">DAG Import Time</code>은 이 과정을 수행하는데 있어 걸리는 시간을 의미합니다. 위에 언급된 지표 외에도 다양한 지표를 지원합니다. 자세한 리스트는 <a href=\"https://airflow.apache.org/docs/apache-airflow/stable/logging-monitoring/metrics.html#counters\">Airflow Metrics 공식 문서</a>를 통해 확인하실 수 있습니다.</p>\n<br>","excerpt":"최근 Airflow에는 Kubernetes 지원을 위해 다양한 컴포넌트들이 추가되고 있습니다. 이러한 변화의 흐름에 따라 Airflow를 Kubernetes 위에 배포하고 운영하는 방법에 대해 글을 작성해보고자 합니다. 이 글은 시리즈로 연재됩니다. Airflow on Kubernetes (1): CeleryExecutor Airflow on Kubernetes (2): KubernetesExecutor Airflow on Kubernetes (3): Airflow Logging, Monitoring Airflow Logging  Airflow의 Task 로그는 PV…"}}}},"pageContext":{"slug":"airflow-on-kubernetes-3","basePath":"","prev":{"slug":"airflow-sidecar","publishDate":"2021-08-01"},"next":{"slug":"airflow-on-kubernetes-2","publishDate":"2020-07-12"}}},"staticQueryHashes":["1946181227","2744905544","3732430097"]}