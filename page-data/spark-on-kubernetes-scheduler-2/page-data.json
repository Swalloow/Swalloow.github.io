{"componentChunkName":"component---src-templates-post-js","path":"/spark-on-kubernetes-scheduler-2/","result":{"data":{"contentfulPost":{"title":"Spark on Kubernetes: ì»¤ìŠ¤í…€ ìŠ¤ì¼€ì¤„ëŸ¬ (2)","slug":"spark-on-kubernetes-scheduler-2","metaDescription":null,"publishDate":"December 10, 2023","publishDateISO":"2023-12-10","tags":[{"title":"DataEngineering","id":"25d7d0d6-3cf7-5e19-a5cb-9c3fa926046f","slug":"dataengineering"}],"heroImage":{"title":"cover-dataengineering","gatsbyImageData":{"images":{"sources":[{"srcSet":"https://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=400&h=267&q=50&fm=webp 400w,\nhttps://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=800&h=533&q=50&fm=webp 800w,\nhttps://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=1600&h=1067&q=50&fm=webp 1600w","sizes":"(min-width: 1600px) 1600px, 100vw","type":"image/webp"}],"fallback":{"src":"https://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=1600&h=1067&fl=progressive&q=50&fm=jpg","srcSet":"https://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=400&h=267&fl=progressive&q=50&fm=jpg 400w,\nhttps://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=800&h=533&fl=progressive&q=50&fm=jpg 800w,\nhttps://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=1600&h=1067&fl=progressive&q=50&fm=jpg 1600w","sizes":"(min-width: 1600px) 1600px, 100vw"}},"layout":"constrained","width":1800,"height":1200,"placeholder":{"fallback":"data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEAlgCWAAD/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wAARCAANABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAMBAgb/xAAcEAACAgMBAQAAAAAAAAAAAAAAAQIREiExYeH/xAAWAQEBAQAAAAAAAAAAAAAAAAABAgP/xAAUEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwDK1DF0vgtxW9EylQu8nTotmo+gHfAEP//Z"}},"ogimg":{"src":"https://images.ctfassets.net/tushy4jlcik7/7uo9TsqFN9EBsDBqDJ5vXl/4c58a9f94babb15d8fd996c247737656/cover_dataengineering.jpg?w=1800&q=50"}},"body":{"childMarkdownRemark":{"timeToRead":5,"html":"<p>Spark 3.4 ë²„ì „ë¶€í„° Customized K8S Scheduler ê¸°ëŠ¥ì´ GA ë˜ì—ˆìŠµë‹ˆë‹¤ ğŸ‘ğŸ»<br>\nì˜¤ëŠ˜ì€ <a href=\"https://swalloow.github.io/spark-on-kubernetes-scheduler/\">ì§€ë‚œ ê¸€</a>ì— ì´ì–´ ê°€ì¥ ë§ì´ ì‚¬ìš©í•˜ëŠ” Volcano, Yunikorn ìŠ¤ì¼€ì¤„ëŸ¬ì— ëŒ€í•´ ì•Œì•„ë³´ê² ìŠµë‹ˆë‹¤.</p>\n<br>\n<p>3.4 ë²„ì „ ê¸°ì¤€ìœ¼ë¡œ Sparkì—ì„œëŠ” Volcano, Yunikorn ë‘ ê°€ì§€ ì»¤ìŠ¤í…€ ìŠ¤ì¼€ì¤„ëŸ¬ë¥¼ ê³µì‹ì ìœ¼ë¡œ ì§€ì›í•©ë‹ˆë‹¤. ë‘ ê°€ì§€ ì˜¤í”ˆì†ŒìŠ¤ ëª¨ë‘ ë„¤ì´í‹°ë¸Œ í™˜ê²½ì—ì„œ ë°°ì¹˜ ì²˜ë¦¬ë¥¼ ì§€ì›í•˜ê¸° ìœ„í•œ í”„ë¡œì íŠ¸ì´ë©° ìµœì‹  ë²„ì „ ê¸°ì¤€ìœ¼ë¡œ ëª¨ë‘ ìœ ì‚¬í•œ ê¸°ëŠ¥ì„ ì§€ì›í•˜ê³  ìˆìŠµë‹ˆë‹¤. ë¨¼ì € Volcano ë¶€í„° ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.</p>\n<br>\n<h2 id=\"volcano\" style=\"position:relative;\"><a href=\"#volcano\" aria-label=\"volcano permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Volcano</h2>\n<p>ì´ˆê¸°ì˜ VolcanoëŠ” <a href=\"https://github.com/kubernetes-retired/kube-batch\">kube-batch</a> í”„ë¡œì íŠ¸ ê¸°ë°˜ìœ¼ë¡œ êµ¬ì„±ë˜ì—ˆìœ¼ë‚˜ <strong>1.8 ë²„ì „ë¶€í„° ì¿ ë²„ë„¤í‹°ìŠ¤ ìŠ¤ì¼€ì¤„ëŸ¬ í”ŒëŸ¬ê·¸ì¸ ë°©ì‹ì„ ì§€ì›</strong>í•˜ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤. ìŠ¤ì¼€ì¤„ëŸ¬ í”ŒëŸ¬ê·¸ì¸ ê¸°ë°˜ìœ¼ë¡œ êµ¬ì„±í•œ ì»¤ìŠ¤í…€ ìŠ¤ì¼€ì¤„ëŸ¬ëŠ” ê¸°ë³¸ ìŠ¤ì¼€ì¤„ëŸ¬ì™€ í˜¸í™˜ ê°€ëŠ¥í•˜ë©° ë²„ì „ ì—…ë°ì´íŠ¸ ì˜í–¥ë„ ì ê²Œ ë°›ëŠ” ì¥ì ì´ ìˆìŠµë‹ˆë‹¤.</p>\n<p><img src=\"https://drive.google.com/uc?export=view&#x26;id=1ok4Vrmy6CJ3pML9-Bw1qIytZ9gFGJtu-\" alt=\"volcano\"></p>\n<p>Volcanoì˜ ì£¼ìš” ì»´í¬ë„ŒíŠ¸ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.</p>\n<ul>\n<li><strong>Scheduler</strong>: ì—¬ëŸ¬ ìŠ¤ì¼€ì¤„ë§ ì•Œê³ ë¦¬ì¦˜ì„ ê±°ì³ ê°€ì¥ ì í•©í•œ ë…¸ë“œì— ì‘ì—…ì„ í• ë‹¹í•©ë‹ˆë‹¤.</li>\n<li><strong>ControllerManager</strong>: CRD (Queue, PodGroup, VCJob)ì˜ lifecycleì„ ê´€ë¦¬í•©ë‹ˆë‹¤.</li>\n<li><strong>Admission</strong>: CRD APIì— ëŒ€í•œ ìœ íš¨ì„± ê²€ì‚¬ë¥¼ ë‹´ë‹¹í•©ë‹ˆë‹¤.</li>\n</ul>\n<p>PodGroupì„ í†µí•´ ê·¸ë£¹ ë‹¨ìœ„ì˜ ìŠ¤ì¼€ì¤„ë§ì´ ê°€ëŠ¥í•˜ë©°, í•˜ë‚˜ì˜ Queueì—ëŠ” ì—¬ëŸ¬ ê°œì˜ PodGroupì´ í• ë‹¹ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê° PodGroupì€ statusë¥¼ ê°€ì§€ê³  ìˆì–´ Pending, Running ë“±ì˜ ìƒíƒœê°€ ê´€ë¦¬ë©ë‹ˆë‹¤.</p>\n<br>\n<p>ìŠ¤ì¼€ì¤„ë§ì´ ì‹¤í–‰ë˜ëŠ” ì›Œí¬í”Œë¡œìš°ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.</p>\n<p><img src=\"https://drive.google.com/uc?export=view&#x26;id=1yLnnef5C-NesyyK66pOxf_c8AItA4k2J\" alt=\"volscheduler\"></p>\n<ul>\n<li>clientê°€ ì œì¶œí•œ ì‘ì—…ì„ watchí•˜ê³  ìºì‹±í•©ë‹ˆë‹¤.</li>\n<li>sessionì„ ìƒˆë¡œ ìƒì„±í•˜ê³  ìŠ¤ì¼€ì¤„ë§ ì‚¬ì´í´ì„ ì‹œì‘í•©ë‹ˆë‹¤.</li>\n<li>ìºì‹œì— ì˜ˆì•½ë˜ì§€ ì•Šì€ ì‘ì—…ì€ sessionì˜ ëŒ€ê¸°ì—´ë¡œ ë³´ëƒ…ë‹ˆë‹¤.</li>\n<li>í•„ìš”í•œ ì‘ì—…ì„ ìˆœíšŒí•˜ë©´ì„œ ìˆœì„œëŒ€ë¡œ ìŠ¤ì¼€ì¤„ë§ ë‹¨ê³„ë¥¼ ì‹¤í–‰í•˜ê³  ì í•©í•œ ë…¸ë“œë¥¼ ì°¾ìŠµë‹ˆë‹¤.</li>\n<li>ì‘ì—…ì„ ë…¸ë“œì— ë°”ì¸ë”©í•©ë‹ˆë‹¤.</li>\n<li>ì„¸ì…˜ì„ ì¢…ë£Œí•©ë‹ˆë‹¤.</li>\n</ul>\n<br>\n<p><strong>Volcano ì ìš© ê³¼ì •</strong><br>\nVolcano ì ìš©ì„ ìœ„í•´ í•„ìš”í•œ ë‹¨ê³„ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.</p>\n<ol>\n<li>Volcano í™˜ê²½ ë° ë¦¬ì†ŒìŠ¤ ë°°í¬</li>\n<li>Spark Volcano ì´ë¯¸ì§€ ë¹Œë“œ ë° ë°°í¬</li>\n<li>Spark configuration ì „ë‹¬</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\"># Specify volcano scheduler and PodGroup template\n--conf spark.kubernetes.scheduler.name=volcano\n--conf spark.kubernetes.scheduler.volcano.podGroupTemplateFile=/path/to/podgroup-template.yaml\n# Specify driver/executor VolcanoFeatureStep\n--conf spark.kubernetes.driver.pod.featureSteps=org.apache.spark.deploy.k8s.features.VolcanoFeatureStep\n--conf spark.kubernetes.executor.pod.featureSteps=org.apache.spark.deploy.k8s.features.VolcanoFeatureStep</code></pre></div>\n<p><br><br></p>\n<h2 id=\"apache-yunikorn\" style=\"position:relative;\"><a href=\"#apache-yunikorn\" aria-label=\"apache yunikorn permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Apache Yunikorn</h2>\n<p>Yunikornì€ Volcanoë³´ë‹¤ ë’¤ëŠ¦ê²Œ ì‹œì‘ëœ Apache í”„ë¡œì íŠ¸ì…ë‹ˆë‹¤.\nì»¨í…Œì´ë„ˆ ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜ì„ ìœ„í•œ ê²½ëŸ‰ì˜ ë²”ìš© ìŠ¤ì¼€ì¤„ëŸ¬ë¥¼ ì§€í–¥í•˜ê³  ìˆìœ¼ë©° ëŒ€ë¶€ë¶„ì˜ ìŠ¤ì¼€ì¤„ë§ ì•Œê³ ë¦¬ì¦˜ë„ ì§€ì›í•˜ê³  ìˆìŠµë‹ˆë‹¤.\në˜í•œ Volcanoì™€ ë™ì¼í•˜ê²Œ ìŠ¤ì¼€ì¤„ëŸ¬ í”ŒëŸ¬ê·¸ì¸ ë°©ì‹ì„ ì§€ì›í•©ë‹ˆë‹¤. ì¶”ê°€ë¡œ Yunikornì€ ì¡°ì§ ë‹¨ìœ„ë¡œ ë¦¬ì†ŒìŠ¤ ê´€ë¦¬ê°€ ê°€ëŠ¥í•˜ë„ë¡ <strong>ê³„ì¸µ êµ¬ì¡°ì˜ íë¥¼ ì§€ì›</strong>í•©ë‹ˆë‹¤.</p>\n<p><img src=\"https://drive.google.com/uc?export=view&#x26;id=1ksyjijuS-rcasePNp0pqHwR8XTuF8v0F\" alt=\"yunikorn\"></p>\n<p>Yunikornì˜ ì£¼ìš” ì»´í¬ë„ŒíŠ¸ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.</p>\n<ul>\n<li><strong>Scheduler Interface</strong>: ë‹¤ë¥¸ ë¦¬ì†ŒìŠ¤ í”Œë«í¼(K8S, YARN)ê³¼ í†µì‹ ì„ ìœ„í•œ ì¸í„°í˜ì´ìŠ¤</li>\n<li><strong>Scheduler Core</strong>: ìŠ¤ì¼€ì¤„ë§ ì•Œê³ ë¦¬ì¦˜ êµ¬í˜„, ë©”íŠ¸ë¦­ ìˆ˜ì§‘, ì»¨í…Œì´ë„ˆ í• ë‹¹ ìš”ì²­</li>\n<li><strong>Kubernetes Shim</strong>: ì¿ ë²„ë„¤í‹°ìŠ¤ì™€ í†µì‹ ì„ ë‹´ë‹¹, Podë¥¼ íŠ¹ì • ë…¸ë“œì— ë°”ì¸ë”©í•˜ëŠ” ì—­í• </li>\n<li><strong>Admission Controller</strong>: mutation, validation hookì„ ë‹´ë‹¹</li>\n</ul>\n<p>Yunikornì€ Volcanoì™€ ë‹¬ë¦¬ ì¶”ê°€ë¡œ ë°°í¬ë˜ëŠ” CRDê°€ ì—†ìŠµë‹ˆë‹¤.<br>\níì™€ ì•Œê³ ë¦¬ì¦˜ ë“± ê´€ë ¨ ì„¤ì •ì€ ëª¨ë‘ Yunikorn ë°°í¬ì— í¬í•¨ë©ë‹ˆë‹¤.<br>\nê°„ë‹¨í•œ Yunikorn ì„¤ì • íŒŒì¼ ì˜ˆì‹œëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">partitions</span><span class=\"token punctuation\">:</span>\n<span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> default\n  <span class=\"token key atrule\">nodesortpolicy</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">type</span><span class=\"token punctuation\">:</span> binpacking\n  <span class=\"token key atrule\">queues</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> root\n      <span class=\"token key atrule\">submitacl</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'*'</span>\n      <span class=\"token key atrule\">properties</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">application.sort.policy</span><span class=\"token punctuation\">:</span> fifo\n        <span class=\"token key atrule\">application.sort.priority</span><span class=\"token punctuation\">:</span> disabled\n      <span class=\"token key atrule\">queues</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> prod\n          <span class=\"token key atrule\">resources</span><span class=\"token punctuation\">:</span>\n            <span class=\"token key atrule\">guaranteed</span><span class=\"token punctuation\">:</span>\n              <span class=\"token key atrule\">memory</span><span class=\"token punctuation\">:</span> 300G\n              <span class=\"token key atrule\">vcore</span><span class=\"token punctuation\">:</span> <span class=\"token number\">30</span>\n            <span class=\"token key atrule\">max</span><span class=\"token punctuation\">:</span>\n              <span class=\"token key atrule\">memory</span><span class=\"token punctuation\">:</span> 600G\n              <span class=\"token key atrule\">vcore</span><span class=\"token punctuation\">:</span> <span class=\"token number\">60</span>\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> stage\n          <span class=\"token key atrule\">resources</span><span class=\"token punctuation\">:</span>\n            <span class=\"token key atrule\">guaranteed</span><span class=\"token punctuation\">:</span>\n              <span class=\"token key atrule\">memory</span><span class=\"token punctuation\">:</span> 100G\n              <span class=\"token key atrule\">vcore</span><span class=\"token punctuation\">:</span> <span class=\"token number\">10</span>\n            <span class=\"token key atrule\">max</span><span class=\"token punctuation\">:</span>\n              <span class=\"token key atrule\">memory</span><span class=\"token punctuation\">:</span> 200G\n              <span class=\"token key atrule\">vcore</span><span class=\"token punctuation\">:</span> <span class=\"token number\">200</span></code></pre></div>\n<p>ìœ„ì™€ ê°™ì´ prod, stage ë“± ì—¬ëŸ¬ ê°œì˜ íë¥¼ ê³„ì¸µí˜•ìœ¼ë¡œ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.<br>\nìŠ¤ì¼€ì¤„ë§ ì •ì±…ì€ í¬ê²Œ <strong>node sorting ë‹¨ê³„ì™€ application sorting ë‹¨ê³„</strong>ë¡œ ë‚˜ëˆ„ì–´ì§‘ë‹ˆë‹¤.<br>\ngang schedulingì„ ì‚¬ìš©í•˜ëŠ” ê²½ìš°, application sortingì€ í•­ìƒ fifoë¥¼ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤.</p>\n<p>Yunikornì—ì„œ Gang Schedulingì´ ì‹¤í–‰ë˜ëŠ” ë‹¨ê³„ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.\n<img src=\"https://drive.google.com/uc?export=view&#x26;id=1E81nP3qq2D2IPMuPR13xkPVaBAmLy9u-\" alt=\"yunikorn-gang\"></p>\n<ul>\n<li>TaskGroupì´ ì •ì˜ëœ applicationì„ submit í•©ë‹ˆë‹¤.</li>\n<li>Shimì´ applicationì„ ìƒì„±í•˜ê³  ì´ë¥¼ Core(Kube scheduler)ì— ì „ë‹¬í•©ë‹ˆë‹¤.</li>\n<li>Shimì€ TaskGroupì˜ ê° memberì— ëŒ€í•œ placeholder podë¥¼ ìƒì„±í•©ë‹ˆë‹¤. sparkì˜ ê²½ìš°, memberëŠ” driver, executorê°€ ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>\n<li>podê°€ ì •ìƒì ìœ¼ë¡œ ìƒì„±ë˜ê³  ë‚˜ë©´ AllocationAsksë¡œ ì²˜ë¦¬ë˜ì–´ Coreì— ì „ë‹¬ë©ë‹ˆë‹¤.</li>\n<li>placeholderëŠ” Coreë¥¼ í†µí•´ ì ì ˆí•œ ë…¸ë“œì— ë°”ì¸ë”©ë©ë‹ˆë‹¤.</li>\n<li>ì´ì œ ì‹¤ì œ podê°€ AllocationAskë¡œ Coreì— ì „ë‹¬ë©ë‹ˆë‹¤.</li>\n<li>ì‹¤ì œ podì™€ ëª¨ë“  placeholder podê°€ ìŠ¤ì¼€ì¤„ë§ ì™„ë£Œëœ ì´í›„ Shimì€ ì‹¤ì œ podë¥¼ ë°”ì¸ë”©í•©ë‹ˆë‹¤.</li>\n</ul>\n<br>\n<p><strong>Yunikorn ì ìš© ê³¼ì •</strong><br>\nYunikorn ì ìš©ì„ ìœ„í•´ í•„ìš”í•œ ë‹¨ê³„ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.<br>\nYunikornì˜ ê²½ìš° annotation ì„¤ì •ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.</p>\n<ol>\n<li>Yunikorn í™˜ê²½ ë° ì„¤ì • ë°°í¬</li>\n<li>Spark configuration ì „ë‹¬</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">--conf spark.kubernetes.scheduler.name=yunikorn\n--conf spark.kubernetes.driver.label.queue=root.default\n--conf spark.kubernetes.executor.label.queue=root.default\n--conf spark.kubernetes.driver.annotation.yunikorn.apache.org/app-id={{APP_ID}}\n--conf spark.kubernetes.executor.annotation.yunikorn.apache.org/app-id={{APP_ID}}</code></pre></div>\n<p><br><br></p>\n<h2 id=\"volcano-vs-apache-yunikorn\" style=\"position:relative;\"><a href=\"#volcano-vs-apache-yunikorn\" aria-label=\"volcano vs apache yunikorn permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Volcano vs Apache Yunikorn</h2>\n<p>ì•ì„œ ì‚´í´ ë³¸ ë‚´ìš©ì„ í†µí•´ ê° ìŠ¤ì¼€ì¤„ëŸ¬ì˜ ì¥ë‹¨ì ì„ ì •ë¦¬í•´ë³´ë©´ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.<br>\nëª¨ë‘ Helm ì°¨íŠ¸ë¥¼ ì§€ì›í•˜ë¯€ë¡œ ì‰½ê²Œ êµ¬ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.<br></p>\n<p><strong>Volcano</strong><br>\nì¥ì : Kubeflowì— ëŒ€í•œ ì§€ì›<br>\në‹¨ì : spark ì´ë¯¸ì§€ ë¹Œë“œ, CRD ë‹¨ìœ„ë¡œ ê´€ë¦¬ê°€ í•„ìš”</p>\n<br>\n<p><strong>Yunikorn</strong><br>\nì¥ì : ì‘ì—… ìƒíƒœë¥¼ í™•ì¸í•  ìˆ˜ ìˆëŠ” Web UI ì§€ì›<br>\nì¥ì : ê²½ëŸ‰í™”ë˜ì–´ ìˆìœ¼ë©° ê³„ì¸µ êµ¬ì¡°ì˜ íë¥¼ ì§€ì›<br>\nì¥ì : ì¶”ê°€ë¡œ í•„ìš”í•œ ë¶€ë¶„ì´ ì ì–´ ìš´ì˜ì´ í¸ë¦¬<br>\në‹¨ì : ì£¼ìš” ì„¤ì •ì€ ëª¨ë‘ ìˆìœ¼ë‚˜ Volcano ëŒ€ë¹„ ì ì€ ì˜µì…˜ ì§€ì›</p>\n<p><br><br></p>\n<h2 id=\"ìš´ì˜ì„-í•˜ë©´ì„œ-ë§ˆì£¼ì¹ -ìˆ˜-ìˆëŠ”-ë¶€ë¶„ë“¤\" style=\"position:relative;\"><a href=\"#%EC%9A%B4%EC%98%81%EC%9D%84-%ED%95%98%EB%A9%B4%EC%84%9C-%EB%A7%88%EC%A3%BC%EC%B9%A0-%EC%88%98-%EC%9E%88%EB%8A%94-%EB%B6%80%EB%B6%84%EB%93%A4\" aria-label=\"ìš´ì˜ì„ í•˜ë©´ì„œ ë§ˆì£¼ì¹  ìˆ˜ ìˆëŠ” ë¶€ë¶„ë“¤ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ìš´ì˜ì„ í•˜ë©´ì„œ ë§ˆì£¼ì¹  ìˆ˜ ìˆëŠ” ë¶€ë¶„ë“¤</h2>\n<p>ë‹¤ìŒì€ ì ìš©í•œ ì´í›„ì— ìš´ì˜ì„ í•˜ë‹¤ë³´ë©´ ë§ˆì£¼ì¹  ìˆ˜ ìˆëŠ” ì´ìŠˆ ë˜ëŠ” ê³ ë¯¼ì„ ì •ë¦¬í•´ë³´ì•˜ìŠµë‹ˆë‹¤.<br></p>\n<p><strong>placeholder ë¦¬ì†ŒìŠ¤ ì„¤ì •</strong><br>\napplication submit ì‹œ placeholderì— í• ë‹¹í•  ë¦¬ì†ŒìŠ¤ ì‚¬ì´ì¦ˆ ê²°ì •ì´ í•„ìš”í•©ë‹ˆë‹¤.\nplaceholderë¥¼ ì‘ê²Œ ì„¤ì •í•˜ë©´ ë¦¬ì†ŒìŠ¤ í™•ë³´ê°€ ì•ˆë˜ì–´ ìŠ¤ì¼€ì¤„ë§ì— ì˜í–¥ì´ ìˆì„ ìˆ˜ ìˆê³  ì§€ë‚˜ì¹˜ê²Œ í¬ê²Œ ì„¤ì •í•˜ë©´ ì‹¤ì œë¡œ ì—¬ìœ ê°€ ìˆìŒì—ë„ ë¦¬ì†ŒìŠ¤ ë¶€ì¡± í˜„ìƒ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. <a href=\"https://github.com/GoogleCloudPlatform/spark-on-k8s-operator\">spark-on-k8s-operator</a>ë¥¼ ì‚¬ìš©í•œë‹¤ë©´ ìŠ¤ì¼€ì¤„ëŸ¬ì— ë”°ë¼ placeholder ì‚¬ì´ì¦ˆë¥¼ ê²°ì •í•˜ëŠ” ë¡œì§ì´ í¬í•¨ë˜ì–´ ìˆìœ¼ë‹ˆ í¸í•˜ê²Œ ì ìš©ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.</p>\n<p><strong>í ì‚¬ì´ì¦ˆ ì¡°ì •</strong><br>\në§Œì•½ íì˜ ë¦¬ì†ŒìŠ¤ ì œí•œë³´ë‹¤ ìš”ì²­í•œ ë¦¬ì†ŒìŠ¤ê°€ í¬ë‹¤ë©´ application rejectì´ ë°œìƒí•˜ì—¬ ì‹¤í–‰ì´ ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤. ë˜í•œ íì˜ í¬ê¸°ê°€ ì „ì²´ì ìœ¼ë¡œ ì‘ì€ ê²½ìš°, ì‹ ê·œ ìš”ì²­í•œ ì–´í”Œë¦¬ì¼€ì´ì…˜ì´ ë¹ˆë²ˆí•˜ê²Œ ëŒ€ê¸°í•˜ëŠ” ìƒí™©ë„ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ìŠ¤ì¼€ì¤„ëŸ¬ì—ì„œ Prometheus ë©”íŠ¸ë¦­ì„ ì œê³µí•˜ë‹ˆ Grafanaë¥¼ í†µí•´ ëª¨ë‹ˆí„°ë§ í›„ ì ì ˆí•œ í ì‚¬ì´ì¦ˆë¡œ ì„¤ì •í•˜ëŠ” ê³¼ì •ì´ í•„ìš”í•©ë‹ˆë‹¤.</p>\n<p><strong>Spark Dynamic Resource Allocationì„ ì‚¬ìš©í•˜ëŠ” ê²½ìš°</strong><br>\níì—ì„œ ì´ë¯¸ ì‹¤í–‰ ì¤‘ì¸ applicationì€ ë¦¬ì†ŒìŠ¤ í™•ì¥ë„ ê°€ëŠ¥í•©ë‹ˆë‹¤.\në”°ë¼ì„œ Sparkì˜ Dynamic Resource Allocationì„ ë§ì´ ì‚¬ìš©í•œë‹¤ë©´ ë¯¸ë¦¬ ì„¤ì •í•´ë‘” ì œí•œì„ í¬ê²Œ ë„˜ì–´ê°ˆ ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤. ì´ëŸ¬í•œ ê²½ìš°, íë¥¼ ì‚¬ìš©í•˜ëŠ” ì˜ë¯¸ê°€ ì‚¬ë¼ì§€ê²Œ ë©ë‹ˆë‹¤.</p>\n<p><strong>Application Cleanup ê´€ë ¨</strong><br>\nìƒí™©ì— ë”°ë¼ applicationì´ accepted ë˜ëŠ” waiting ìƒíƒœì—ì„œ ê³„ì† ë¨¸ë¬´ë¥´ëŠ” ì´ìŠˆê°€ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ì²˜ëŸ¼ placeholderê°€ í• ë‹¹ë˜ì§€ ëª»í•˜ëŠ” ê²½ìš°, ìŠ¤ì¼€ì¤„ëŸ¬ì—ì„œ timeout ì„¤ì •ì„ í†µí•´ ì‹¤íŒ¨ ì²˜ë¦¬ë˜ì–´ì•¼ ë‹¤ìŒ ì‘ì—…ì´ ì›í™œí•˜ê²Œ ì§„í–‰ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë§Œì•½ ì¢€ë¹„ ìƒíƒœë¡œ placeholderê°€ ë‚¨ëŠ”ë‹¤ë©´ coreì—ì„œ í™•ì¸ í›„ GCë¥¼ í†µí•´ ì •ë¦¬ë©ë‹ˆë‹¤.</p>\n<p><br><br></p>\n<h2 id=\"reference\" style=\"position:relative;\"><a href=\"#reference\" aria-label=\"reference permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Reference</h2>\n<p>ë‘ ê°€ì§€ ìŠ¤ì¼€ì¤„ëŸ¬ ëª¨ë‘ ë²”ìš©ì ìœ¼ë¡œ ë§ì´ ì‚¬ìš©ë˜ê³  ìˆì–´ ìš´ì˜ ì¤‘ì¸ í™˜ê²½ì— ë”°ë¼ ì„ íƒí•˜ì‹œë©´ ì¢‹ì„ ê²ƒ ê°™ìŠµë‹ˆë‹¤.<br>ê° ìŠ¤ì¼€ì¤„ëŸ¬ì— ëŒ€í•œ ìì„¸í•œ ë‚´ìš©ì€ ì•„ë˜ì˜ ê³µì‹ë¬¸ì„œì—ì„œ ì°¾ì•„ë³´ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤!</p>\n<ul>\n<li><a href=\"https://yunikorn.apache.org/docs/\">https://yunikorn.apache.org/docs/</a></li>\n<li><a href=\"https://volcano.sh/en/\">https://volcano.sh/en/</a></li>\n</ul>","excerpt":"Spark 3.4 ë²„ì „ë¶€í„° Customized K8S Scheduler ê¸°ëŠ¥ì´ GA ë˜ì—ˆìŠµë‹ˆë‹¤ ğŸ‘ğŸ»\nì˜¤ëŠ˜ì€ ì§€ë‚œ ê¸€ì— ì´ì–´ ê°€ì¥ ë§ì´ ì‚¬ìš©í•˜ëŠ” Volcano, Yunikorn ìŠ¤ì¼€ì¤„ëŸ¬ì— ëŒ€í•´ ì•Œì•„ë³´ê² ìŠµë‹ˆë‹¤. 3.4 ë²„ì „ ê¸°ì¤€ìœ¼ë¡œ Sparkì—ì„œëŠ” Volcano, Yunikorn ë‘ ê°€ì§€ ì»¤ìŠ¤í…€ ìŠ¤ì¼€ì¤„ëŸ¬ë¥¼ ê³µì‹ì ìœ¼ë¡œ ì§€ì›í•©ë‹ˆë‹¤. ë‘ ê°€ì§€ ì˜¤í”ˆì†ŒìŠ¤ ëª¨ë‘ ë„¤ì´í‹°ë¸Œ í™˜ê²½ì—ì„œ ë°°ì¹˜ ì²˜ë¦¬ë¥¼ ì§€ì›í•˜ê¸° ìœ„í•œ í”„ë¡œì íŠ¸ì´ë©° ìµœì‹  ë²„ì „ ê¸°ì¤€ìœ¼ë¡œ ëª¨ë‘ ìœ ì‚¬í•œ ê¸°ëŠ¥ì„ ì§€ì›í•˜ê³  ìˆìŠµë‹ˆë‹¤. ë¨¼ì € Volcano ë¶€í„° ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤. Volcano ì´ˆê¸°ì˜ VolcanoëŠ” kube-batchâ€¦"}}}},"pageContext":{"slug":"spark-on-kubernetes-scheduler-2","basePath":"","prev":null,"next":{"slug":"spark-on-kubernetes-scheduler","publishDate":"2023-06-08"}}},"staticQueryHashes":["1946181227","2744905544","3732430097"]}